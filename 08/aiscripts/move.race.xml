<?xml version="1.0" encoding="utf-8" ?>
<aiscript name="move.race" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="aiscripts.xsd" version="19">

  <order id="MoveRaceCheckpoints" name="{1041, 541}" description="{1041, 542}" category="internal">
    <params>
      <param name="checkpoints" type="internal" default="null"></param>
      <param name="checkpointleniency" type="internal" default="null"></param>
    </params>
  </order>
  <attention min="unknown">
    <actions>
      <do_all exact="$checkpoints.count" counter="$Count">
        <create_position name="$position"
                         space="this.sector"
                         value="position.[$checkpoints.{$Count}.position.x + [-$checkpointleniency.{$Count},$checkpointleniency.{$Count}].randominrange,
                                          $checkpoints.{$Count}.position.y + [-$checkpointleniency.{$Count},$checkpointleniency.{$Count}].randominrange,
                                          $checkpoints.{$Count}.position.z]"
                         object="this.sector"/>
        <set_value name="$forcesteering" exact="true"/>
        <do_if value="$checkpointleniency.{$Count} lt 100">
          <set_value name="$forcesteering" exact="false"/>
        </do_if>
        <set_avoid_collisions object="this.assignedcontrolled" bigobjects="not $forcesteering" smallobjects="false" />
        <set_to_default_flight_control_model object="this.assignedcontrolled" clearforcedsteering="true"/>
        <move_to object="this.assignedcontrolled"
                 flightbehaviour="flightbehaviour.racing"
                 destination="this.sector"
                 uselocalhighways="false"
                 forcerotation="true"
                 finishonapproach="true"
                 boost="not $forcesteering"
                 forcesteering="$forcesteering"
                 radius="$checkpointleniency.{$Count}">
          <position value="$position"/>
          <rotation value="$checkpoints.{$Count}.rotation"/>
        </move_to>
        <set_value name="this.$CheckpointCount" operation="add"/>
      </do_all>
    </actions>
  </attention>
</aiscript>
