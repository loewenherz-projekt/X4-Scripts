<?xml version="1.0" encoding="utf-8"?>
<mdscript name="Scenario_Tutorials" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="md.xsd">
  <cues>
    <cue name="GameStart_Tutorial">
      <conditions>
        <event_cue_signalled cue="md.Setup.GameStart" />
      </conditions>
      <actions>
        <set_value name="$DebugChance" exact="100"/>
        <set_value name="$HintPosition" exact="1"/>
      </actions>
      <cues>
        <cue name="Tutorial_Init">
          <actions>
            <!--Create a list of tutorial cues to trigger in that order-->
            <!--basic tutorials start here-->
            <do_if value="player.module == 'tutorial_firstperson'">
              <set_value name="$SignalList" exact="[Tutorial_FirstPerson_Init,
                                                    Tutorial_HelpBox,
                                                    Tutorial_InputProfile,
                                                    Tutorial_MessageTicker,
                                                    Tutorial_Introduction_Short,
                                                    Tutorial_FPLook,
                                                    Tutorial_FPWalk,
                                                    Tutorial_FPRun,
                                                    Tutorial_FPJump,
                                                    Tutorial_FPCrouch,
                                                    Tutorial_Dialog,
                                                    Tutorial_EmbarkAndUndock,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_if>
            <do_elseif value="player.module == 'tutorial_flight'">
              <set_value name="$SignalList" exact="[Tutorial_BasicFlight_InitialUseCaseAndSetup,
                                                    Tutorial_ShipSteering,
                                                    Tutorial_ShipRoll_MappingCheck,
                                                    Tutorial_ShipRoll,
                                                    Tutorial_ShipStrafing,
                                                    Tutorial_ShipForward,
                                                    Tutorial_ShipReverse,
                                                    Tutorial_FullStop,
                                                    Tutorial_Boost,
                                                    Tutorial_TestCourse,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_travel'">
              <set_value name="$SignalList" exact="[Tutorial_TravelMode,
                                                    Tutorial_AutoPilot_Start,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_highways_gates'">
              <set_value name="$SignalList" exact="[Tutorial_SuperHighway_Exit_AbortCoasting,
                                                    Tutorial_HighwaysAndGates_Setup,
                                                    Tutorial_Jumpgate,
                                                    Tutorial_Accelerator,
                                                    Tutorial_SuperHighway,
                                                    Tutorial_LocalHighway,
                                                    Tutorial_LocalHighwayWithGate,
                                                    Tutorial_LocalHighwayThroughGate,
                                                    Tutorial_LocalHighwayExitInMiddle,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_docking'">
              <set_value name="$SignalList" exact="[Tutorial_Docking,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_combat'">
              <set_value name="$SignalList" exact="[Tutorial_ShootingPrimary,
                                                    Tutorial_ShootingSecondary,
                                                    Tutorial_Combat_OwnShields,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_weapons_turrets'">
              <set_value name="$SignalList" exact="[Tutorial_ManageWeapons_OpenShipMenu,
                                                    Tutorial_ManageWeapons_AssignGroups,
                                                    Tutorial_ManageWeapons_SelectMissile,
                                                    Tutorial_ManageWeapons_CyclePrimaryWeaponGroups,
                                                    Tutorial_ManageWeapons_CycleMissile,
                                                    Tutorial_ManageWeapons_UseIonWeapon,
                                                    Tutorial_ManageWeapons_UsePlasmaWeapon,
                                                    Tutorial_ManageWeapons_UseBeamWeapon,
                                                    Tutorial_ManageWeapons_Turrets_OpenShipMenu,
                                                    Tutorial_ManageWeapons_Turrets_Arm,
                                                    Tutorial_ManageWeapons_ExplainTurretModes,
                                                    Tutorial_ManageWeapons_SetTurretModes,
                                                    Tutorial_ManageWeapons_TurretsShoot,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_cameras'">
              <set_value name="$SignalList" exact="[Tutorial_Camera_UseCase,
                                                    Tutorial_CockpitCamera,
                                                    Tutorial_ExternalCamera,
                                                    Tutorial_ExternalTargetCamera,
                                                    Tutorial_FloatingCamera,
                                                    Tutorial_ToggleCockpit,
                                                    Tutorial_LiveStream,
                                                    Tutorial_LiveStream_ReturnToCockpit,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_inventory'">
              <set_value name="$SignalList" exact="[Tutorial_InventoryAndCrafting_SetupAndInitialUsecase,
                                                    Tutorial_InventoryAndCrafting_WareCategories,
                                                    Tutorial_InventoryAndCrafting_DropAllIllegalWares,
                                                    Tutorial_InventoryAndCrafting_DropTradeWare,
                                                    Tutorial_InventoryAndCrafting_DockAtStation,
                                                    Tutorial_InventoryAndCrafting_GoToTradersCorner,
                                                    Tutorial_InventoryAndCrafting_WaitForTraderSpawn,
                                                    Tutorial_InventoryAndCrafting_TalkToTrader,
                                                    Tutorial_InventoryAndCrafting_WaitForTraderSpeak,
                                                    Tutorial_InventoryAndCrafting_BuyCraftingWares,
                                                    Tutorial_InventoryAndCrafting_CloseTradeMenu,
                                                    Tutorial_InventoryAndCrafting_InteractWithCraftingBench,
                                                    Tutorial_InventoryAndCrafting_CraftItem,
                                                    Tutorial_InventoryAndCrafting_SellCraftedItem,
                                                    Tutorial_InventoryAndCrafting_FinalUseCase,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_spacesuit'">
              <set_value name="$SignalList" exact="[Tutorial_SpaceSuit,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_relative_movement'">
              <set_value name="$SignalList" exact="[Tutorial_RelativeMovement,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_adaptive_steering'">
              <set_value name="$SignalList" exact="[Tutorial_AdaptiveSteering,
                                                    Tutorial_TestCourse,
                                                    Tutorial_AdaptiveSteering_SettingQuestion,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_flight_assist'">
              <set_value name="$SignalList" exact="[Tutorial_FlightAssist,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_shipupgrade'">
              <set_value name="$SignalList" exact="[Tutorial_UpgradeShip_OpenUpgradeMenu,
                                                    Tutorial_UpgradeShip_Thruster,
                                                    Tutorial_UpgradeShip_ChangeShield,
                                                    Tutorial_UpgradeShip_AddShield,
                                                    Tutorial_UpgradeShip_Weapons,
                                                    Tutorial_UpgradeShip_Software,
                                                    Tutorial_UpgradeShip_Repair,
                                                    Tutorial_UpgradeShip_Confirm,
                                                    Tutorial_BuyShip,
                                                    Tutorial_BuyShip_MandatoryUpgrades,
                                                    Tutorial_BuyShip_Consumables,
                                                    Tutorial_BuyShip_Captain,
                                                    Tutorial_BuyShip_Crew,
                                                    Tutorial_BuyShip_SaveLoadout,
                                                    Tutorial_BuyShip_AddToShoppingList,
                                                    Tutorial_BuyShip_ChangeShoppingListAmount,
                                                    Tutorial_BuyShip_Confirm,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_scan_longrange'">
              <set_value name="$SignalList" exact="[Tutorial_Scan_Gravidar,
                                                    Tutorial_Scan_LongRange,
                                                    Tutorial_Open_Lockbox,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_scan_objects'">
              <set_value name="$SignalList" exact="[Tutorial_Scan_Ship,
                                                    Tutorial_Scan_Station,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_signalleaks'">
              <set_value name="$SignalList" exact="[Tutorial_Scan_Leak,
                                                    Tutorial_Scan_Leak_Spacesuit,
                                                    Tutorial_Repair_Leak,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_factions'">
              <set_value name="$SignalList" exact="[Tutorial_Factions_OpenMenu,
                                                    Tutorial_Factions_SelectFaction,
                                                    Tutorial_Factions_SelectOtherFaction,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_map'">
              <set_value name="$SignalList" exact="[Tutorial_Map_KeepOpen,
                                                    Tutorial_Map_InitialUseCaseAndSetup,
                                                    Tutorial_Map_Legend,
                                                    Tutorial_Map_ZoomOut,
                                                    Tutorial_Map_PanAndRotate,
                                                    Tutorial_Map_ResetView,
                                                    Tutorial_Map_SelectObject,
                                                    Tutorial_Map_ClearSelection,
                                                    Tutorial_Map_Interact,
                                                    Tutorial_Map_InfoMenu,
                                                    Tutorial_Map_CrewMenu,
                                                    Tutorial_Map_ServiceCrewInfo,
                                                    Tutorial_Map_CloseInfoMenu,
                                                    Tutorial_Map_ObjectList,
                                                    Tutorial_Map_DeployablesTab,
                                                    Tutorial_Map_ZoomOut_2,
                                                    Tutorial_Map_InteractFromMenu,
                                                    Tutorial_Map_PropertyOwned,
                                                    Tutorial_Map_FocusCameraOnShip,
                                                    Tutorial_Map_ZoomWhileFocusedOnShip,
                                                    Tutorial_Map_BreakFocusOnShip,
                                                    Tutorial_Map_HelpOverlay,
                                                    Tutorial_Map_CloseMap_UseCase,
                                                    Tutorial_Map_CloseMap,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_missions'">
              <set_value name="$SignalList" exact="[Tutorial_Missions_InitialUseCaseAndSetup,
                                                    Tutorial_Missions_SelectMissionTarget,
                                                    Tutorial_Missions_TurnToOffScreenMissionTarget,
                                                    Tutorial_Map_KeepOpen,
                                                    Tutorial_Missions_MissionTargetsOnMap,
                                                    Tutorial_Map_CloseMap,
                                                    Tutorial_Missions_FlyToTargetArea,
                                                    Tutorial_Map_KeepOpen,
                                                    Tutorial_Missions_MissionOffers,
                                                    Tutorial_Missions_MissionOffers_SelectOffer,
                                                    Tutorial_Missions_MissionOffers_Accept,
                                                    Tutorial_Missions_MissionManager,
                                                    Tutorial_Missions_ActivateTrainingMission,
                                                    Tutorial_Missions_AbortMissions,
                                                    Tutorial_Missions_ActivateMainMission,
                                                    Tutorial_Missions_SetGuidance,
                                                    Tutorial_Map_CloseMap,
                                                    Tutorial_Missions_FlyToGuidanceTarget,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_deploy'">
              <set_value name="$SignalList" exact="[Tutorial_Deploy_Intro,
                                                    Tutorial_Deploy_OpenShipMenu,
                                                    Tutorial_Deploy_DeploySatellite,
                                                    Tutorial_Deploy_SelectSatellite,
                                                    Tutorial_Deploy_DeactivateSatellite,
                                                    Tutorial_Deploy_CollectSatellite,
                                                    Tutorial_Deploy_NavBeacons_UseCase,
                                                    Tutorial_Deploy_ResourceProbes_UseCase,
                                                    Tutorial_Deploy_Mine,
                                                    Tutorial_Deploy_Mine_GainDistance,
                                                    Tutorial_Deploy_Mine_SelfDestruct,
                                                    Tutorial_Deploy_Lasertower,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_wingmen'">
              <set_value name="$SignalList" exact="[Tutorial_Squad_Setup,
                                                    Tutorial_Squad_OpenShipMenu,
                                                    Tutorial_Squad_RoleSelection,
                                                    Tutorial_Squad_Interception,
                                                    Tutorial_Squad_Bombardment,
                                                    Tutorial_Squad_Defence,
                                                    Tutorial_Squad_Attack,
                                                    Tutorial_Squad_Hotkeys,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_orders'">
              <set_value name="$SignalList" exact="[Tutorial_Orders_InitialUseCaseAndSetup,
                                                    Tutorial_Map_KeepOpen,
                                                    Tutorial_Orders_SelectScout,
                                                    Tutorial_Orders_GiveFirstOrder,
                                                    Tutorial_Orders_GiveSecondOrder,
                                                    Tutorial_Orders_DragOrder,
                                                    Tutorial_Orders_DragOrderLine,
                                                    Tutorial_Orders_DragOrderVertically,
                                                    Tutorial_Orders_RemoveOrder,
                                                    Tutorial_Orders_RemoveLastOrder,
                                                    Tutorial_Orders_OpenInfoMenu,
                                                    Tutorial_Orders_OpenBehaviourTab,
                                                    Tutorial_Orders_SelectDefaultBehaviour,
                                                    Tutorial_Orders_SelectBehaviourSpace,
                                                    Tutorial_Orders_ConfirmDefaultBehaviour,
                                                    Tutorial_Map_CloseMap_UseCase,
                                                    Tutorial_Map_CloseMap,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_alerts_blacklists'">
              <set_value name="$SignalList" exact="[Tutorial_Map_KeepOpen,
                                                    Tutorial_Advanced_Orders,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_order_loops'">
              <set_value name="$SignalList" exact="[Tutorial_Map_KeepOpen,
                                                    Tutorial_Advanced_Orders,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_order_syncpoints'">
              <set_value name="$SignalList" exact="[Tutorial_Map_KeepOpen,
                                                    Tutorial_Advanced_Orders,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_orders_battle'">
              <set_value name="$SignalList" exact="[Tutorial_Map_KeepOpen,
                                                    Tutorial_Advanced_Orders,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_orders_boarding'">
              <set_value name="$SignalList" exact="[Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_subordinates'">
              <set_value name="$SignalList" exact="[Tutorial_Map_KeepOpen,
                                                    Tutorial_CommandStructures,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_crewtransfer'">
              <set_value name="$SignalList" exact="[Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_resupply'">
              <set_value name="$SignalList" exact="[Tutorial_Map_KeepOpen,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_trading'">
              <set_value name="$SignalList" exact="[Tutorial_TradePersonal_Init,
                                                    Tutorial_Map_KeepOpen,
                                                    Tutorial_TradePersonal_ActivateTradeFilter,
                                                    Tutorial_Map_CloseMap,
                                                    Tutorial_TradePersonal_FlyToOtherStation,
                                                    Tutorial_Map_KeepOpen,
                                                    Tutorial_TradePersonal_ExplainTradeOffers,
                                                    Tutorial_Map_CloseMap,
                                                    Tutorial_TradePersonal_DockAtPowerPlant,
                                                    Tutorial_TradePersonal_OpenTradeMenu,
                                                    Tutorial_TradePersonal_Buy,
                                                    Tutorial_TradePersonal_WaitForWares,
                                                    Tutorial_TradePersonal_DockAtFactory,
                                                    Tutorial_TradePersonal_Sell,
                                                    Tutorial_TradePersonal_FinalUseCase,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_trading_advanced'">
              <set_value name="$SignalList" exact="[Tutorial_TradeOrder_InitialUseCaseAndSetup,
                                                    Tutorial_Map_KeepOpen,
                                                    Tutorial_TradeOrder_SetMapTargetAndZoom,
                                                    Tutorial_TradeOrder_ActivateTradeFilter,
                                                    Tutorial_TradeOrder_TradeFilterSettings,
                                                    Tutorial_TradeOrder_TransportType,
                                                    Tutorial_TradeOrder_FilterWare,
                                                    Tutorial_TradeOrder_SelectTransporter,
                                                    Tutorial_TradeOrder_GiveBuyOrder,
                                                    Tutorial_TradeOrder_ConfirmBuyOrder,
                                                    Tutorial_TradeOrder_GiveSellOrder,
                                                    Tutorial_TradeOrder_TradeOfferTypes,
                                                    Tutorial_TradeOrder_AutoTrade_OpenBehaviourMenu,
                                                    Tutorial_TradeOrder_AutoTrade_GiveOrder,
                                                    Tutorial_TradeOrder_CloseMap,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_mining'">
              <set_value name="$SignalList" exact="[Tutorial_MiningPersonal_Intro,
                                                    Tutorial_MiningPersonal_ScanMode,
                                                    Tutorial_MiningPersonal_TargetAsteroid,
                                                    Tutorial_MiningPersonal_MiningNode,
                                                    Tutorial_MiningPersonal_Chunk,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_mining_advanced'">
              <set_value name="$SignalList" exact="[Tutorial_MiningOrder_InitialUseCaseAndSetup,
                                                    Tutorial_Map_KeepOpen,
                                                    Tutorial_MiningOrder_ResourceAreasOnMap,
                                                    Tutorial_MiningOrder_GiveOrder,
                                                    Tutorial_MiningOrder_ResourceProbe_UseCase,
                                                    Tutorial_Map_CloseMap,
                                                    Tutorial_MiningOrder_ResourceProbe_Deploy,
                                                    Tutorial_Map_KeepOpen,
                                                    Tutorial_MiningOrder_ActivateMiningFilter,
                                                    Tutorial_MiningOrder_MiningProbeInfo,
                                                    Tutorial_MiningOrder_CloseMap,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_station_building'">
              <set_value name="$SignalList" exact="[Tutorial_BuildStation_InitialUsecaseAndSetup,
                                                    Tutorial_Map_KeepOpen,
                                                    Tutorial_BuildStation_OpenPlotMenu,
                                                    Tutorial_BuildStation_CreateNewPlot,
                                                    Tutorial_BuildStation_PlacePlot,
                                                    Tutorial_BuildStation_BuyPlotLicence,
                                                    Tutorial_BuildStation_PlanBuild,
                                                    Tutorial_BuildStation_DockModules,
                                                    Tutorial_BuildStation_SelectPier,
                                                    Tutorial_BuildStation_PlacePier,
                                                    Tutorial_BuildStation_SelectPlacedModule,
                                                    Tutorial_BuildStation_UseTransformGizmo_Translate,
                                                    Tutorial_BuildStation_UseTransformGizmo_Rotate,
                                                    Tutorial_BuildStation_ResetRotation,
                                                    Tutorial_BuildStation_SelectDockArea,
                                                    Tutorial_BuildStation_PlaceDockArea,
                                                    Tutorial_BuildStation_OtherModules,
                                                    Tutorial_BuildStation_PlaceProductionModule,
                                                    Tutorial_BuildStation_StorageModules,
                                                    Tutorial_BuildStation_PlaceStorageModule,
                                                    Tutorial_BuildStation_PlaceHabitationModule,
                                                    Tutorial_BuildStation_PlaceDefenceModule,
                                                    Tutorial_BuildStation_EditDefenceModuleLoadout,
                                                    Tutorial_BuildStation_AddTurretToDefenceModule,
                                                    Tutorial_BuildStation_ConfirmChanges,
                                                    Tutorial_BuildStation_HireBuilder,
                                                    Tutorial_BuildStation_ConfirmHireBuilder,
                                                    Tutorial_BuildStation_RequiredResources,
                                                    Tutorial_BuildStation_AllocateFunds,
                                                    Tutorial_BuildStation_AcceptEstimate,
                                                    Tutorial_Build_Station_CloseMap,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_station_management'">
              <set_value name="$SignalList" exact="[Tutorial_ManageStation,
                                                    Tutorial_Map_KeepOpen,
                                                    Tutorial_ManageStation_AssignMiningShip,
                                                    Tutorial_ManageStation_Budget,
                                                    Tutorial_ManageStation_LogicalOverview,
                                                    Tutorial_ManageStation_Workforce,
                                                    Tutorial_ManageStation_Drones,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <do_elseif value="player.module == 'tutorial_mod_ship'">
              <set_value name="$SignalList" exact="[Tutorial_ModifyShip,
                                                    Tutorial_Quit,
                                                   ]"/>
            </do_elseif>
            <!--list of deprecated / unused tutorials:
            Tutorial_FloatingCamera,
            Tutorial_ToggleCockpit,
            Tutorial_Targeting,
            Tutorial_ShipSpeed_MatchTarget,
            -->
            <do_if value="$SignalList?">
              <set_value name="md.$TutorialActive" exact="true" comment="silence global hints"/>
              <set_value name="md.$SurpressTutorials" exact="true" comment="surpress tutorials"/>
              <set_value name="md.GenericMissions.Manager.$Disabled" exact="true"/>

              <debug_text text="'Setup for GameStart_Tutorial'" chance="$DebugChance"/>

              <set_value name="$AlliedFaction" exact="faction.argon"/>
              <set_value name="$FlightInstructorMacro" exact="macro.character_flight_school_instructor_macro"/>
              <set_value name="$AlliedCrew" exact="'argon_military_crew'"/>

              <find_station name="$Wharf" space="player.sector" wharf="true"/>

              <create_group groupname="$PlayerShipGroup"/>

              <do_if value="player.ship">
                <set_value name="$PlayerShip" exact="player.ship"/>
                <lock_getup/>
              </do_if>
              <do_elseif value="$Wharf.exists">
                <set_value name="$PlayerShipMacro" exact="macro.ship_arg_s_fighter_04_a_macro"/>
                <find_dockingbay name="$WharfDock" object="$Wharf" walkable="true">
                  <match_dock size="$PlayerShipMacro.docksize"/>
                </find_dockingbay>
                <create_ship name="$PlayerShip" macro="$PlayerShipMacro" dock="$WharfDock" capturable="false">
                  <owner exact="faction.player" overridenpc="true" />
                  <loadout ref="flightschool_player_ship" />
                </create_ship>
              </do_elseif>
              <do_if value="$PlayerShip?">
                <add_to_group groupname="$PlayerShipGroup" object="$PlayerShip"/>
                <set_object_min_hull object="$PlayerShip" exact="1"/>
                <set_object_sellable object="$PlayerShip" sellable="false"/>
              </do_if>

              <do_if value="player.room.macro == macro.room_gen_securityoffice_01_macro">
                <set_value name="$InstructorRoom" exact="player.room"/>
                <set_value name="$Wharf" exact="player.station"/>
              </do_if>
              <do_elseif value="$Wharf.exists">
                <find_room name="$InstructorRoom" object="$Wharf" macro="macro.room_gen_securityoffice_01_macro"/>
              </do_elseif>

              <do_if value="@$InstructorRoom.exists">
                <set_dynamic_interior_persistent object="$Wharf" room="$InstructorRoom" persistent="true"/>
                <set_dynamic_interior_private object="$Wharf" room="$InstructorRoom" private="true"/>
              </do_if>

              <create_cue_actor name="$FlightInstructor" cue="this" macro="$FlightInstructorMacro">
                <owner exact="$AlliedFaction"/>
                <page exact="10190"/>
                <skills>
                  <skill type="piloting"    exact="15"/>
                  <skill type="management"  exact="3"/>
                  <skill type="morale"      exact="15"/>
                  <skill type="engineering" exact="9"/>
                  <skill type="boarding"    exact="3"/>
                </skills>
              </create_cue_actor>
              <set_entity_traits entity="$FlightInstructor" missionactor="true" customhandler="true"/>
              <set_entity_role entity="$FlightInstructor" role="entityrole.passenger"/>
              <set_entity_overrides entity="$FlightInstructor" title="'{20208,30101}'" icon="'captain'"/>
              <do_if value="@$InstructorRoom.exists">
                <add_actor_to_room actor="$FlightInstructor" object="$InstructorRoom">
                  <position x="2.13" y="0" z="-1.92"/>
                  <rotation yaw="-150deg"/>
                </add_actor_to_room>
                <set_actor_lookat actor="$FlightInstructor" component="player.entity"/>
              </do_if>
              <set_value name="$MissionActors" exact="table[]"/>
              <set_value name="$MissionActors.$FlightInstructor" exact="table[ $entity = $FlightInstructor ]"/>
              <set_value name="$UseCasePreset" exact="table[ $priority = 100, $speakpriority = 100, $queue = true, $chance = 100 ]" />
              <debug_text text="'Created flight instructor ' + $FlightInstructor.knownname + ' with voice page ' + $FlightInstructor.page" chance="$DebugChance"/>
              <substitute_text text="$MissionName" source="{30178,1000}" comment="Tutorial: $NAME$.">
                <replace string="'$NAME$'" with="player.modulename"/>
              </substitute_text>
              <create_mission cue="GameStart_Tutorial" type="missiontype.tutorial" name="$MissionName" description="player.moduledescription" difficulty="level.easy" faction="$AlliedFaction" abortable="false">
                <briefing>
                  <objective step="1" action="objective.custom" customaction="{30178,1059}"/>
                </briefing>
              </create_mission>
              <set_value name="$Index" exact="0"/>
              <signal_cue cue="Tutorial_Start"/>
            </do_if>
            <do_else>
              <cancel_cue cue="GameStart_Tutorial"/>
              <cancel_cue cue="UpdateHintInputMethod"/>
            </do_else>
          </actions>
          <cues>

            <!-- Setup cue for stuff that needs to happen after md.Setup.GameStart has fully gone through -->

            <cue name="Tutorial_Setup_Delayed">
              <delay exact="1ms"/>
              <actions>
                <set_faction_relation_locked faction="faction.player" locked="true" />
                <set_faction_relation_locked faction="$AlliedFaction" locked="true" />
              </actions>
            </cue>

            <!-- conversation handlers -->

            <cue name="Shortcut_Conversation_Handler" instantiate="true">
              <conditions>
                <event_conversation_started conversation="default" actor="$FlightInstructor"/>
              </conditions>
              <actions>
                <do_if value="$CurrentUseCaseEndLines?">
                  <remove_value name="$CurrentUseCaseEndLines"/>
                </do_if>
                <add_npc_line line="1" comment="Yes?"/>
                <do_if value="$MedicalExamStarted?">
                  <do_if value="$MedicalExamDone?">
                    <add_player_choice position="top_left" text="{30178,1097}" section="continue_basic_flight" highlighted="true"/>
                  </do_if>
                  <do_if value="$ShowDialogHints?">
                    <signal_cue cue="ShowHint_Dialog"/>
                  </do_if>
                </do_if>
              </actions>
            </cue>

            <cue name="Shortcut_Conversation_Handler_Finished" instantiate="true">
              <conditions>
                <event_conversation_next_section actor="$FlightInstructor" />
              </conditions>
              <actions>
                <do_if value="event.param == 'continue_basic_flight'">
                  <signal_cue cue="Tutorial_Dialog_Done"/>
                </do_if>
                <do_else>
                  <add_npc_line line="3" comment="Right."/>
                </do_else>
                <do_if value="$ShowDialogHints?">
                  <signal_cue_instantly cue="ClearHintID"/>
                </do_if>
              </actions>
            </cue>

            <cue name="Shortcut_Conversation_Handler_SpeakFinished_Resume" instantiate="true">
              <conditions>
                <event_speak_finished actor="$FlightInstructor" line="3"/>
              </conditions>
              <actions>
                <debug_text text="'Checking for callback cue'" chance="$DebugChance"/>
                <do_if value="$UseCaseInterruptedCallbackCue?">
                  <debug_text text="'Signalling callback cue'" chance="$DebugChance"/>
                  <signal_cue cue="$UseCaseInterruptedCallbackCue"/>
                </do_if>
              </actions>
            </cue>

            <!--This handler is supposed to disable conversations with all NPCs apart from the flight instructor and only works because there can be no
                other custom handlers in this module.-->
            <cue name="GreetingHandler" instantiate="true">
              <conditions>
                <event_conversation_started conversation="default"/>
                <check_value value="event.object != $FlightInstructor and not $AllowTutorialConversations?"/>
              </conditions>
              <actions>
                <add_npc_line line="2002" comment="Hello."/>
              </actions>
            </cue>

            <!-- general cues that could trigger at various points -->

            <cue name="PlayerShipHullDamagedUseCase">
              <conditions>
                <event_object_hull_damaged group="$PlayerShipGroup"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 12, $comment = 'You’re not in actual danger, by the way. We’re only simulating damage to your ship.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="PlayerAlreadyKnewUseCase" instantiate="true">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $selectspeak = [10, 11], $comment = 'Variations on ’You already knew’' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="ShipMenuCallback" instantiate="true">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'DockedMenu'"/>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <set_value name="$ShipMenuHintPosition" exact="if player.ship.weapons.operational.count or player.ship.turrets.operational.count or player.ship.subordinates.count then 7 else 4"/>
                <do_if value="event.name == 'event_cue_signalled' or event.param2 == ''">
                  <set_value name="$ShipMenuOpen" exact="true"/>
                  <do_if value="$HintPosition == 1">
                    <signal_cue_instantly cue="SetHintPosition" param="$ShipMenuHintPosition"/>
                  </do_if>
                </do_if>
                <do_elseif value="event.param2 == 'menu_close'">
                  <remove_value name="$ShipMenuOpen"/>
                  <do_if value="$HintPosition == $ShipMenuHintPosition">
                    <signal_cue_instantly cue="SetHintPosition" param="1"/>
                  </do_if>
                </do_elseif>
              </actions>
            </cue>

            <cue name="TopLevelTabsOpened" instantiate="true">
              <conditions>
                <event_ui_triggered screen="'TopLevelTabs'"/>
                <check_value value="event.param3 == 'displayed'"/>
              </conditions>
              <actions>
                <set_value name="$TopLevelMenuOpen" exact="true"/>
              </actions>
            </cue>

            <cue name="TopLevelTabsClosed" instantiate="true">
              <conditions>
                <event_ui_triggered screen="'MenuTabScroll'"/>
                <check_value value="event.param3 == 'disabled'"/>
              </conditions>
              <actions>
                <remove_value name="$TopLevelMenuOpen"/>
              </actions>
            </cue>

            <cue name="MapMenuCallback" instantiate="true">
              <conditions>
                <event_ui_triggered screen="'MapMenu'"/>
              </conditions>
              <actions>
                <do_if value="event.param2 == 'menu_close'">
                  <remove_value name="$MapMenuOpen"/>
                </do_if>
                <do_elseif value="event.param2 == ''">
                  <set_value name="$MapMenuOpen" exact="true"/>
                </do_elseif>
              </actions>
            </cue>

            <cue name="PlayerInfoMenuCallback" instantiate="true">
              <conditions>
                <event_ui_triggered screen="'PlayerInfoMenu'"/>
              </conditions>
              <actions>
                <do_if value="event.param2 != 'menu_close'">
                  <debug_text text="'Player Info Menu OPEN'"/>
                  <set_value name="$PlayerInfoMenuOpen" exact="true"/>
                </do_if>
                <do_elseif value="$PlayerInfoMenuOpen?">
                  <debug_text text="'Player Info Menu CLOSED'"/>
                  <remove_value name="$PlayerInfoMenuOpen"/>
                </do_elseif>
                <do_if value="event.param2 == 'inventory'">
                  <debug_text text="'Inventory OPEN'"/>
                  <set_value name="$InventoryMenuOpen" exact="true"/>
                </do_if>
                <do_elseif value="$InventoryMenuOpen?">
                  <debug_text text="'Inventory CLOSED'"/>
                  <remove_value name="$InventoryMenuOpen"/>
                </do_elseif>
                <do_if value="event.param2 == 'factions'">
                  <debug_text text="'Factions Menu OPEN'"/>
                  <set_value name="$FactionsMenuOpen" exact="true"/>
                  <set_value name="$FactionsMenuParam" exact="event.param3"/>
                </do_if>
                <do_elseif value="$FactionsMenuOpen?">
                  <debug_text text="'Factions Menu CLOSED'"/>
                  <remove_value name="$FactionsMenuOpen"/>
                  <remove_value name="$FactionsMenuParam"/>
                </do_elseif>
              </actions>
            </cue>

            <cue name="DiplomacyMenuCallback" instantiate="true">
              <conditions>
                <event_ui_triggered screen="'DiplomacyMenu'"/>
              </conditions>
              <actions>
                <do_if value="event.param2 == 'menu_close'">
                  <remove_value name="$DiplomacyMenuOpen"/>
                </do_if>
                <do_elseif value="event.param2 == ''">
                  <set_value name="$DiplomacyMenuOpen" exact="true"/>
                </do_elseif>
              </actions>
            </cue>

            <!--more specialized callbacks to track certain thing being done prematurely-->
            <cue name="ShipConfigurationMenu_CaptainHired_Callback">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'shipconfig_crew_captain'"/>
              </conditions>
              <actions>
                <set_value name="$ShipConfigurationMenu_CaptainHired" exact="true"/>
              </actions>
            </cue>

          </cues>
        </cue>

        <cue name="Tutorial_Start">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <lock_all_firstperson_input/>
            <lock_all_flight_input/>
            <lock_all_shooting_input/>
            <lock_all_holomap_input/>
            <lock_getup/>
          </actions>
          <delay exact="4s"/>
          <actions>
            <unlock_all_firstperson_input/>
            <unlock_all_flight_input/>
            <unlock_all_shooting_input/>
            <unlock_all_holomap_input/>
            <unlock_getup/>
            <signal_cue cue="Tutorial_TriggerNext"/>
          </actions>
        </cue>

        <cue name="Tutorial_TriggerNext" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_value name="$Index" operation="add"/>
            <do_if value="$Index gt $SignalList.count">
              <debug_text text="'Tutorial has been completed'" chance="$DebugChance"/>
            </do_if>
            <do_else>
              <debug_text text="'Triggering next tutorial stage: ' + $SignalList.{$Index}" chance="$DebugChance"/>
              <signal_cue cue="$SignalList.{$Index}"/>
            </do_else>
          </actions>
        </cue>

        <cue name="NPCCreated" instantiate="true">
          <conditions>
            <event_npc_created/>
            <check_value value="not $AllowTutorialConversations?"/>
          </conditions>
          <actions>
            <set_entity_traits entity="event.param" customhandler="true" />
          </actions>
        </cue>

        <cue name="EnableCustomConversationHandlers" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <remove_value name="$AllowTutorialConversations"/>
            <find_station name="$objects" space="player.sector" multiple="true"/>
            <find_ship name="$objects" space="player.sector" multiple="true" append="true"/>
            <do_for_each name="$object" in="$objects">
              <find_object_component groupname="$npcs" class="class.npc" object="$object" multiple="true" append="true"/>
            </do_for_each>
            <do_for_each name="$npc" in="$npcs">
              <set_entity_traits entity="$npc" customhandler="true" />
            </do_for_each>
          </actions>
        </cue>

        <cue name="DisableCustomConversationHandlers" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_value name="$AllowTutorialConversations" exact="true"/>
            <find_station name="$objects" space="player.sector" multiple="true"/>
            <find_ship name="$objects" space="player.sector" multiple="true" append="true"/>
            <do_for_each name="$object" in="$objects">
              <find_object_component groupname="$npcs" class="class.npc" object="$object" multiple="true" append="true"/>
            </do_for_each>
            <do_for_each name="$npc" in="$npcs">
              <set_entity_traits entity="$npc" customhandler="false" />
            </do_for_each>
          </actions>
        </cue>

        <cue name="UpdateHint" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="@$MenuHintID">
              <do_if value="typeof $MenuHintID == datatype.list">
                <do_if value="player.input.controller and $MenuHintID.count ge 2">
                  <set_value name="$menuhintid" exact="$MenuHintID.{2}"/>
                </do_if>
                <do_elseif value="player.input.joystick and $MenuHintID.count ge 3">
                  <set_value name="$menuhintid" exact="$MenuHintID.{3}"/>
                </do_elseif>
                <do_else>
                  <set_value name="$menuhintid" exact="$MenuHintID.{1}"/>
                </do_else>
              </do_if>
              <do_else>
                <set_value name="$menuhintid" exact="@$MenuHintID"/>
              </do_else>
            </do_if>
            <do_else>
              <remove_value name="$menuhintid"/>
            </do_else>
            <do_if value="@$HintID">
              <do_if value="typeof $HintID == datatype.list">
                <do_if value="player.input.controller and $HintID.count ge 2">
                  <set_value name="$hintid" exact="$HintID.{2}"/>
                </do_if>
                <do_elseif value="player.input.joystick and $HintID.count ge 3">
                  <set_value name="$hintid" exact="$HintID.{3}"/>
                </do_elseif>
                <do_else>
                  <set_value name="$hintid" exact="$HintID.{1}"/>
                </do_else>
              </do_if>
              <do_else>
                <set_value name="$hintid" exact="@$HintID"/>
              </do_else>
            </do_if>
            <do_else>
              <remove_value name="$hintid"/>
            </do_else>
            <debug_text text="'UpdateHint'"/>
            <debug_text text="'$menuhintid ' + @$menuhintid"/>
            <debug_text text="'$HintText ' + @$HintText"/>
            <debug_text text="'$hintid ' + @$hintid"/>
            <debug_text text="'$HintPosition ' + @$HintPosition"/>
            <remove_help all="true"/>
            <do_if value="$menuhintid?">
              <show_help line="$menuhintid" log="true" position="$HintPosition" force="true" allowclose="$HintAllowClose?" allowinmenu="if $HintAllowInOptionsMenu? then 'OptionsMenu' else ''" timeout="false"/>
            </do_if>
            <do_elseif value="$HintText?">
              <show_help custom="$HintText" log="true" position="$HintPosition" force="true" allowclose="$HintAllowClose?" allowinmenu="if $HintAllowInOptionsMenu? then 'OptionsMenu' else ''" timeout="false"/>
            </do_elseif>
            <do_elseif value="$hintid?">
              <show_help line="$hintid" log="true" position="$HintPosition" force="true" allowclose="$HintAllowClose?" allowinmenu="if $HintAllowInOptionsMenu? then 'OptionsMenu' else ''" timeout="false"/>
            </do_elseif>
          </actions>
        </cue>

        <cue name="SetHintPosition" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="@$HintPosition != event.param">
              <set_value name="$HintPosition" exact="event.param"/>
              <signal_cue cue="UpdateHint"/>
            </do_if>
          </actions>
        </cue>

        <cue name="SetHintAllowClose" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="not $HintAllowClose?">
              <set_value name="$HintAllowClose" exact="true"/>
              <signal_cue cue="UpdateHint"/>
            </do_if>
          </actions>
        </cue>

        <cue name="HintClosed" instantiate="true">
          <conditions>
            <event_ui_triggered screen="'hintclosed'"/>
          </conditions>
          <actions>
            <remove_value name="$HintAllowClose"/>
            <signal_cue_instantly cue="ClearHintID"/>
          </actions>
        </cue>

        <cue name="SetHintAllowInOptionsMenu" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="not $HintAllowInOptionsMenu?">
              <set_value name="$HintAllowInOptionsMenu" exact="true"/>
              <signal_cue cue="UpdateHint"/>
            </do_if>
          </actions>
        </cue>

        <cue name="ClearHintAllowInOptionsMenu" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="$HintAllowInOptionsMenu?">
              <remove_value name="$HintAllowInOptionsMenu"/>
              <signal_cue cue="UpdateHint"/>
            </do_if>
          </actions>
        </cue>

        <cue name="UpdateHintInputMethod">
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller">
              <set_value name="$inputmethod" exact="2"/>
            </do_if>
            <do_elseif value="player.input.joystick">
              <set_value name="$inputmethod" exact="3"/>
            </do_elseif>
            <do_else>
              <set_value name="$inputmethod" exact="1"/>
            </do_else>
            <do_if value="not $PreviousInputMethod? or $inputmethod != $PreviousInputMethod">
              <debug_text text="'Input method changed from ' + @$PreviousInputMethod + ' to ' + $inputmethod"/>
              <set_value name="$PreviousInputMethod" exact="$inputmethod"/>
              <signal_cue cue="UpdateHint"/>
              <signal_cue cue="InputMethodChanged" check="false"/>
            </do_if>
            <reset_cue cue="this"/>
          </actions>
        </cue>

        <cue name="InputMethodChanged" comment="for other cues to listen to"/>

        <cue name="SetHintID" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <remove_value name="$HintText"/>
            <do_if value="@$HintID != event.param">
              <set_value name="$HintID" exact="event.param"/>
              <signal_cue cue="UpdateHint"/>
            </do_if>
          </actions>
        </cue>

        <cue name="SetHintText" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <remove_value name="$HintID"/>
            <do_if value="@$HintText != event.param">
              <set_value name="$HintText" exact="event.param"/>
              <signal_cue cue="UpdateHint"/>
            </do_if>
          </actions>
        </cue>

        <cue name="ClearHintID" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="$HintID? or $HintText?">
              <remove_value name="$HintID"/>
              <remove_value name="$HintText"/>
              <signal_cue cue="UpdateHint"/>
            </do_if>
          </actions>
        </cue>

        <cue name="SetMenuHintID" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="@$MenuHintID != event.param">
              <set_value name="$MenuHintID" exact="event.param"/>
              <signal_cue cue="UpdateHint"/>
            </do_if>
          </actions>
        </cue>

        <cue name="ClearMenuHintID" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="$MenuHintID?">
              <remove_value name="$MenuHintID"/>
              <signal_cue cue="UpdateHint"/>
            </do_if>
          </actions>
        </cue>

        <cue name="ResetMenuHelpers" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <reset_cue cue="OpenShipMenu"/>
            <reset_cue cue="OpenMap"/>
            <reset_cue cue="OpenInventoryMenu"/>
            <reset_cue cue="OpenFactionsMenu"/>
            <reset_cue cue="OpenDiplomacyMenu"/>
            <signal_cue_instantly cue="ClearMenuHintID"/>
          </actions>
        </cue>

        <cue name="OpenShipMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue cue="OpenShipMenu_Update"/>
            <do_if value="not $ShipMenuOpen?">
              <signal_cue_instantly cue="SetMenuHintID" param="934" comment="{1012,934}"/>
            </do_if>
          </actions>
          <cues>
            <cue name="OpenShipMenu_MenuCallback" instantiate="true">
              <conditions>
                <event_ui_triggered screen="'DockedMenu'"/>
              </conditions>
              <actions>
                <signal_cue cue="OpenShipMenu_Update"/>
              </actions>
            </cue>

            <cue name="OpenShipMenu_Update" instantiate="true">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <do_if value="$ShipMenuOpen?">
                  <signal_cue_instantly cue="ClearMenuHintID"/>
                </do_if>
                <do_else>
                  <signal_cue_instantly cue="SetMenuHintID" param="934" comment="{1012,934}"/>
                </do_else>
              </actions>
            </cue>

            <cue name="OpenShipMenu_Reset">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearMenuHintID"/>
                <reset_cue cue="OpenShipMenu"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="OpenMap">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue cue="OpenMap_Update"/>
          </actions>
          <cues>
            <cue name="OpenMap_MenuCallback" instantiate="true">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'MapMenu'"/>
                  <event_ui_triggered screen="'MenuTabScroll'"/>
                  <event_ui_triggered screen="'TopLevelTabs'"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="OpenMap_Update"/>
              </actions>
            </cue>

            <cue name="OpenMap_Update" instantiate="true">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_cue_signalled cue="InputMethodChanged"/>
                </check_any>
              </conditions>
              <actions>
                <do_if value="$MapMenuOpen?">
                  <signal_cue_instantly cue="ClearMenuHintID"/>
                  <remove_help_overlay id="'toplevel_map'"/>
                </do_if>
                <do_else>
                  <show_help_overlay id="'toplevel_map'" highlightonly="true"/>
                  <!--map is not open at the moment - check which route to offer the player-->
                  <do_if value="player.input.controller">
                    <do_if value="$TopLevelMenuOpen?">
                      <!--using controller, top level menu is already open-->
                      <signal_cue_instantly cue="SetMenuHintID" param="943" comment="{1012,943}"/>
                    </do_if>
                    <do_else>
                      <!--using controller, top level menu is not open-->
                      <signal_cue_instantly cue="SetMenuHintID" param="934" comment="{1012,934}"/>
                    </do_else>
                  </do_if>
                  <do_else>
                    <!--assuming keyboard access - always give keyboard shortcut hint-->
                    <signal_cue_instantly cue="SetMenuHintID" param="5001" comment="{1012,5001}"/>
                  </do_else>
                </do_else>
              </actions>
            </cue>

            <cue name="OpenMap_Reset">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearMenuHintID"/>
                <reset_cue cue="OpenMap"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="OpenInventoryMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue cue="OpenInventoryMenu_Update"/>
          </actions>
          <cues>
            <cue name="OpenInventoryMenu_MenuCallback" instantiate="true">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'InventoryMenu'"/>
                  <event_ui_triggered screen="'MenuTabScroll'"/>
                  <event_ui_triggered screen="'TopLevelTabs'"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="OpenInventoryMenu_Update"/>
              </actions>
            </cue>

            <cue name="OpenInventoryMenu_Update" instantiate="true">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_cue_signalled cue="InputMethodChanged"/>
                </check_any>
              </conditions>
              <actions>
                <debug_text text="'$TopLevelMenuOpen? ' + @$TopLevelMenuOpen"/>
                <debug_text text="'$PlayerInfoMenuOpen? ' + @$PlayerInfoMenuOpen"/>
                <debug_text text="'$InventoryMenuOpen? ' + @$InventoryMenuOpen"/>
                <do_if value="$InventoryMenuOpen?">
                  <signal_cue_instantly cue="ClearMenuHintID"/>
                  <remove_help_overlay id="'toplevel_playerinfo'"/>
                  <remove_help_overlay id="'playerinfo_sidebar_inventory'"/>
                </do_if>
                <do_else>
                  <show_help_overlay id="'toplevel_playerinfo'" highlightonly="true"/>
                  <show_help_overlay id="'playerinfo_sidebar_inventory'" highlightonly="true"/>
                  <!--inventory menu is not open at the moment - check which route to offer the player-->
                  <do_if value="player.input.controller">
                    <do_if value="$PlayerInfoMenuOpen?">
                      <!--using controller, player info level menu is already open-->
                      <signal_cue_instantly cue="SetMenuHintID" param="947" comment="{1012,947}"/>
                    </do_if>
                    <do_elseif value="$TopLevelMenuOpen?">
                      <!--using controller, top level menu is already open-->
                      <signal_cue_instantly cue="SetMenuHintID" param="941" comment="{1012,941}"/>
                    </do_elseif>
                    <do_else>
                      <!--using controller, top level menu is not open-->
                      <signal_cue_instantly cue="SetMenuHintID" param="934" comment="{1012,934}"/>
                    </do_else>
                  </do_if>
                  <do_else>
                    <!--assuming keyboard access - always give keyboard shortcut hint-->
                    <signal_cue_instantly cue="SetMenuHintID" param="5005" comment="{1012,5005}"/>
                  </do_else>
                </do_else>
              </actions>
            </cue>

            <cue name="OpenInventoryMenu_Reset">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'toplevel_playerinfo'"/>
                <remove_help_overlay id="'playerinfo_sidebar_inventory'"/>
                <signal_cue_instantly cue="ClearMenuHintID"/>
                <reset_cue cue="OpenInventoryMenu"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="OpenFactionsMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue cue="OpenFactionsMenu_Update"/>
          </actions>
          <cues>
            <cue name="OpenFactionsMenu_MenuCallback" instantiate="true">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'FactionsMenu'"/>
                  <event_ui_triggered screen="'MenuTabScroll'"/>
                  <event_ui_triggered screen="'TopLevelTabs'"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="OpenFactionsMenu_Update"/>
              </actions>
            </cue>

            <cue name="OpenFactionsMenu_Update" instantiate="true">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <debug_text text="'$TopLevelMenuOpen? ' + @$TopLevelMenuOpen"/>
                <debug_text text="'$PlayerInfoMenuOpen? ' + @$PlayerInfoMenuOpen"/>
                <debug_text text="'$FactionsMenuOpen? ' + @$FactionsMenuOpen"/>
                <do_if value="$FactionsMenuOpen?">
                  <signal_cue_instantly cue="ClearMenuHintID"/>
                  <remove_help_overlay id="'toplevel_playerinfo'"/>
                  <remove_help_overlay id="'playerinfo_sidebar_factions'"/>
                </do_if>
                <do_else>
                  <show_help_overlay id="'toplevel_playerinfo'" highlightonly="true"/>
                  <show_help_overlay id="'playerinfo_sidebar_factions'" highlightonly="true"/>
                  <!--factions menu is not open at the moment-->
                  <do_if value="$PlayerInfoMenuOpen?">
                    <!--player info level menu is already open-->
                    <signal_cue_instantly cue="SetMenuHintID" param="947" comment="{1012,947}"/>
                  </do_if>
                  <do_elseif value="$TopLevelMenuOpen?">
                    <!--top level menu is already open-->
                    <signal_cue_instantly cue="SetMenuHintID" param="941" comment="{1012,941}"/>
                  </do_elseif>
                  <do_else>
                    <!--top level menu is not open-->
                    <signal_cue_instantly cue="SetMenuHintID" param="934" comment="{1012,934}"/>
                  </do_else>
                </do_else>
              </actions>
            </cue>

            <cue name="OpenFactionsMenu_Reset">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'toplevel_playerinfo'"/>
                <remove_help_overlay id="'playerinfo_sidebar_factions'"/>
                <signal_cue_instantly cue="ClearMenuHintID"/>
                <reset_cue cue="OpenFactionsMenu"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="OpenDiplomacyMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue cue="OpenDiplomacyMenu_Update"/>
          </actions>
          <cues>
            <cue name="OpenDiplomacyMenu_MenuCallback" instantiate="true">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'FactionsMenu'"/>
                  <event_ui_triggered screen="'MenuTabScroll'"/>
                  <event_ui_triggered screen="'TopLevelTabs'"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="OpenDiplomacyMenu_Update"/>
              </actions>
            </cue>

            <cue name="OpenDiplomacyMenu_Update" instantiate="true">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <debug_text text="'$TopLevelMenuOpen? ' + @$TopLevelMenuOpen"/>
                <debug_text text="'$DiplomacyMenuOpen? ' + @$DiplomacyMenuOpen"/>
                <do_if value="$DiplomacyMenuOpen?">
                  <signal_cue_instantly cue="ClearMenuHintID"/>
                  <remove_help_overlay id="'toplevel_diplomacy'"/>
                </do_if>
                <do_else>
                  <show_help_overlay id="'toplevel_diplomacy'" highlightonly="true"/>
                  <!--diplomacy menu is not open at the moment-->
                  <do_if value="$TopLevelMenuOpen?">
                    <!--top level menu is already open-->
                    <signal_cue_instantly cue="SetMenuHintID" param="948" comment="{1012,948}"/>
                  </do_if>
                  <do_else>
                    <!--top level menu is not open-->
                    <signal_cue_instantly cue="SetMenuHintID" param="934" comment="{1012,934}"/>
                  </do_else>
                </do_else>
              </actions>
            </cue>

            <cue name="OpenDiplomacyMenu_Reset">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'toplevel_diplomacy'"/>
                <signal_cue_instantly cue="ClearMenuHintID"/>
                <reset_cue cue="OpenDiplomacyMenu"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="ShowHint_FirstPersonLook" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[26101, 26100, 26100]" comment="{1012, 26101} or {1012, 26100}"/>
          </actions>
        </cue>

        <cue name="ShowHint_Walk" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[26103, 26102]" comment="{1012, 26103} or {1012, 26102}"/>
          </actions>
        </cue>

        <cue name="ShowHint_Run" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[26105, 26104, 26104]" comment="{1012, 26105} or {1012, 26104}"/>
          </actions>
        </cue>

        <cue name="ShowHint_Jump" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="26106" comment="{1012, 26106}"/>
          </actions>
        </cue>

        <cue name="ShowHint_Crouch" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="26107" comment="{1012, 26107}"/>
          </actions>
        </cue>

        <cue name="ShowHint_Dialog" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[26202, 26200, 26201]" comment="{1012, 26202} or {1012, 26200} or {1012, 26201}"/>
          </actions>
        </cue>

        <cue name="ShowHint_InteractFirstPerson" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[3106, 3108, 3108]" comment="{1012, 3106} or {1012, 3108} or {1012, 3108}"/>
          </actions>
        </cue>

        <cue name="ShowHint_SitInChair" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[1040, 1042, 1042]" comment="{1012, 1040} or {1012, 1042}"/>
          </actions>
        </cue>

        <cue name="ShowHint_Undock" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="1031" comment="{1012, 1031}"/>
          </actions>
        </cue>

        <cue name="ShowHint_SteerShip_YawPitch" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[26401, 26400, 26400]" comment="{1012, 26401} or {1012, 26400}"/>
          </actions>
        </cue>

        <cue name="ShowHint_ActivateMouseSteering" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="26401" comment="{1012, 26401}"/>
          </actions>
        </cue>

        <cue name="ShowHint_UseMouseSteering" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="26402" comment="{1012, 26402}"/>
          </actions>
        </cue>

        <cue name="ShowHint_DeactivateMouseSteering" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="26403" comment="{1012, 26403}"/>
          </actions>
        </cue>

        <cue name="ShowHint_SteerShip_Roll" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="player.input.ismapped.controller.INPUT_RANGE_STEERING_ROLL">
              <signal_cue_instantly cue="SetHintID" param="[26411, 26410, 26410]" comment="{1012, 26411} or {1012, 26410}"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="SetHintID" param="26411" comment="{1012, 26411}"/>
            </do_else>
          </actions>
        </cue>

        <cue name="ShowHint_Strafe" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="player.input.controller">
              <!--we need to handle several variations here, as any direction could be mapped to a button instead of an axis, so we need to display 2, 3 or 4 inputs, depending on the variation-->
              <create_list name="$StrafeInputNames"/>
              <do_if value="player.input.ismapped.controller.INPUT_STATE_STRAFE_LEFT or player.input.ismapped.controller.INPUT_STATE_STRAFE_RIGHT">
                <append_to_list name="$StrafeInputNames" exact="'$INPUT_STATE_STRAFE_LEFT$'"/>
                <append_to_list name="$StrafeInputNames" exact="'$INPUT_STATE_STRAFE_RIGHT$'"/>
              </do_if>
              <do_else>
                <append_to_list name="$StrafeInputNames" exact="'$INPUT_RANGE_STRAFE_LEFT_RIGHT$'"/>
              </do_else>
              <do_if value="player.input.ismapped.controller.INPUT_STATE_STRAFE_UP or player.input.ismapped.controller.INPUT_STATE_STRAFE_DOWN">
                <append_to_list name="$StrafeInputNames" exact="'$INPUT_STATE_STRAFE_UP$'"/>
                <append_to_list name="$StrafeInputNames" exact="'$INPUT_STATE_STRAFE_DOWN$'"/>
              </do_if>
              <do_else>
                <append_to_list name="$StrafeInputNames" exact="'$INPUT_RANGE_STRAFE_UP_DOWN$'"/>
              </do_else>
              <do_if value="$StrafeInputNames.count == 2">
                <substitute_text text="$StrafeHintText" source="{1012,26427}" comment="Use $INPUT1$ and $INPUT2$ to strafe.">
                  <replace string="'$INPUT1$'" with="$StrafeInputNames.{1}"/>
                  <replace string="'$INPUT2$'" with="$StrafeInputNames.{2}"/>
                </substitute_text>
              </do_if>
              <do_elseif value="$StrafeInputNames.count == 3">
                <substitute_text text="$StrafeHintText" source="{1012,26428}" comment="Use $INPUT1$, $INPUT2$ and $INPUT3$ to strafe.">
                  <replace string="'$INPUT1$'" with="$StrafeInputNames.{1}"/>
                  <replace string="'$INPUT2$'" with="$StrafeInputNames.{2}"/>
                  <replace string="'$INPUT3$'" with="$StrafeInputNames.{3}"/>
                </substitute_text>
              </do_elseif>
              <do_else>
                <substitute_text text="$StrafeHintText" source="{1012,26429}" comment="Use $INPUT1$, $INPUT2$, $INPUT3$ and $INPUT4$ to strafe.">
                  <replace string="'$INPUT1$'" with="$StrafeInputNames.{1}"/>
                  <replace string="'$INPUT2$'" with="$StrafeInputNames.{2}"/>
                  <replace string="'$INPUT3$'" with="$StrafeInputNames.{3}"/>
                  <replace string="'$INPUT4$'" with="$StrafeInputNames.{4}"/>
                </substitute_text>
              </do_else>
              <signal_cue_instantly cue="SetHintText" param="$StrafeHintText"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="SetHintID" param="26413" comment="{1012, 26413}"/>
            </do_else>
          </actions>
        </cue>

        <cue name="ShowHint_SelectMenuItem" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100011, 100012]" comment="{1012, 100011} or {1012, 100012}"/>
          </actions>
        </cue>

        <cue name="ShowHint_CloseMenus" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="100123" comment="{1012, 100123}"/>
          </actions>
        </cue>

        <cue name="ShowHint_CloseMenus_Checked" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="$TopLevelMenuOpen?">
              <signal_cue cue="ShowHint_CloseMenus"/>
            </do_if>
          </actions>
        </cue>

        <cue name="ShowHint_CloseSubMenu" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100021, 100023]" comment="{1012, 100021} or {1012, 100023}"/>
          </actions>
        </cue>

        <cue name="ShowHint_ZoomMap" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100031, 100032]" comment="{1012, 100031} or {1012, 100032}"/>
          </actions>
        </cue>

        <cue name="ShowHint_ZoomAndRotateMap" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100131, 100132]" comment="{1012, 100131} or {1012, 100132}"/>
          </actions>
        </cue>

        <cue name="ShowHint_PanAndRotateMap" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100043, 100046]" comment="{1012, 100043} or {1012, 100046}"/>
          </actions>
        </cue>

        <cue name="ShowHint_PanMap" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100041, 100046]" comment="{1012, 100041} or {1012, 100046}"/>
          </actions>
        </cue>

        <cue name="ShowHint_ResetViewOnMap" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100051, 100053]" comment="{1012, 100051} or {1012, 100053}"/>
          </actions>
        </cue>

        <cue name="ShowHint_SelectObjectOnMap" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100061, 100063]" comment="{1012, 100061} or {1012, 100063}"/>
          </actions>
        </cue>

        <cue name="ShowHint_SelectScoutOnMap" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100067, 100066]" comment="{1012, 100067} or {1012, 100066}"/>
          </actions>
        </cue>

        <cue name="ShowHint_ClearSelectionOnMap" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100071, 100073]" comment="{1012, 100071} or {1012, 100073}"/>
          </actions>
        </cue>

        <cue name="ShowHint_InteractOnMap" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100081, 100083]" comment="{1012, 100081} or {1012, 100083}"/>
          </actions>
        </cue>

        <cue name="ShowHint_GiveOrderOnMap" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100141, 100142]" comment="{1012, 100141} or {1012, 100142}"/>
          </actions>
        </cue>

        <cue name="ShowHint_GiveFlyToAreaOrderOnMap" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100144, 100145]" comment="{1012, 100144} or {1012, 100145}"/>
          </actions>
        </cue>

        <cue name="ShowHint_DragActiveOrder" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100154, 100155]" comment="{1012, 100154} or {1012, 100155}"/>
          </actions>
        </cue>

        <cue name="ShowHint_DragOrderLine" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100156, 100157]" comment="{1012, 100156} or {1012, 100157}"/>
          </actions>
        </cue>

        <cue name="ShowHint_DragOrderVertically" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100164, 100165]" comment="{1012, 100164} or {1012, 100165}"/>
          </actions>
        </cue>

        <cue name="ShowHint_InteractWithOrder" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100171, 100172]" comment="{1012, 100171} or {1012, 100172}"/>
          </actions>
        </cue>

        <cue name="ShowHint_ZoomPanAndInteractOnMap" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100084, 100085]" comment="{1012, 100084} or {1012, 100085}"/>
          </actions>
        </cue>

        <cue name="ShowHint_InteractFromMapMenu" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100091, 100093]" comment="{1012, 100091} or {1012, 100093}"/>
          </actions>
        </cue>

        <cue name="ShowHint_HelpOverlay" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100111, 100112]" comment="{1012, 100111} or {1012, 100112}"/>
          </actions>
        </cue>

        <cue name="ShowHint_SelectObject" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100061, 100064]" comment="{1012, 100061} or {1012, 100064}"/>
          </actions>
        </cue>

        <cue name="ShowHint_Boost" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[2021, 2020]" comment="{1012, 2021} or {1012, 2020}"/>
          </actions>
        </cue>

        <cue name="ShowHint_Accelerate" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="player.input.ismapped.controller.INPUT_STATE_FULLFORWARD">
              <signal_cue_instantly cue="SetHintID" param="[26416, 26430, 26415]" comment="{1012, 26416} or {1012, 26430} or {1012, 26415}"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="SetHintID" param="[26416, 26414, 26415]" comment="{1012, 26416} or {1012, 26414} or {1012, 26415}"/>
            </do_else>
          </actions>
        </cue>

        <cue name="ShowHint_Decelerate" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="player.input.ismapped.controller.INPUT_STATE_FULLREVERSE">
              <signal_cue_instantly cue="SetHintID" param="[26418, 26417, 26415]" comment="{1012, 26418} or {1012, 26417} or {1012, 26415}"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="SetHintID" param="[26418, 26431, 26415]" comment="{1012, 26418} or {1012, 26431} or {1012, 26415}"/>
            </do_else>
          </actions>
        </cue>

        <cue name="ShowHint_SendLongRangeScan" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="4203" comment="{1012, 4203}"/>
          </actions>
        </cue>

        <cue name="ShowHint_CollectItemInSpace" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="14321" comment="{1012, 14321}"/>
          </actions>
        </cue>

        <cue name="ShowHint_OpenShipMenu" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="26900" comment="{1012, 26900}"/>
          </actions>
        </cue>

        <cue name="ShowHint_DisableFlightAssist" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[27601, 27604]" comment="{1012, 27601} or {1012, 27604}"/>
          </actions>
        </cue>

        <cue name="ShowHint_ReenableFlightAssist" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[27603, 27605]" comment="{1012, 27603} or {1012, 27605}"/>
          </actions>
        </cue>

        <cue name="ShowHint_RequestDocking" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[27501, 27503, 27503]" comment="{1012, 27501} or {1012, 27503}"/>
          </actions>
        </cue>

        <cue name="ShowHint_DockingLights" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="27502" comment="{1012, 27502}"/>
          </actions>
        </cue>

        <cue name="ShowHint_ConfirmInMenu" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="27305" comment="{1012, 27305}"/>
          </actions>
        </cue>

        <cue name="ShowHint_GetUp" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="27300" comment="{1012, 27300}"/>
          </actions>
        </cue>

        <cue name="ShowHint_ActivateTravelMode" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="4314" comment="{1012, 4314}"/>
          </actions>
        </cue>

        <cue name="ShowHint_ExitHighway" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100173, 100174]" comment="{1012, 100173} or {1012, 100174}"/>
          </actions>
        </cue>

        <cue name="ShowHint_FirePrimaryWeapon" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="27100" comment="{1012, 27100}"/>
          </actions>
        </cue>

        <cue name="ShowHint_FireSecondaryWeapon" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="27102" comment="{1012, 27102}"/>
          </actions>
        </cue>

        <cue name="ShowHint_CyclePrimaryWeapon" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="player.input.ismapped.INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_1 and player.input.ismapped.INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_2 and player.input.ismapped.INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_3 and player.input.ismapped.INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_4">
              <signal_cue_instantly cue="SetHintID" param="[27202, 27201, 27201]" comment="{1012, 27202} or {1012, 27201}"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="SetHintID" param="27201" comment="{1012, 27201}"/>
            </do_else>
          </actions>
        </cue>

        <cue name="ShowHint_BuyWare" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="100175" comment="{1012, 100175}"/>
            <signal_cue_instantly cue="SetHintPosition" param="4"/>
          </actions>
        </cue>

        <cue name="ShowHint_SellWare" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="100176" comment="{1012, 100176}"/>
            <signal_cue_instantly cue="SetHintPosition" param="4"/>
          </actions>
        </cue>

        <cue name="ShowHint_OpenHighlightedMenu" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="100004" comment="{1012, 100004}"/>
          </actions>
        </cue>

        <cue name="ShowHint_HighlightedButton_Continue" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="100005" comment="{1012, 100005}"/>
          </actions>
        </cue>

        <cue name="ShowHint_HighlightedButton_Expand" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="100006" comment="{1012, 100006}"/>
          </actions>
        </cue>

        <cue name="ShowHint_StationEditor_SelectModule" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="100255" comment="{1012, 100255}"/>
          </actions>
        </cue>

        <cue name="ShowHint_StationEditor_PlaceModule" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="100256" comment="{1012, 100256}"/>
          </actions>
        </cue>

        <cue name="ShowHint_LoadoutEditor_ChooseEquipment" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="100272" comment="{1012, 100272}"/>
          </actions>
        </cue>

        <library name="LIB_OpenMap">
          <params>
            <param name="CallbackCue"/>
          </params>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.holomap.isopen">
              <signal_cue cue="LIB_OpenMap_MapOpened"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.Scenario_Tutorials.SetHintID" param="[5001,934]" comment="{1012, 5001} or {1012, 934}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="LIB_OpenMap_DockedMenuOpened">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'DockedMenu'" control="''" />
                </check_any>
              </conditions>
              <actions>
                <do_if value="player.input.controller">
                  <signal_cue_instantly cue="md.Scenario_Tutorials.SetHintID" param="943" comment="{1012, 943}"/>
                  <show_help_overlay id="'toplevel_map'"/>
                </do_if>
              </actions>
            </cue>

            <cue name="LIB_OpenMap_MapOpened">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'MapMenu'" control="''"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.Scenario_Tutorials.ClearHintID"/>
                <remove_help_overlay id="'toplevel_map'"/>
                <cancel_cue cue="LIB_OpenMap_DockedMenuOpened"/>
                <signal_cue cue="$CallbackCue"/>
              </actions>
            </cue>
          </cues>
        </library>

        <library name="LIB_ActivateMode">
          <params>
            <param name="Mode"/>
            <param name="CallbackCue"/>
          </params>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.activity == $Mode">
              <cancel_cue cue="LIB_ActivateMode_DockedMenuOpened"/>
              <signal_cue cue="LIB_ActivateMode_ModeActivated"/>
            </do_if>
            <do_else>
              <signal_cue cue="md.Scenario_Tutorials.ShowHint_OpenShipMenu"/>
            </do_else>
          </actions>
          <cues>
            <cue name="LIB_ActivateMode_DockedMenuOpened">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'DockedMenu'" control="''" />
                </check_any>
              </conditions>
              <actions>
                <do_if value="$Mode == activity.scan_longrange">
                  <signal_cue_instantly cue="md.Scenario_Tutorials.SetHintID" param="26905" comment="{1012, 26905}"/>
                  <show_help_overlay id="'docked_mode_dropdown_scan_longrange'" highlightonly="true"/>
                </do_if>
                <do_elseif value="$Mode == activity.scan">
                  <signal_cue_instantly cue="md.Scenario_Tutorials.SetHintID" param="26906" comment="{1012, 26906}"/>
                  <show_help_overlay id="'docked_mode_dropdown_scan'" highlightonly="true"/>
                </do_elseif>
                <do_elseif value="$Mode == activity.travel">
                  <signal_cue_instantly cue="md.Scenario_Tutorials.SetHintID" param="26904" comment="{1012, 26904}"/>
                  <show_help_overlay id="'docked_mode_dropdown_travel'" highlightonly="true"/>
                </do_elseif>
                <do_else>
                  <debug_text text="'Unknown mode ' + $Mode + ' passed to library - clearing hint'"/>
                  <signal_cue_instantly cue="md.Scenario_Tutorials.ClearHintID"/>
                </do_else>
                <show_help_overlay id="'docked_modes'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="LIB_ActivateMode_ModeActivated">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_player_changed_activity activity="$Mode"/>
                </check_any>
              </conditions>
              <actions>
                <cancel_cue cue="LIB_ActivateMode_DockedMenuOpened"/>
                <remove_help_overlay id="'docked_modes'"/>
                <remove_help_overlay id="'docked_mode_dropdown_scan_longrange'"/>
                <remove_help_overlay id="'docked_mode_dropdown_scan'"/>
                <remove_help_overlay id="'docked_mode_dropdown_travel'"/>
                <do_if value="md.Scenario_Tutorials.GameStart_Tutorial.$ShipMenuOpen?">
                  <signal_cue cue="md.Scenario_Tutorials.ShowHint_CloseMenus"/>
                </do_if>
                <do_else>
                  <signal_cue cue="LIB_ActivateMode_Done"/>
                </do_else>
              </actions>
              <cues>
                <cue name="LIB_ActivateMode_DockedMenuClosed">
                  <conditions>
                    <event_ui_triggered screen="'DockedMenu'" control="'menu_close'" />
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="md.Scenario_Tutorials.ClearHintID"/>
                    <signal_cue cue="$CallbackCue"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="LIB_ActivateMode_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.Scenario_Tutorials.ClearHintID"/>
                <cancel_cue cue="LIB_ActivateMode_DockedMenuOpened"/>
                <signal_cue cue="$CallbackCue"/>
              </actions>
            </cue>
          </cues>
        </library>

        <cue name="UITriggerDebug" instantiate="true">
          <conditions>
            <event_ui_triggered/>
          </conditions>
          <actions>
            <debug_text text="'UI triggered - param: ' + event.param + ' - param2: ' + event.param2 + ' - param3: ' + event.param3"/>
          </actions>
        </cue>

        <!-- Actual tutorial cues -->

        <cue name="Tutorial_FirstPerson_Init">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <find_object_component name="$StartCorridor" object="$InstructorRoom.dynamicinterior" macro="macro.room_arg_corridor_01_macro"/>
            <set_triggers_locked object="$StartCorridor" group="tag.door_01" locked="true"/>
            <set_owner object="$PlayerShip" faction="faction.ownerless"/>
            <find_dockingbay name="$SpaceSuitDocks" object="$Wharf" multiple="true">
              <match_dock size="tag.spacesuit"/>
            </find_dockingbay>
            <do_for_each in="$SpaceSuitDocks" name="$dock">
              <set_room_locked room="$dock" locked="true"/>
            </do_for_each>
            <lock_all_firstperson_input/>
            <lock_all_flight_input comment="so that the ship doesn't accidentally accelerate after the final step"/>
            <signal_cue cue="Tutorial_TriggerNext"/>
            <cancel_cue cue="Tutorial_FirstPerson_Init"/>
          </actions>
        </cue>

        <cue name="Tutorial_HelpBox">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="SetHintAllowClose"/>
            <signal_cue_instantly cue="SetHintID" param="26001" comment="{1012, 26001}"/>
          </actions>
          <cues>
            <cue name="Tutorial_HelpBox_Done">
              <conditions>
                <event_ui_triggered screen="'hintclosed'"/>
                <!--<event_ui_triggered screen="'hintclosed'" control="'THE_HINT_TEXT_ID'"/>-->
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_HelpBox"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_InputProfile">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1104}, {30178,1108}, [ 'yes', {30178,1119} ], [ 'no', {30178,1122} ] ]]"/>
          </actions>
          <cues>
            <cue name="Tutorial_InputProfile_LoadProfileQuestionAnswered">
              <conditions>
                <event_ui_triggered screen="'UserQuestionMenu'" control="'selected'"/>
              </conditions>
              <actions>
                <do_if value="event.param3 == 'yes'">
                  <open_menu menu="OptionsMenu" param="'profile_load'"/>
                </do_if>
                <do_else>
                  <signal_cue cue="Tutorial_InputProfile_Done"/>
                </do_else>
              </actions>
              <cues>
                <cue name="Tutorial_InputProfile_ProfileMenuClosed">
                  <conditions>
                    <event_ui_triggered screen="'OptionsMenu'" control="'menu_close'"/>
                  </conditions>
                  <actions>
                    <signal_cue cue="Tutorial_InputProfile_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_InputProfile_LoadProfileQuestionClosed">
              <conditions>
                <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_InputProfile_Done"/>
              </actions>
            </cue>

            <cue name="Tutorial_InputProfile_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_InputProfile"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_MessageTicker">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="SetHintAllowClose"/>
            <signal_cue_instantly cue="SetHintPosition" param="6"/>
            <signal_cue_instantly cue="SetHintID" param="26002" comment="{1012, 26002}"/>
            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1060}"/>
          </actions>
          <cues>
            <cue name="Tutorial_MessageTicker_Done">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'hintclosed'"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue_instantly cue="SetHintPosition" param="1"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_MessageTicker"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Introduction">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 1001, $comment = 'Hi. I’m Jace Winger, your flight instructor for today. We’ll be running through the full lesson plan, but if you’re already familiar with some of the basics you can talk to me about skipping ahead.' ],
                            table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 1002, $comment = 'Before we begin I need to perform a few routine physical tests. Regulations, you know.(say the last sentence slightly apologetically)' ],
                          ],
                $callbackcue = Tutorial_Introduction_Done,
                $abortcallbackcue = Tutorial_Introduction_Done,
              ]" />
            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1061}"/>
            <set_value name="$MedicalExamStarted" exact="true"/>
          </actions>
          <cues>
            <cue name="Tutorial_Introduction_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Introduction"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Introduction_Short">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 1002, $comment = 'Before we begin I need to perform a few routine physical tests. Regulations, you know.(say the last sentence slightly apologetically)' ],
                        ],
                $callbackcue = Tutorial_Introduction_Short_Done,
                $abortcallbackcue = Tutorial_Introduction_Short_Done,
            ]" />
            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1061}"/>
            <set_value name="$MedicalExamStarted" exact="true"/>
          </actions>
          <cues>
            <cue name="Tutorial_Introduction_Short_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Introduction_Short"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_FPLook">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 1003, $comment = 'Please move your head as far up or down as you can.' ],
                        ],
            ]" />
            <signal_cue cue="ShowHint_FirstPersonLook"/>
            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1062}"/>
            <unlock_firstperson_look_input/>
          </actions>
          <cues>
            <cue name="Tutorial_FPLook_UpOrDownCheck" checkinterval="0.1s">
              <conditions>
                <check_value value="player.entity.rotation.pitch gt 70deg or player.entity.rotation.pitch lt -70deg"/>
              </conditions>
              <delay exact="1s"/>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <do_if value="player.input.controller or player.input.joystick">
                  <do_if value="player.input.isinverted.firstperson.joystick.pitch">
                    <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1110}, [ 'invert_off', {30178,1118}, 14, 'invert_fp_pitch', false ], [ 'invert_on', {30178,1123} ], 'invertinput', 'right' ]]"/>
                  </do_if>
                  <do_else>
                    <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1112}, [ 'invert_on', {30178,1118}, 14, 'invert_fp_pitch', true ], [ 'invert_off', {30178,1122} ], 'invertinput', 'right' ]]"/>
                  </do_else>
                </do_if>
                <do_else>
                  <do_if value="player.input.isinverted.firstperson.mouse.pitch">
                    <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1110}, [ 'invert_off', {30178,1118}, 8, 'invert_fp_mouse_pitch', false ], [ 'invert_on', {30178,1123} ], 'invertinput', 'right' ]]"/>
                  </do_if>
                  <do_else>
                    <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1112}, [ 'invert_on', {30178,1118}, 8, 'invert_fp_mouse_pitch', true ], [ 'invert_off', {30178,1122} ], 'invertinput', 'right' ]]"/>
                  </do_else>
                </do_else>
              </actions>
              <cues>
                <cue name="Tutorial_FPLook_InvertQuestionAnsweredOrClosed">
                  <conditions>
                    <check_any>
                      <event_ui_triggered screen="'UserQuestionMenu'" control="'selected'"/>
                      <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                    </check_any>
                  </conditions>
                  <actions>
                    <signal_cue cue="Tutorial_FPLook_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_FPLook_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_FPLook"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_FPWalk">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 1004, $comment = 'OK, now please walk a few steps.' ],
                        ],
            ]" />
            <set_value name="$FPWalkRoom" exact="player.room"/>
            <set_value name="$FPWalkStartPos" exact="player.entity.position"/>
            <signal_cue cue="ShowHint_Walk"/>
            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1063}"/>
            <unlock_firstperson_walk_input/>
          </actions>
          <cues>
            <cue name="Tutorial_FPWalk_DistanceCheck" checkinterval="0.1s">
              <conditions>
                <check_value value="$FPWalkRoom? and player.entity.distanceto.[$FPWalkRoom, $FPWalkStartPos] gt 3m"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_FPWalk_Done"/>
              </actions>
            </cue>

            <cue name="Tutorial_FPWalk_PlayerRunning" checkinterval="1ms">
              <conditions>
                <check_value value="player.input.firstperson.isrunning"/>
              </conditions>
              <actions>
                <set_value name="$PlayerRan" exact="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_FPWalk_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_FPWalk"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_FPRun">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="$PlayerRan?">
              <signal_cue cue="Tutorial_FPRun_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 1011, $comment = 'Faster, please.' ],
                          ],
              ]" />
              <signal_cue cue="ShowHint_Run"/>
              <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1137}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_FPRun_PlayerRunning" checkinterval="1ms">
              <conditions>
                <check_value value="player.input.firstperson.isrunning"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_FPRun_Done"/>
              </actions>
            </cue>

            <cue name="Tutorial_FPRun_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_FPRun"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_FPJump">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 1005, $comment = 'And now do a few jumping jacks, please.' ],
                        ],
            ]" />
            <signal_cue cue="ShowHint_Jump"/>
            <set_value name="$RequiredJumps" exact="3"/>
            <set_value name="$PerformedJumps" exact="0"/>
            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1064}">
              <progress text="{30178,1096}" progress="$PerformedJumps" max="$RequiredJumps" />
            </set_objective>
            <unlock_firstperson_jump_input/>
          </actions>
          <cues>
            <cue name="Tutorial_FPJump_Check" checkinterval="0.1s">
              <conditions>
                <check_value value="$RequiredJumps? and player.input.firstperson.isjumping != $CurrentlyJumping?"/>
              </conditions>
              <actions>
                <do_if value="player.input.firstperson.isjumping">
                  <set_value name="$CurrentlyJumping" exact="true"/>
                </do_if>
                <do_else>
                  <remove_value name="$CurrentlyJumping"/>
                  <set_value name="$PerformedJumps" operation="add"/>
                  <update_objective_progress cue="GameStart_Tutorial" progress="$PerformedJumps" max="$RequiredJumps"/>
                </do_else>
                <do_if value="$PerformedJumps ge $RequiredJumps">
                  <signal_cue_instantly cue="ClearHintID"/>
                  <signal_cue cue="Tutorial_FPJump_Done"/>
                </do_if>
                <do_else>
                  <reset_cue cue="this"/>
                </do_else>
              </actions>
            </cue>

            <cue name="Tutorial_FPJump_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_FPJump"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_FPCrouch">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 1006, $comment = 'Finally a few squats, please.' ],
                        ],
            ]" />
            <signal_cue cue="ShowHint_Crouch"/>
            <set_value name="$RequiredSquats" exact="3"/>
            <set_value name="$PerformedSquats" exact="0"/>
            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1065}">
              <progress text="{30178,1096}" progress="$PerformedSquats" max="$RequiredSquats" />
            </set_objective>
            <unlock_firstperson_crouch_input/>
          </actions>
          <cues>
            <cue name="Tutorial_FPCrouch_Check" checkinterval="0.1s">
              <conditions>
                <check_value value="$RequiredSquats? and player.input.firstperson.iscrouching != $CurrentlyCrouching?"/>
              </conditions>
              <actions>
                <do_if value="player.input.firstperson.iscrouching">
                  <set_value name="$CurrentlyCrouching" exact="true"/>
                </do_if>
                <do_else>
                  <remove_value name="$CurrentlyCrouching"/>
                  <set_value name="$PerformedSquats" operation="add"/>
                  <update_objective_progress cue="GameStart_Tutorial" progress="$PerformedSquats" max="$RequiredSquats"/>
                </do_else>
                <do_if value="$PerformedSquats ge $RequiredSquats">
                  <signal_cue_instantly cue="ClearHintID"/>
                  <signal_cue cue="Tutorial_FPCrouch_Done"/>
                </do_if>
                <do_else>
                  <reset_cue cue="this"/>
                </do_else>
              </actions>
            </cue>

            <cue name="Tutorial_FPCrouch_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_FPCrouch"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Dialog">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_value name="$MedicalExamDone" exact="true"/>
            <set_value name="$ShowDialogHints" exact="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 1007, $comment = 'Great! You seem to be in good physical shape, so we can move on to your flying lessons.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 1010, $comment = 'Let me know how you want to proceed.' ],
                        ],
            ]" />
            <signal_cue cue="ShowHint_InteractFirstPerson"/>
            <set_objective cue="GameStart_Tutorial" action="objective.talkto" object="$FlightInstructor" />
          </actions>
          <cues>
            <cue name="Tutorial_Dialog_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1s"/>
              <actions>
                <remove_value name="$ShowDialogHints"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Dialog"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_EmbarkAndUndock">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <set_triggers_locked object="$StartCorridor" group="tag.door_01" locked="false"/>
            <set_owner object="$PlayerShip" faction="faction.player"/>
            <set_objective cue="GameStart_Tutorial" action="objective.embark" object="$PlayerShip" />
            <signal_cue cue="Tutorial_EmbarkAndUndock_Hints"/>
          </actions>
          <cues>
            <cue name="Tutorial_EmbarkAndUndock_Hints" instantiate="true">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_player_started_control/>
                  <event_player_stopped_control/>
                  <event_object_changed_room object="player.entity"/>
                </check_any>
              </conditions>
              <delay exact="1ms" />
              <actions>
                <do_if value="event.name != 'event_object_changed_room' or not event.param.dynamicinterior or event.param.dynamicinterior != event.param2.dynamicinterior">
                  <signal_cue_instantly cue="ClearHintID"/>
                  <do_if value="player.ship and not player.occupiedship and player.ship.isplayerowned" comment="player standing in his ship">
                    <signal_cue cue="Tutorial_EmbarkAndUndock_SitDownHint"/>
                  </do_if>
                  <do_elseif value="player.occupiedship and player.occupiedship.dock and player.ship.isplayerowned" comment="player sitting in his docked ship">
                    <signal_cue cue="Tutorial_EmbarkAndUndock_UndockHint"/>
                  </do_elseif>
                  <do_elseif value="player.room == $PlayerShip.dock" comment="player standing in correct dockingbay">
                    <signal_cue cue="Tutorial_EmbarkAndUndock_EmbarkHint" check="false"/>
                  </do_elseif>
                  <do_else comment="player in different room">
                    <signal_cue cue="Tutorial_EmbarkAndUndock_TransporterHints"/>
                  </do_else>
                </do_if>
              </actions>
            </cue>

            <cue name="Tutorial_EmbarkAndUndock_TransporterHints" instantiate="true">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <do_if value="not $Tutorial_EmbarkAndUndock_TransporterHints_AlreadyTriggered?">
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 1008, $comment = 'We’ll start by using the transporter room outside to go to the docking bay.' ],
                              ],
                  ]" />
                  <set_value name="$Tutorial_EmbarkAndUndock_TransporterHints_AlreadyTriggered" exact="true"/>
                </do_if>
                <find_npc_waypoint name="$TransporterSlot" object="player.room" tags="tag.npctransport"/>
                <do_if value="not @$TransporterSlot.count and player.room.dynamicinterior.exists">
                  <set_value name="$Rooms" exact="player.room.dynamicinterior.rooms"/>
                  <do_all exact="$Rooms.count" counter="$i">
                    <find_npc_waypoint name="$TransporterSlot" object="$Rooms.{$i}" tags="tag.npctransport"/>
                    <do_if value="$TransporterSlot">
                      <break/>
                    </do_if>
                  </do_all>
                </do_if>
                <do_if value="player.entity.distanceto.{$TransporterSlot} ge 3m">
                  <signal_cue_instantly cue="SetHintID" param="26300" comment="{1012, 26300}"/>
                </do_if>
              </actions>
              <cues>
                <cue name="Tutorial_TransporterRoom_Entered" checkinterval="0.1s">
                  <conditions>
                    <check_value value="player.entity.distanceto.{$TransporterSlot} lt 3m"/>
                  </conditions>
                  <actions>
                    <signal_cue cue="ShowHint_InteractFirstPerson"/>
                  </actions>
                </cue>

                <cue name="Tutorial_TransporterRoom_MenuOpened" instantiate="true">
                  <conditions>
                    <event_ui_triggered screen="'TransporterMenu'"/>
                  </conditions>
                  <actions>
                    <do_if value="event.param2 == ''">
                      <signal_cue_instantly cue="ClearHintID"/>
                      <do_if value="player.room != $PlayerShip.dock">
                        <substitute_text text="$TransporterHintText" source="{1012,26301}">
                          <replace string="'$NAME$'" with="$PlayerShip.name"/>
                        </substitute_text>
                        <signal_cue_instantly cue="SetHintText" param="$TransporterHintText"/>
                      </do_if>
                    </do_if>
                    <do_else>
                      <signal_cue_instantly cue="ClearHintID"/>
                    </do_else>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_EmbarkAndUndock_EmbarkHint" instantiate="true">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <do_if value="not $Tutorial_EmbarkAndUndock_EmbarkHint_AlreadyTriggered?">
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 1009, $comment = 'From here you need to embark and take the controls.' ],
                              ],
                  ]" />
                  <signal_cue_instantly cue="ClearHintID"/>
                  <set_value name="$Tutorial_EmbarkAndUndock_EmbarkHint_AlreadyTriggered" exact="true"/>
                </do_if>
                <signal_cue_instantly cue="SetHintID" param="26302" comment="{1012, 26302}"/>
              </actions>
            </cue>

            <cue name="Tutorial_EmbarkAndUndock_SitDownHint" instantiate="true">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_SitInChair"/>
                <cancel_cue cue="Tutorial_EmbarkAndUndock_EmbarkHint"/>
              </actions>
            </cue>

            <cue name="Tutorial_EmbarkAndUndock_UndockHint">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 2001, $comment = 'You are cleared for undocking. Proceed.' ],
                            ],
                ]" />
                <signal_cue cue="ShowHint_Undock"/>
                <show_help_overlay id="'docked_undock'" highlightonly="true"/>
                <set_objective cue="GameStart_Tutorial" action="objective.undock" />
                <cancel_cue cue="Tutorial_EmbarkAndUndock_SitDownHint"/>
              </actions>
            </cue>

            <cue name="Tutorial_EmbarkAndUndock_UndockingStarted">
              <conditions>
                <event_object_undocking_started group="$PlayerShipGroup"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'docked_undock'"/>
                <cancel_cue cue="Tutorial_EmbarkAndUndock_UndockHint"/>
              </actions>
            </cue>

            <cue name="Tutorial_EmbarkAndUndock_UndockingDone">
              <conditions>
                <event_object_undocked group="$PlayerShipGroup"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_EmbarkAndUndock"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BasicFlight_InitialUseCaseAndSetup">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 2002, $comment = 'Use the steering controls to turn your ship.' ],
                        ],
              $callbackcue = Tutorial_BasicFlight_InitialUseCaseAndSetup_Done,
              $abortcallbackcue = Tutorial_BasicFlight_InitialUseCaseAndSetup_Done,
            ]" />
            <lock_all_flight_input/>
          </actions>
          <cues>
            <cue name="Tutorial_BasicFlight_InitialUseCaseAndSetup_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BasicFlight_InitialUseCaseAndSetup"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ShipSteering">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller or player.input.joystick">
              <signal_cue cue="ShowHint_SteerShip_YawPitch"/>
              <signal_cue cue="Tutorial_ShipSteering_Objective"/>
            </do_if>
            <do_else>
              <signal_cue cue="Tutorial_ShipSteering_Mouse"/>
            </do_else>
            <unlock_flight_steering_input/>
          </actions>
          <cues>
            <cue name="Tutorial_ShipSteering_Mouse">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_ActivateMouseSteering"/>
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1066}"/>
              </actions>
              <cues>
                <cue name="Tutorial_ShipSteering_Mouse_SwitchedToStick" checkinterval="1ms">
                  <conditions>
                    <check_value value="player.input.controller or player.input.joystick"/>
                  </conditions>
                  <actions>
                    <signal_cue cue="Tutorial_ShipSteering_Objective"/>
                    <cancel_cue cue="Tutorial_ShipSteering_Mouse_TurnedOn"/>
                  </actions>
                </cue>

                <cue name="Tutorial_ShipSteering_Mouse_TurnedOn" checkinterval="1ms">
                  <conditions>
                    <check_value value="player.input.mousesteering.permanent"/>
                  </conditions>
                  <actions>
                    <signal_cue cue="Tutorial_ShipSteering_Objective"/>
                    <cancel_cue cue="Tutorial_ShipSteering_Mouse_SwitchedToStick"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_ShipSteering_Objective">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1068}"/>
                <do_if value="player.input.controller or player.input.joystick">
                  <signal_cue cue="ShowHint_SteerShip_YawPitch"/>
                </do_if>
                <do_else>
                  <signal_cue cue="ShowHint_UseMouseSteering"/>
                </do_else>
              </actions>
              <cues>
                <cue name="Tutorial_ShipSteering_Pitching" checkinterval="0.1s">
                  <conditions>
                    <check_value value="abs(player.input.flight.pitch) gt 0.2 and (player.input.controller or player.input.joystick or player.input.mousesteering.permanent)"/>
                  </conditions>
                  <delay exact="2s"/>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <do_if value="player.input.controller or player.input.joystick">
                      <do_if value="player.input.isinverted.flight.joystick.pitch">
                        <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1110}, [ 'invert_off', {30178,1118}, 2, 'invert_steering_pitch', false ], [ 'invert_on', {30178,1123} ], 'invertinput', 'right' ]]"/>
                      </do_if>
                      <do_else>
                        <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1112}, [ 'invert_on', {30178,1118}, 2, 'invert_steering_pitch', true ], [ 'invert_off', {30178,1122} ], 'invertinput', 'right' ]]"/>
                      </do_else>
                    </do_if>
                    <do_else>
                      <do_if value="player.input.isinverted.flight.mouse.pitch">
                        <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1110}, [ 'invert_off', {30178,1118}, 0, 'invert_mouse_pitch', false ], [ 'invert_on', {30178,1123} ], 'invertinput', 'right' ]]"/>
                      </do_if>
                      <do_else>
                        <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1112}, [ 'invert_on', {30178,1118}, 0, 'invert_mouse_pitch', true ], [ 'invert_off', {30178,1122} ], 'invertinput', 'right' ]]"/>
                      </do_else>
                    </do_else>
                  </actions>
                  <cues>
                    <cue name="Tutorial_ShipSteering_InvertQuestionAnsweredOrClosed">
                      <conditions>
                        <check_any>
                          <event_ui_triggered screen="'UserQuestionMenu'" control="'selected'"/>
                          <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                        </check_any>
                      </conditions>
                      <delay exact="1ms" comment="wait for input to be re-enabled or mouse steering will always be reported to be off"/>
                      <actions>
                        <do_if value="player.input.mousesteering.permanent">
                          <signal_cue cue="Tutorial_ShipSteering_MouseMode_TurnOffMode"/>
                        </do_if>
                        <do_else>
                          <signal_cue cue="Tutorial_ShipSteering_Done"/>
                        </do_else>
                      </actions>
                      <cues>
                        <cue name="Tutorial_ShipSteering_MouseMode_TurnOffMode">
                          <conditions>
                            <check_any>
                              <event_cue_signalled/>
                            </check_any>
                          </conditions>
                          <actions>
                            <do_if value="player.input.mousesteering.permanent">
                              <signal_cue cue="ShowHint_DeactivateMouseSteering"/>
                              <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1067}"/>
                            </do_if>
                          </actions>
                          <cues>
                            <cue name="Tutorial_ShipSteering_MouseMode_Off" checkinterval="0.1s">
                              <conditions>
                                <check_value value="not player.input.mousesteering.permanent"/>
                              </conditions>
                              <actions>
                                <signal_cue_instantly cue="ClearHintID"/>
                                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                                <signal_cue cue="Tutorial_ShipSteering_Done"/>
                              </actions>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_ShipSteering_Done">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ShipSteering"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ShipRoll_MappingCheck">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="not player.input.controller or player.input.ismapped.controller.INPUT_RANGE_STEERING_ROLL or player.input.autoroll">
              <signal_cue cue="Tutorial_ShipRoll_MappingCheck_Done"/>
            </do_if>
            <do_else>
              <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ 'Input Profile', {30178,1109}, [ 'autoroll', {30178,1124}, true ], [ 'map', {30178,1125} ], 'autoroll' ]]"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_ShipRoll_MappingCheck_QuestionAnsweredOrClosed">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'UserQuestionMenu'" control="'selected'"/>
                  <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                </check_any>
              </conditions>
              <actions>
                <do_if value="event.param3 == 'map'">
                  <open_menu menu="OptionsMenu" param="'keyboard_space'"/>
                  <signal_cue_instantly cue="SetHintPosition" param="5"/>
                  <signal_cue_instantly cue="SetHintID" param="26426" comment="{1012, 26426}"/>
                </do_if>
                <do_else>
                  <signal_cue cue="Tutorial_ShipRoll_MappingCheck_Done"/>
                </do_else>
              </actions>
              <cues>
                <cue name="Tutorial_ShipRoll_MappingCheck_InputMenuClosed">
                  <conditions>
                    <event_ui_triggered screen="'OptionsMenu'" control="'menu_close'"/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="SetHintPosition" param="1"/>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <signal_cue cue="Tutorial_ShipRoll_MappingCheck_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_ShipRoll_MappingCheck_Done">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ShipRoll_MappingCheck"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ShipRoll">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.autoroll">
              <signal_cue cue="Tutorial_ShipRoll_Done"/>
            </do_if>
            <do_else>
              <signal_cue cue="ShowHint_SteerShip_Roll"/>
              <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1069}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_ShipRoll_Rolling" checkinterval="0.1s">
              <conditions>
                <check_value value="abs(player.input.flight.roll) gt 0.2"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <do_if value="player.input.joystick">
                  <do_if value="player.input.isinverted.flight.joystick.roll">
                    <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1111}, [ 'invert_off', {30178,1118}, 3, 'invert_steering_roll', false ], [ 'invert_on', {30178,1123} ], 'invertinput', 'right' ]]"/>
                  </do_if>
                  <do_else>
                    <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {30178,1106}, {30178,1113}, [ 'invert_on', {30178,1118}, 3, 'invert_steering_roll', true ], [ 'invert_off', {30178,1122} ], 'invertinput', 'right' ]]"/>
                  </do_else>
                </do_if>
                <do_else>
                  <signal_cue cue="Tutorial_ShipRoll_Done"/>
                </do_else>
              </actions>
              <cues>
                <cue name="Tutorial_ShipRoll_InvertQuestionAnsweredOrClosed">
                  <conditions>
                    <check_any>
                      <event_ui_triggered screen="'UserQuestionMenu'" control="'selected'"/>
                      <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                    </check_any>
                  </conditions>
                  <actions>
                    <signal_cue cue="Tutorial_ShipRoll_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_ShipRoll_Done">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ShipRoll"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ShipStrafing">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <unlock_flight_strafe_input/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 2003, $comment = 'Now use the strafing controls to move sideways or vertically.' ],
                        ],
            ]" />
            <signal_cue cue="ShowHint_Strafe"/>
            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1070}"/>
          </actions>
          <cues>
            <cue name="Tutorial_ShipStrafing_Vertical" checkinterval="0.1s">
              <conditions>
                <check_value value="abs(player.input.flight.vertical) gt 0.2"/>
              </conditions>
              <actions>
                <set_value name="$Tutorial_ShipStrafing_VerticalDone" exact="true"/>
                <do_if value="$Tutorial_ShipStrafing_HorizontalDone?">
                  <signal_cue cue="Tutorial_ShipStrafing_Done"/>
                </do_if>
              </actions>
            </cue>

            <cue name="Tutorial_ShipStrafing_Horizontal" checkinterval="0.1s">
              <conditions>
                <check_value value="abs(player.input.flight.horizontal) gt 0.2"/>
              </conditions>
              <actions>
                <set_value name="$Tutorial_ShipStrafing_HorizontalDone" exact="true"/>
                <do_if value="$Tutorial_ShipStrafing_VerticalDone?">
                  <signal_cue cue="Tutorial_ShipStrafing_Done"/>
                </do_if>
              </actions>
            </cue>

            <cue name="Tutorial_ShipStrafing_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ShipStrafing"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ShipForward">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <unlock_all_flight_input/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 2004, $comment = 'OK. Before we continue, make sure that there’s no obstacle right in front of you. I can’t check from here so I have to trust you on this one...' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 2005, $comment = 'When you’re clear, gently accelerate forwards.' ],
                        ],
                $callbackcue = Tutorial_ShipForward_UseCase_Done,
                $abortcallbackcue = Tutorial_ShipForward_UseCase_Done,
            ]" />
            <set_objective cue="GameStart_Tutorial" action="objective.none"/>
          </actions>
          <cues>
            <cue name="Tutorial_ShipForward_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_Accelerate"/>
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1072}"/>
              </actions>
              <cues>
                <cue name="Tutorial_ShipForward_Moving" checkinterval="0.1s">
                  <conditions>
                    <check_value value="player.input.flight.throttle gt 0.2 and $PlayerShip.relvelocity.z gt 0"/>
                  </conditions>
                  <delay exact="2s"/>
                  <actions>
                    <signal_cue cue="Tutorial_ShipForward_Done"/>
                    <signal_cue_instantly cue="ClearHintID"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_ShipForward_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ShipForward"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ShipReverse_UseCase">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
          </actions>
          <cues>
          </cues>
        </cue>

        <cue name="Tutorial_ShipReverse">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 2006, $comment = 'There’s usually a speed limit inside docking areas, but you don’t have to worry about exceeding it; the ship’s computer will limit the speed for you.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 2007, $comment = 'You can also fly backwards. Try this now.' ],
                        ],
                $callbackcue = Tutorial_ShipReverse_UseCase_Done,
                $abortcallbackcue = Tutorial_ShipReverse_UseCase_Done,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_ShipReverse_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_Decelerate"/>
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1073}"/>
              </actions>
              <cues>
                <cue name="Tutorial_ShipReverse_Moving" checkinterval="0.1s">
                  <conditions>
                    <check_value value="player.input.flight.throttle lt -0.2 and $PlayerShip.relvelocity.z lt 0"/>
                  </conditions>
                  <delay exact="2s"/>
                  <actions>
                    <signal_cue cue="Tutorial_ShipReverse_Done"/>
                    <signal_cue_instantly cue="ClearHintID"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_ShipReverse_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ShipReverse"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_FullStop">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller or player.input.joystick or player.input.flight.throttle == 0">
              <signal_cue cue="Tutorial_FullStop_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="SetHintID" param="26419" comment="{1012, 26419}"/>
              <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1074}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_FullStop_Stopped" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.flight.throttle == 0"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue cue="Tutorial_FullStop_Done"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
              </actions>
            </cue>

            <cue name="Tutorial_FullStop_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_FullStop"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Camera_UseCase">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3001, $comment = 'Your ship’s sensors are all well and good, but sometimes it can be useful to get a more direct look at things.' ],
                        ],
                $callbackcue = Tutorial_Camera_UseCase_Done,
                $abortcallbackcue = Tutorial_Camera_UseCase_Done,
            ]" />
            <set_objective cue="GameStart_Tutorial" action="objective.none"/>
          </actions>
          <cues>
            <cue name="Tutorial_Camera_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Camera_UseCase"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_CockpitCamera">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller">
              <signal_cue cue="Tutorial_CockpitCamera_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3002, $comment = 'First, look around your cockpit. There are many different kinds, but ship cockpits often provide a wide field of view outside the ship.' ],
                          ],
                $callbackcue = Tutorial_CockpitCamera_SpeakFinished,
                $abortcallbackcue = Tutorial_CockpitCamera_SpeakFinished,
              ]" />
              <signal_cue_instantly cue="SetHintID" param="26500" comment="{1012, 26500}"/>
              <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1080}"/>
              <set_value name="$CockpitLookUsecaseSpoken" exact="true"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_CockpitCamera_LookingAround" checkinterval="0.1s">
              <conditions>
                <check_value value="player.camera.yaw != 0deg or player.camera.pitch != 0deg"/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_CockpitCamera_Done"/>
              </actions>
            </cue>

            <cue name="Tutorial_CockpitCamera_SpeakFinished">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <cues>
                <cue name="Tutorial_CockpitCamera_TimeOut">
                  <delay exact="10s"/>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <signal_cue cue="Tutorial_CockpitCamera_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_CockpitCamera_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_CockpitCamera"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ExternalCamera">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <set_control_mode_messages_disabled/>
            <do_if value="$CockpitLookUsecaseSpoken?">
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3003, $comment = 'You can also look at your ship from the outside, with the magic of camera drones. Try it.' ],
                          ],
              ]" />
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3012, $comment = 'You can look at your ship from the outside, with the magic of camera drones. Try it.' ],
                          ],
              ]" />
            </do_else>
            <signal_cue_instantly cue="SetHintID" param="[26502, 26501]" comment="{1012, 26502} or {1012, 26501}"/>
            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1081}"/>
          </actions>
          <cues>
            <cue name="Tutorial_ExternalCamera_Activated">
              <conditions>
                <event_player_activated_external_view/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3004, $comment = 'Fly around a bit to get a feel for how it behaves.' ],
                            ],
                ]" />
                <signal_cue_instantly cue="ClearHintID"/>
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1075}"/>
              </actions>
              <cues>
                <cue name="Tutorial_ExternalCamera_Delay">
                  <delay exact="10s"/>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <do_if value="player.input.controller">
                      <cancel_cue cue="Tutorial_ExternalCamera_Rotated"/>
                      <cancel_cue cue="Tutorial_ExternalCamera_Zoomed"/>
                      <signal_cue cue="Tutorial_ExternalCamera_Done"/>
                    </do_if>
                    <do_else>
                      <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                        $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                        $script = [
                                    table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3006, $comment = 'Try the camera controls now.' ],
                                  ],
                        $callbackcue = Tutorial_ExternalCamera_SpeakFinished,
                        $abortcallbackcue = Tutorial_ExternalCamera_SpeakFinished,
                      ]" />
                      <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1079}"/>
                      <signal_cue_instantly cue="SetHintID" param="26505" comment="{1012, 26505}"/>
                      <set_value name="$StartCameraYaw" exact="player.camera.yaw"/>
                      <set_value name="$StartCameraPitch" exact="player.camera.pitch"/>
                      <set_value name="$StartCameraZoom" exact="player.camera.zoom"/>
                    </do_else>
                  </actions>
                  <cues>
                    <cue name="Tutorial_ExternalCamera_Rotated" checkinterval="0.1s">
                      <conditions>
                        <check_value value="$StartCameraYaw? and $StartCameraPitch? and player.camera.yaw != $StartCameraYaw and player.camera.pitch != $StartCameraPitch"/>
                      </conditions>
                      <actions>
                        <set_value name="$Tutorial_ExternalCamera_Rotated_Done" exact="true"/>
                        <do_if value="$Tutorial_ExternalCamera_Zoomed_Done?">
                          <signal_cue cue="Tutorial_ExternalCamera_Done"/>
                        </do_if>
                      </actions>
                    </cue>

                    <cue name="Tutorial_ExternalCamera_Zoomed" checkinterval="0.1s">
                      <conditions>
                        <check_value value="$StartCameraZoom? and player.camera.zoom != $StartCameraZoom"/>
                      </conditions>
                      <actions>
                        <set_value name="$Tutorial_ExternalCamera_Zoomed_Done" exact="true"/>
                        <do_if value="$Tutorial_ExternalCamera_Rotated_Done?">
                          <signal_cue cue="Tutorial_ExternalCamera_Done"/>
                        </do_if>
                      </actions>
                    </cue>

                    <cue name="Tutorial_ExternalCamera_SpeakFinished">
                      <conditions>
                        <event_cue_signalled/>
                      </conditions>
                      <cues>
                        <cue name="Tutorial_ExternalCamera_TimeOut">
                          <delay exact="10s"/>
                          <actions>
                            <signal_cue_instantly cue="ClearHintID"/>
                            <signal_cue cue="Tutorial_ExternalCamera_Done"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_ExternalCamera_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <reset_control_mode_messages/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ExternalCamera"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ExternalTargetCamera">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <create_ship name="$ExternalTargetCameraShip" macro="macro.ship_gen_s_fightingdrone_01_a_macro" sector="$PlayerShip.sector" capturable="false">
              <owner exact="faction.argon" overridenpc="true" />
              <pilot>
                <select race="race.drone" tags="tag.aipilot"/>
              </pilot>
              <safepos object="player.ship" z="1km"/>
            </create_ship>
            <set_object_min_hull object="$ExternalTargetCameraShip" exact="100"/>
            <create_order object="$ExternalTargetCameraShip" id="'Wait'" default="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3013, $comment = 'This also works on targets within range.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3014, $comment = 'Select the nearby ship.',
                                  $speakcallbackcue = Tutorial_ExternalTargetCamera_SelectShipObjective ],
                        ],
            ]" />

          </actions>
          <cues>
            <cue name="Tutorial_ExternalTargetCamera_SelectShipObjective">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1081}" object="$ExternalTargetCameraShip"/>
              </actions>
            </cue>

            <cue name="Tutorial_ExternalTargetCamera_ShipSelected">
              <conditions>
                <event_player_changed_target/>
                <check_value value="player.target == $ExternalTargetCameraShip"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3015, $comment = 'Now activate external target view.' ],
                            ],
                ]" />
                <signal_cue_instantly cue="SetHintID" param="[26509, 26510]" comment="{1012, 26509} or {1012, 26510}"/>
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1146}"/>
              </actions>
            </cue>

            <cue name="Tutorial_ExternalTargetCamera_Activated">
              <conditions>
                <event_player_activated_external_target_view/>
                <!--for simplicity we don't enforce doing it on a specific target, even though we guide to one-->
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3016, $comment = 'The camera controls work just like in the other external view.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3017, $comment = 'Try them if youd like.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3018, $comment = 'Return to cockpit view to move on.' ],
                            ],
                ]" />
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1084}"/>
                <signal_cue_instantly cue="SetHintID" param="[26507, 26506]" comment="{1012, 26507} or {1012, 26506}"/>
                <create_order object="$ExternalTargetCameraShip" id="'Wait'" default="true">
                  <param name="fidget" value="true"/>
                </create_order>
              </actions>
              <cues>
                <cue name="Tutorial_ExternalTargetCamera_ReturnedToCockpit">
                  <conditions>
                    <event_player_activated_cockpit_view/>
                  </conditions>
                  <actions>
                    <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <signal_cue cue="Tutorial_ExternalTargetCamera_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_ExternalTargetCamera_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ExternalTargetCamera"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_FloatingCamera">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.input.controller">
              <signal_cue cue="Tutorial_FloatingCamera_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3008, $comment = 'You can even tell a camera drone to stay in a fixed location. Try this now.' ],
                          ],
              ]" />
              <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1083}"/>
              <signal_cue_instantly cue="SetHintID" param="26508" comment="{1012, 26508}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_FloatingCamera_Activated">
              <conditions>
                <event_player_activated_floating_view/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3009, $comment = 'The controls here behave a little differently. Play around with them now. Return to cockpit view to move on.' ],
                            ],
                  $callbackcue = Tutorial_FloatingCamera_SpeakFinished,
                  $abortcallbackcue = Tutorial_FloatingCamera_SpeakFinished,
                ]" />
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1078}"/>
                <signal_cue_instantly cue="SetHintID" param="26505" comment="{1012, 26505}"/>
                <set_value name="$StartCameraYaw" exact="player.camera.yaw"/>
                <set_value name="$StartCameraPitch" exact="player.camera.pitch"/>
              </actions>
              <cues>
                <cue name="Tutorial_FloatingCamera_LookingAround" checkinterval="0.1s">
                  <conditions>
                    <check_value value="(player.camera.yaw gt $StartCameraYaw + 1deg or player.camera.yaw lt $StartCameraYaw - 1deg) and (player.camera.pitch gt $StartCameraPitch + 1deg or player.camera.pitch lt $StartCameraPitch - 1deg)"/>
                  </conditions>
                  <delay exact="2s"/>
                  <actions>
                    <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1084}"/>
                    <signal_cue_instantly cue="SetHintID" param="26507" comment="{1012, 26507}"/>
                  </actions>
                </cue>

                <cue name="Tutorial_FloatingCamera_SpeakFinished">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <cues>
                    <cue name="Tutorial_FloatingCamera_TimeOut">
                      <delay exact="10s"/>
                      <actions>
                        <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1084}"/>
                        <signal_cue_instantly cue="SetHintID" param="26507" comment="{1012, 26507}"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="Tutorial_FloatingCamera_ReturnedToCockpit">
                  <conditions>
                    <event_player_activated_cockpit_view/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <signal_cue cue="Tutorial_FloatingCamera_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_FloatingCamera_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_FloatingCamera"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ToggleCockpit">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="not player.input.ismapped.INPUT_ACTION_TOGGLECOCKPIT or (player.input.controller and not player.input.ismapped.controller.INPUT_ACTION_TOGGLECOCKPIT)">
              <signal_cue cue="Tutorial_ToggleCockpit_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3011, $comment = 'If you’d like to see what’s in front of you with fewer obstructions you can even make the cockpit practically invisible to you. Is there anything camera drones can’t do? Try it now.' ],
                          ],
                $callbackcue = Tutorial_ToggleCockpit_SpeakFinished,
                $abortcallbackcue = Tutorial_ToggleCockpit_SpeakFinished,
              ]" />
              <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1085}"/>
              <signal_cue_instantly cue="SetHintID" param="26600" comment="{1012, 26600}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_ToggleCockpit_ToggledCockpit">
              <conditions>
                <event_player_toggled_cockpit/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="SetHintID" param="26601" comment="{1012, 26601}"/>
              </actions>
              <cues>
                <cue name="Tutorial_ToggleCockpit_ToggledCockpitAgain">
                  <conditions>
                    <event_player_toggled_cockpit/>
                  </conditions>
                  <actions>
                    <signal_cue cue="Tutorial_ToggleCockpit_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_ToggleCockpit_SpeakFinished">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <cues>
                <cue name="Tutorial_ToggleCockpit_TimeOut">
                  <delay exact="10s"/>
                  <actions>
                    <signal_cue cue="Tutorial_ToggleCockpit_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_ToggleCockpit_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
              </actions>
              <delay exact="2s"/>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ToggleCockpit"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_LiveStream">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="not player.input.ismapped.INPUT_ACTION_CINEMATIC_CAMERA or (player.input.controller and not player.input.ismapped.controller.INPUT_ACTION_CINEMATIC_CAMERA)">
              <signal_cue cue="Tutorial_LiveStream_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3019, $comment = 'You can even get a live stream of various places around the galaxy.' ],
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =   15, $comment = 'Do so now.' ],
                          ],
              ]" />
              <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1147}"/>
              <signal_cue_instantly cue="SetHintID" param="26511" comment="{1012,26511}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_LiveStream_Activated">
              <conditions>
                <check_any>
                  <event_object_signalled object="player.entity" param="'activate_cinematic_camera'"/>
                  <event_object_signalled object="player.entity" param="'activate_liveStream_Map'"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3020, $comment = 'This mode automatically cycles between objects you have access to.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3021, $comment = 'It starts out with your personal channel, which cycles through the objects you own.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3022, $comment = 'Since you only one this one ship at the moment its not very exciting yet.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3023, $comment = 'Ive unlocked another factions channel as well.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3024, $comment = 'Youll get access to these as you increase your rank with them.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3025, $comment = 'You can either wait for the channel to automatically switch, or use the controls in the top right of the screen to do so yourself.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3026, $comment = 'With these controls you can also lock a channel or object to keep the mode from switching.' ],
                            ],
                  $callbackcue = Tutorial_LiveStream_Done,
                  $abortcallbackcue = Tutorial_LiveStream_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_LiveStream_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_LiveStream"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <!--not currently used for two reasons: hints are not visible during live stream view, and switching channels doesn't seem to work in this tutorial-->
        <cue name="Tutorial_LiveStream_LockTarget">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="not player.input.ismapped.INPUT_ACTION_CINEMATIC_CAMERA or (player.input.controller and not player.input.ismapped.controller.INPUT_ACTION_CINEMATIC_CAMERA)">
              <signal_cue cue="Tutorial_LiveStream_LockTarget_UseCase_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3027, $comment = 'Use the controls to cycle to the Wharf, then lock it in.' ],
                          ],
              ]" />
              <signal_cue_instantly cue="SetHintID" param="100218" comment="{1012,100218}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_LiveStream_LockTarget_Done">
              <conditions>
                <event_object_signalled object="player.entity" param="'cinematic_camera_lock_target'"/>
                <check_value value="md.CinematicCamera.CinematicCameraManager.$StickyTarget == $Wharf"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20, $comment = 'Well done.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_LiveStream_LockTarget_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_LiveStream_LockTarget"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_LiveStream_ReturnToCockpit">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="not player.input.ismapped.INPUT_ACTION_CINEMATIC_CAMERA or (player.input.controller and not player.input.ismapped.controller.INPUT_ACTION_CINEMATIC_CAMERA)">
              <signal_cue cue="Tutorial_LiveStream_ReturnToCockpit_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3028, $comment = 'Feel free to stay in this mode for as long as youd like.' ],
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 3029, $comment = 'Return to cockpit view to end this lesson.' ],
                          ],
              ]" />
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_LiveStream_ReturnToCockpit_Done">
              <conditions>
                <event_player_activated_cockpit_view/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_LiveStream_ReturnToCockpit"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Boost">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =  2009, $comment = 'Now I need you to make sure that there really is nothing in front of you.' ],
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =  2010, $comment = 'When youre ready, strap in and hit your ships boost.' ],
                          ],
                $callbackcue = ShowHint_Boost,
                $abortcallbackcue = ShowHint_Boost,
              ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Boost_Done">
              <conditions>
                <event_player_boost_started/>
              </conditions>
              <delay exact="1s"/>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =  4012, $comment = 'You have a limited pool of boost energy, so use it wisely.' ],
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =  4013, $comment = 'Your remaining boost energy is shown on the speed bar, right below your crosshair.' ],
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =  4009, $comment = 'You may also notice that it has set your speed to maximum. This is normal and will only persist until you change speed again. Some pilots even find it a convenient way to set their speed to maximum.' ],
                              ],
                    $callbackcue = Tutorial_Boost_UseCase_Done,
                    $abortcallbackcue = Tutorial_Boost_UseCase_Done,
                  ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Boost_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Boost"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TestCourse">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="$PlayerShip.speedlimit ge 0">
              <signal_cue cue="Tutorial_TestCourse_LeaveDockArea"/>
            </do_if>
            <do_else>
              <signal_cue cue="Tutorial_TestCourse_Setup"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_TestCourse_LeaveDockArea">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 4001, $comment = 'Please fly out of the docking area now.' ],
                            ],
                ]" />
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1086}"/>
              </actions>
              <cues>
                <cue name="Tutorial_TestCourse_DockAreaLeft" checkinterval="0.1s">
                  <conditions>
                    <check_value value="$PlayerShip.speedlimit lt 0"/>
                  </conditions>
                  <actions>
                    <signal_cue cue="Tutorial_TestCourse_Setup"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_TestCourse_Setup">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <do_if value="player.module == 'tutorial_flight'">
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 4002, $comment = 'So, let’s practice what you’ve learned so far.' ],
                              ],
                  ]" />
                </do_if>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 4003, $comment = 'I’ve prepared a little course for you.' ],
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 4004, $comment = 'Please fly close to each of the navigation beacons in turn.' ],
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 4005, $comment = 'Your next target will always be marked in orange.' ],
                            ],
                ]" />
                <!--create a sequence of nav beacons for the player to fly past-->
                <create_object groupname="$FlyToBeacons" macro="macro.env_deco_nav_beacon_t1_macro" sector="$PlayerShip.sector">
                  <position object="$Wharf" x="525" y="165" z="1330"/>
                </create_object>
                <create_object groupname="$FlyToBeacons" macro="macro.env_deco_nav_beacon_t2_macro" sector="$PlayerShip.sector">
                  <position object="$Wharf" x="525" y="225" z="-285"/>
                </create_object>
                <create_object groupname="$FlyToBeacons" macro="macro.env_deco_nav_beacon_t3_macro" sector="$PlayerShip.sector">
                  <position object="$Wharf" x="270" y="275" z="-1690"/>
                </create_object>
                <create_object groupname="$FlyToBeacons" macro="macro.env_deco_nav_beacon_t4_macro" sector="$PlayerShip.sector">
                  <position object="$Wharf" x="-815" y="40" z="-30"/>
                </create_object>
                <create_object groupname="$FlyToBeacons" macro="macro.env_deco_nav_beacon_t5_macro" sector="$PlayerShip.sector">
                  <position object="$Wharf" x="-773" y="-75" z="2390"/>
                </create_object>
                <set_value name="$TotalNumBeacons" exact="$FlyToBeacons.count"/>
                <set_value name="$FastFinish" exact="true"/>
                <signal_cue cue="Tutorial_TestCourse_UpdateObjective"/>
              </actions>
              <cues>
                <cue name="Tutorial_TestCourse_UpdateObjective" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <set_objective cue="GameStart_Tutorial" action="objective.flyto" object="$FlyToBeacons.{1}">
                      <progress text="{30178,1096}" progress="$TotalNumBeacons - $FlyToBeacons.count" max="$TotalNumBeacons" />
                    </set_objective>
                  </actions>
                </cue>

                <cue name="Tutorial_TestCourse_TargetReached" checkinterval="0.1s">
                  <conditions>
                    <check_value value="$FlyToBeacons? and $PlayerShip.distanceto.{$FlyToBeacons.{1}} lt 100m"/>
                  </conditions>
                  <actions>
                    <set_value name="$ReachedBeacon" exact="$FlyToBeacons.{1}"/>
                    <remove_from_group group="$FlyToBeacons" object="$ReachedBeacon"/>
                    <destroy_object object="$ReachedBeacon"/>
                    <do_if value="$FlyToBeacons.count">
                      <signal_cue cue="Tutorial_TestCourse_UpdateObjective"/>
                      <signal_cue cue="Tutorial_TestCourse_Timer" check="false"/>
                      <reset_cue cue="this"/>
                      <do_if value="$FastFinish?">
                        <reset_cue cue="Tutorial_TestCourse_TimeCheck"/>
                      </do_if>
                    </do_if>
                    <do_else>
                      <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                      <signal_cue cue="Tutorial_TestCourse_Done"/>
                    </do_else>
                  </actions>
                </cue>

                <cue name="Tutorial_TestCourse_Timer">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <cues>
                    <cue name="Tutorial_TestCourse_TimeCheck" checktime="player.age + 10s">
                      <actions>
                        <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                          $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                          $script = [
                                      table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 4006, $comment = 'Don’t worry, you’re not being timed.' ],
                                    ],
                        ]" />
                        <remove_value name="$FastFinish"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_TestCourse_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_TestCourse_TimeCheck"/>
                <do_if value="$FastFinish?">
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 4010, $comment = 'Not bad!' ],
                              ],
                    $callbackcue = Tutorial_TestCourse_UseCase_Done,
                    $abortcallbackcue = Tutorial_TestCourse_UseCase_Done,
                  ]" />
                </do_if>
                <do_else>
                  <signal_cue cue="Tutorial_TestCourse_UseCase_Done"/>
                </do_else>
                <signal_cue_instantly cue="ClearHintID"/>
              </actions>
            </cue>

            <cue name="Tutorial_TestCourse_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help line="2020"/>
                <remove_help line="2021"/>
                <cancel_cue cue="Tutorial_TestCourse_TimeCheck"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_FullStop"/>
                <cancel_cue cue="Tutorial_TestCourse"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TravelMode_RestartHelper" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_objective cue="GameStart_Tutorial" action="objective.none"/>
            <signal_cue cue="Tutorial_TravelMode"/>
          </actions>
        </cue>

        <cue name="Tutorial_TravelMode">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="not $Tutorial_TravelMode_Repeat?">
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 5001, $comment = 'This next thing is something you are going to be using a lot.',
                                   $speakcallbackcue = Tutorial_TravelMode_ActivateAlignObjective ],
                            table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 5002, $comment = 'I’ve marked a remote location for you to fly to. Don’t worry; I don’t expect you to crawl there at your base speed.' ],
                          ],
              ]" />
            </do_if>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 5003, $comment = 'First, please align your ship so that it points roughly towards the target.' ],
                        ],
                $callbackcue = Tutorial_TravelMode_StartAlignmentChecks,
                $abortcallbackcue = Tutorial_TravelMode_StartAlignmentChecks,
            ]" />
            <do_if value="not @$FlyToBeacon.exists">
              <create_object name="$FlyToBeacon" macro="macro.env_deco_nav_beacon_t1_macro" sector="$PlayerShip.sector">
                <position x="9000km" comment="do not use coordinates >= 10000km"/>
              </create_object>
            </do_if>
          </actions>
          <cues>
            <cue name="Tutorial_TravelMode_PrematureStart">
              <conditions>
                <check_any>
                  <event_player_travelmode_charge_started/>
                  <event_player_travelmode_started/>
                </check_any>
                <check_value value="@$FlyToBeacon.exists"/>
                <check_object object="$FlyToBeacon">
                  <match_is_in_view_of object="player.ship" vertical="10deg" horizontal="10deg" negate="true"/>
                </check_object>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 5, $comment = 'That was too early.' ],
                              table[ $actor = '$FlightInstructor', $selectspeak = [6, 7, 8], $comment = 'Variations on ’Try again’' ],
                            ],
                ]" />
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1091}"/>
              </actions>
              <cues>
                <cue name="Tutorial_TravelMode_PrematureStart_Recovery">
                  <conditions>
                    <check_any>
                      <event_player_travelmode_stopped/>
                      <event_player_travelmode_charge_aborted/>
                      <event_player_stopped_control/>
                    </check_any>
                  </conditions>
                  <actions>
                    <signal_cue cue="Tutorial_TravelMode_ActivateAlignObjective"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_TravelMode_ActivateAlignObjective" instantiate="true">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1089}" object="$FlyToBeacon"/>
              </actions>
            </cue>

            <cue name="Tutorial_TravelMode_StartAlignmentChecks">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <cues>
                <cue name="Tutorial_TravelMode_Aligned" checkinterval="0.1s">
                  <conditions>
                    <check_value value="@$FlyToBeacon.exists"/>
                    <check_object object="$FlyToBeacon">
                      <match_is_in_view_of object="player.ship" vertical="10deg" horizontal="10deg"/>
                    </check_object>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <cancel_cue cue="Tutorial_TravelMode_ActivateAlignObjective"/>
                    <cancel_cue cue="Tutorial_TravelMode_PrematureStart"/>
                    <do_if value="$PlayerShip.travel.charging or $PlayerShip.travel.active">
                      <do_if value="not $Tutorial_TravelMode_Repeat?">
                        <signal_cue cue="PlayerAlreadyKnewUseCase"/>
                      </do_if>
                      <signal_cue cue="Tutorial_TravelMode_Started"/>
                    </do_if>
                    <do_else>
                      <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                        $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                        $script = [
                                    table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 5004, $comment = 'Now activate travel mode.' ],
                                    table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 5005, $comment = 'Depending on your engine type, it may take a little time to get started.' ],
                                  ],
                      ]" />
                      <signal_cue cue="ShowHint_ActivateTravelMode"/>
                      <remove_help_overlay all="true"/>
                      <show_help_overlay id="'docked_modes'" highlightonly="true"/>
                      <show_help_overlay id="'docked_mode_dropdown_travel'" highlightonly="true"/>
                      <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1090}" object="$FlyToBeacon"/>
                      <set_value name="$TravelModeHintActive" exact="true"/>
                    </do_else>
                  </actions>
                  <cues>
                    <cue name="Tutorial_TravelMode_Activated">
                      <conditions>
                        <check_any>
                          <event_player_travelmode_charge_started/>
                          <event_player_travelmode_started/>
                        </check_any>
                      </conditions>
                      <actions>
                        <signal_cue_instantly cue="ClearHintID"/>
                        <remove_help_overlay id="'docked_modes'"/>
                        <remove_help_overlay id="'docked_mode_dropdown_travel'"/>
                        <remove_value name="$TravelModeHintActive"/>
                        <do_if value="$ShipMenuOpen?">
                          <signal_cue cue="ShowHint_CloseMenus"/>
                        </do_if>
                      </actions>
                      <cues>
                        <cue name="Tutorial_TravelMode_MenuClosed">
                          <conditions>
                            <event_ui_triggered screen="'DockedMenu'" control="'menu_close'"/>
                          </conditions>
                          <actions>
                            <signal_cue_instantly cue="ClearHintID"/>
                            <do_if value="$PlayerShip.travel.active">
                              <signal_cue cue="Tutorial_TravelMode_Started" check="false"/>
                            </do_if>
                          </actions>
                        </cue>
                      </cues>
                    </cue>

                    <cue name="Tutorial_TravelMode_Started">
                      <conditions>
                        <check_any>
                          <event_cue_signalled/>
                          <check_all>
                            <event_player_travelmode_started/>
                            <check_value value="not $ShipMenuOpen?"/>
                          </check_all>
                        </check_any>
                      </conditions>
                      <delay exact="1ms"/>
                      <actions>
                        <set_value name="$TargetSpeed" exact="$PlayerShip.travel.maxspeed * 0.99"/>
                        <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1076}" object="$FlyToBeacon">
                          <progress progress="0" max="100"/>
                        </set_objective>
                        <do_if value="not $Tutorial_TravelMode_Repeat?">
                          <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                            $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                            $script = [
                                        table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 5006, $comment = 'Look at your speed bar, just below the cross-hairs.' ],
                                        table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 5007, $comment = 'You will keep accelerating for a while until you reach your ship’s top travel speed.' ],
                                        table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 5024, $comment = 'You’ve probably noticed other modes in the list when you activated this one.' ],
                                        table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 5025, $comment = 'Each mode has its special use, and only one mode can be active at a time.' ],
                                      ],
                          ]" />
                        </do_if>
                        <lock_flight_throttle_input/>
                      </actions>
                      <cues>
                        <cue name="Tutorial_TravelMode_StoppedTooEarly">
                          <conditions>
                            <check_any>
                              <event_player_travelmode_stopped/>
                              <event_player_stopped_control/>
                            </check_any>
                          </conditions>
                          <delay exact="1ms"/>
                          <actions>
                            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                              $script = [
                                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 5, $comment = 'That was too early.' ],
                                          table[ $actor = '$FlightInstructor', $selectspeak = [6, 7, 8], $comment = 'Variations on ’Try again’' ],
                                        ],
                            ]" />
                            <set_value name="$Tutorial_TravelMode_Repeat" exact="true"/>
                            <reset_cue cue="Tutorial_TravelMode"/>
                            <signal_cue cue="Tutorial_TravelMode_RestartHelper"/>
                          </actions>
                        </cue>

                        <cue name="Tutorial_TravelMode_GainSpeedObjective">
                          <delay exact="1ms"/>
                          <actions>
                            <update_objective_progress cue="GameStart_Tutorial" progress="1000 * $PlayerShip.speed / $TargetSpeed" max="900" silent="true"/>
                            <reset_cue cue="this"/>
                          </actions>
                        </cue>

                        <cue name="Tutorial_TravelMode_GainedSpeed" checkinterval="0.1s">
                          <conditions>
                            <check_value value="$PlayerShip.speed ge $PlayerShip.travel.maxspeed * 0.9"/>
                          </conditions>
                          <actions>
                            <cancel_cue cue="Tutorial_TravelMode_StoppedTooEarly"/>
                            <cancel_cue cue="Tutorial_TravelMode_GainSpeedObjective"/>
                            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                              $script = [
                                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 5026, $comment = 'Whenever you’re ready, quickly drop out of travel mode.' ],
                                        ],
                            ]" />
                            <signal_cue_instantly cue="SetHintID" param="[4308, 4309]" comment="{1012, 4308} or {1012, 4309}"/>
                            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1092}"/>
                            <unlock_flight_throttle_input/>
                          </actions>
                          <cues>
                            <cue name="Tutorial_TravelMode_StoppedAndSlowedDown" checkinterval="0.1s">
                              <conditions>
                                <check_value value="not $PlayerShip.travel.active and $PlayerShip.speed le $PlayerShip.maxspeed * 1.1"/>
                              </conditions>
                              <actions>
                                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                                <signal_cue_instantly cue="ClearHintID"/>
                                <signal_cue cue="Tutorial_TravelMode_Done"/>
                              </actions>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_TravelMode_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <destroy_object object="$FlyToBeacon" explosion="false"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_TravelMode"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_AutoPilot_Start">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 6001, $comment = 'Great. The next part will take place some distance from here, so let’s take a break and let the autopilot do the hard work for now.' ],
                        ],
            ]" />
            <create_position name="$AutoPilotTargetOffset" x="-50km" y="25km" z="-100km"/>
            <set_objective cue="GameStart_Tutorial" action="objective.flyto" object="player.sector" offset="$AutoPilotTargetOffset"/>
            <signal_cue_instantly cue="SetHintID" param="26802" comment="{1012, 26802}"/>
            <set_value name="$AutoPilotHintActive" exact="true"/>
            <show_help_overlay id="'docked_autopilot'" highlightonly="true"/>
          </actions>
          <cues>
            <cue name="Tutorial_AutoPilot_Activated">
              <conditions>
                <event_autopilot_target_set/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 6002, $comment = 'The autopilot automatically navigates to the current objective. It engages travel mode when appropriate, and makes use of gates, accelerators and highways.' ],
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 6003, $comment = 'It even avoids obstacles in the way. Well, mostly, which is why you still need to be at the controls.' ],
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 6006, $comment = 'You may notice that it sometimes turns travel mode off when everything seems wide open to you. The safeties are on a bit of a hair trigger, probably to keep insurance rates from skyrocketing...' ],
                            ],
                  $callbackcue = Tutorial_AutoPilot_SpeaksFinished,
                  $abortcallbackcue = Tutorial_AutoPilot_SpeaksFinished,
                ]" />
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'docked_autopilot'"/>
              </actions>
              <cues>
                <cue name="Tutorial_AutoPilot_SpeaksFinished">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue cue="Tutorial_AutoPilot_Start_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_AutoPilot_Start_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_AutoPilot_Start"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_HighwaysAndGates_Setup">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <find_gate groupname="$gates" space="player.galaxy" multiple="true"/>
            <do_for_each name="$gate" in="$gates">
              <set_known object="$gate" known="true"/>
            </do_for_each>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30001, $comment = 'Today well learn how to use the various means of travelling between sectors.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30029, $comment = 'Before we start, please note the yellow icon below your crosshair.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30030, $comment = 'The manuals call it the check engine light but Ive never seen an engine that looks like that...' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30031, $comment = 'It means that you cant make use of your travel mode right now.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30032, $comment = 'Thats because this lesson takes place in a region that prevents it from working.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30033, $comment = 'Being hit by a weapon disables your travel drive for a short time as well, so dont rely on it to get out of trouble.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30034, $comment = 'Ive also heard of weapons that target this system specifically to make you an easy target for pirates.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30035, $comment = 'Now on to the actual lesson at hand.' ],
                        ],
              $callbackcue = Tutorial_HighwaysAndGates_Setup_UseCase_Done,
              $abortcallbackcue = Tutorial_HighwaysAndGates_Setup_UseCase_Done,
            ]" />
            <lock_all_flight_input/>
          </actions>
          <cues>
            <cue name="Tutorial_HighwaysAndGates_Setup_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <unlock_all_flight_input/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_HighwaysAndGates_Setup"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Jumpgate">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30002, $comment = 'In front of you is a jump gate.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30003, $comment = 'Sometimes youll find one thats inactive.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30004, $comment = 'This ones working, though, which you can tell from the swirly bits in the middle.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30005, $comment = 'To use it, simply fly through.' ],
                        ],
            ]" />
            <find_sector name="$TargetSector" macro="macro.basegame_map_tutorial_gates_highways_cluster_004_sector_001_macro"/>
            <set_value name="$TargetPosition" exact="position.[-5km, 0m, -400km]"/>
            <set_value name="$MaxTargetDistance" exact="50km"/>
            <set_objective cue="GameStart_Tutorial" action="objective.flyto" object="$TargetSector" offset="$TargetPosition"/>
          </actions>
          <cues>
            <cue name="Tutorial_Jumpgate_Done">
              <conditions>
                <event_object_changed_sector group="$PlayerShipGroup"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30006, $comment = 'Thats all there is to it.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Jumpgate"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Accelerator">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30007, $comment = 'Now, Ive been told that the technology is totally different, but in practice these transorbital accelerators function pretty much exactly like jump gates.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30008, $comment = 'Fly through this one.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Accelerator_Done">
              <conditions>
                <event_object_changed_sector group="$PlayerShipGroup"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30009, $comment = 'While jumpgates connect different star systems, accelerators take you to different places within the same one.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Accelerator"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_SuperHighway">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30010, $comment = 'Up next, a superhighway.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30011, $comment = 'They also take you to sectors within a star system.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30012, $comment = 'The main difference is that they are directional, so you need to use the entry gate, not the exit.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30013, $comment = 'Fly into the entry gate.' ],
                        ],
            ]" />
            <set_value name="$SuperHighwayStartSector" exact="player.sector"/>
          </actions>
          <cues>
            <cue name="Tutorial_SuperHighway_Done">
              <conditions>
                <event_object_changed_zone group="$PlayerShipGroup"/>
                <check_value value="event.param.issuperhighway"/>
              </conditions>
              <actions>
                <debug_text text="'entered ' + event.param.knownname + ' to ' + event.param.destination.sector.knownname"/>
                <debug_text text="'started in ' + $SuperHighwayStartSector.knownname"/>
                <do_if value="event.param.destination.sector == $SuperHighwayStartSector">
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30036, $comment = 'That was the exit gate.' ],
                                table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30013, $comment = 'Fly into the entry gate.' ],
                              ],
                  ]" />
                  <reset_cue cue="this"/>
                </do_if>
                <do_else>
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30014, $comment = 'As you see its a tiny bit slower than the other methods.' ],
                                table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30015, $comment = 'I like it, though, lets me enjoy the view.' ],
                              ],
                  ]" />
                  <signal_cue cue="Tutorial_TriggerNext"/>
                  <cancel_cue cue="Tutorial_SuperHighway"/>
                </do_else>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_SuperHighway_Exit_AbortCoasting">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="Tutorial_TriggerNext"/>
          </actions>
          <cues>
            <cue name="Tutorial_SuperHighway_Exited" instantiate="true">
              <conditions>
                <event_object_changed_zone group="$PlayerShipGroup"/>
                <check_value value="event.param2.issuperhighway and not event.param.issuperhighway"/>
              </conditions>
              <actions>
                <force_player_speed speed="1"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_LocalHighway">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30016, $comment = 'Highways can also be local.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30017, $comment = 'The entry of one is right in front of you.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30018, $comment = 'Fly into it.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_LocalHighway_Entered">
              <conditions>
                <event_object_changed_zone group="$PlayerShipGroup"/>
                <check_value value="player.ship.zone.islocalhighway"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30019, $comment = 'It has a much lower speed than the superhighway we just came out of, but its still a whole lot faster than most ships can travel on their own.' ],
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30020, $comment = 'Its not wide enough for capital ships, though.' ],
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30021, $comment = 'Medium-sized ships are the largest that can use them.' ],
                            ],
                ]" />
              </actions>
              <cues>
                <cue name="Tutorial_LocalHighway_Left">
                  <conditions>
                    <event_object_changed_zone group="$PlayerShipGroup"/>
                    <check_value value="not player.ship.zone.islocalhighway"/>
                  </conditions>
                  <actions>
                    <signal_cue cue="Tutorial_TriggerNext"/>
                    <cancel_cue cue="Tutorial_LocalHighway"/>
                  </actions>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_LocalHighwayWithGate">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30022, $comment = 'Local highways can be entered and exited at any point along the way.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30023, $comment = 'Fly into the one right in front of you.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_LocalHighwayWithGate_Done">
              <conditions>
                <event_object_changed_zone group="$PlayerShipGroup"/>
                <check_value value="player.ship.zone.islocalhighway and player.ship.zone.exitjumpgate"/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_LocalHighwayWithGate"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_LocalHighwayThroughGate">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30024, $comment = 'This highway is special in that it leads you right into a jumpgate.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30025, $comment = 'You dont have to do anything, the transition will just work on its own.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_LocalHighwayThroughGate_Done">
              <conditions>
                <event_object_changed_sector group="$PlayerShipGroup"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                        table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 33, $comment = 'There we go.' ],
                      ],
                ]" />
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_LocalHighwayThroughGate"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_LocalHighwayExitInMiddle">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30026, $comment = 'Please pay attention to the objective in the corner of your HUD.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30027, $comment = 'Its counting down to when you should exit the highway.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30028, $comment = 'Wait until its done, then exit the highway.' ],
                        ],
              $callbackcue = ShowHint_ExitHighway,
              $abortcallbackcue = ShowHint_ExitHighway,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_LocalHighwayExitInMiddle_NearDestination" checkinterval="1ms">
              <conditions>
                <check_value value="player.ship.relativeposition.{$TargetSector}.z lt ($TargetPosition.z + $MaxTargetDistance)"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 38, $comment = 'Now.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_LocalHighwayExitInMiddle_Done">
              <conditions>
                <event_object_changed_zone group="$PlayerShipGroup"/>
                <check_value value="not player.ship.zone.islocalhighway"/>
              </conditions>
              <actions>
                <do_if value="player.ship.relativeposition.{$TargetSector}.z lt ($TargetPosition.z + $MaxTargetDistance)">
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20, $comment = 'Well done.' ],
                              ],
                    $callbackcue = Tutorial_LocalHighwayExitInMiddle_UseCase_Done,
                    $abortcallbackcue = Tutorial_LocalHighwayExitInMiddle_UseCase_Done,
                  ]" />
                  <cancel_cue cue="Tutorial_LocalHighwayExitInMiddle_NearDestination"/>
                </do_if>
                <do_else>
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 5, $comment = 'That was too early.' ],
                              ],
                  ]" />
                  <reset_cue cue="this"/>
                </do_else>
              </actions>
            </cue>

            <cue name="Tutorial_LocalHighwayExitInMiddle_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_LocalHighwayExitInMiddle"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Logbook">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16001, $comment = 'While we wait, let’s check out your logbook.' ],
                        ],
            ]" />
            <do_if value="$ShipMenuOpen?">
              <signal_cue cue="Tutorial_Logbook_ShipMenuOpened"/>
            </do_if>
            <do_else>
              <signal_cue cue="ShowHint_OpenShipMenu"/>
              <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1088}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_Logbook_ShipMenuOpened">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'DockedMenu'" control="''"/>
                </check_any>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16002, $comment = 'There are several menus you can access this way. Open the one that’s highlighted now.' ],
                            ],
                ]" />
                <signal_cue_instantly cue="SetHintID" param="26901" comment="{1012, 26901}"/>
                <show_help_overlay id="'toplevel_playerinfo'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_Logbook_PlayerInfoMenuOpened">
              <conditions>
                <event_ui_triggered screen="'PlayerInfoMenu'" control="''"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16003, $comment = 'Here you have access to details about your current status and statistics. The logbook is highlighted, open it now.' ],
                            ],
                ]" />
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'toplevel_playerinfo'"/>
                <show_help_overlay id="'playerinfo_sidebar_logbook'" highlightonly="true"/>
                <signal_cue_instantly cue="SetHintID" param="26902" comment="{1012, 26902}"/>
              </actions>
            </cue>

            <cue name="Tutorial_Logbook_Opened">
              <conditions>
                <event_ui_triggered screen="'PlayerInfoMenu'" control="'logbook'"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16004, $comment = 'As you can see, the logbook has several categories. You can select one to filter the entries, or look at all of them at once.' ],
                              1s,
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16005, $comment = 'Most of the tips you’ve seen up until now have been added to the logbook. You can always go back and reread them if you feel like you’ve missed or forgotten something.',
                                     $speakcallbackcue = Tutorial_Logbook_ShowCloseHint ],
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16006, $comment = 'Take your time looking around these menus. Close them when you’re ready to move on.' ],
                            ],
                ]" />
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'playerinfo_sidebar_logbook'"/>
              </actions>
              <cues>
                <cue name="Tutorial_Logbook_ShowCloseHint">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="2s"/>
                  <actions>
                    <signal_cue cue="ShowHint_CloseMenus"/>
                  </actions>
                </cue>

                <cue name="Tutorial_Logbook_Closed">
                  <conditions>
                    <event_ui_triggered screen="'PlayerInfoMenu'" control="'menu_close'"/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <signal_cue cue="Tutorial_Logbook_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_Logbook_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Logbook"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Targeting">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 7001, $comment = 'There’s a ship next to you. Its colour on your HUD indicates that it’s not hostile.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 7002, $comment = 'Please select it as your target.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="SetHintID" param="[27002, 27000, 27001]" comment="{1012, 27002} or {1012, 27000} or {1012, 27001}"/>
            <set_objective cue="GameStart_Tutorial" action="objective.follow" object="$MatchSpeedShip"/>
            <do_if value="player.target == $MatchSpeedShip">
              <signal_cue cue="Tutorial_Targeting_Done_ExtraDelay"/>
            </do_if>
          </actions>
          <cues>
            <cue name="Tutorial_Targeting_Done_ExtraDelay">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="3s"/>
              <actions>
                <signal_cue cue="Tutorial_Targeting_Done"/>
              </actions>
            </cue>

            <cue name="Tutorial_Targeting_Done">
              <conditions>
                <check_any>
                  <event_player_changed_target target="$MatchSpeedShip"/>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <delay exact="0.5s"/>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Targeting"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ShipSpeed_MatchTarget">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 7003, $comment = 'Match speed with your target.' ],
                        ],
            ]" />
            <create_position name="$MatchTarget_MoveToPosition" z="400km" object="$MatchSpeedShip" space="$MatchSpeedShip.sector"/>
            <create_order object="$MatchSpeedShip" id="'MoveGeneric'" name="$order" immediate="true">
              <param name="destination" value="$MatchSpeedShip.sector"/>
              <param name="position" value="$MatchTarget_MoveToPosition"/>
              <param name="precise" value="true"/>
              <param name="noboost" value="true"/>
            </create_order>
            <signal_cue_instantly cue="SetHintID" param="[27801, 27800]" comment="{1012, 27801} or {1012, 27800}"/>
          </actions>
          <cues>
            <cue name="Tutorial_ShipSpeed_MatchTarget_MatchingSpeed" checkinterval="0.1s">
              <conditions>
                <check_value value="player.input.flight.matchspeed"/>
              </conditions>
              <delay exact="5s"/>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 7004, $comment = 'By the way, matching speed is even possible when both you and your target are in travel mode.' ],
                            ],
                  $callbackcue = Tutorial_ShipSpeed_MatchTarget_UseCaseDone,
                  $abortcallbackcue = Tutorial_ShipSpeed_MatchTarget_UseCaseDone,
                ]" />
                <signal_cue_instantly cue="SetHintID" param="[27803, 27802]" comment="{1012, 27803} or {1012, 27802}"/>
              </actions>
              <cues>
                <cue name="Tutorial_ShipSpeed_MatchTarget_UseCaseDone">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="2s"/>
                  <actions>
                    <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                    <create_order object="$MatchSpeedShip" id="'MoveDie'" default="true"/>
                    <signal_cue cue="Tutorial_ShipSpeed_MatchTarget_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_ShipSpeed_MatchTarget_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <destroy_object object="$MatchSpeedShip"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ShipSpeed_MatchTarget"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Shooting_TargetHelper">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_value name="$TargetPracticeFlimsyMacro" exact="macro.ship_gen_xs_cargodrone_empty_01_a_macro"/>
            <set_value name="$TargetPracticeShieldedMacro" exact="macro.ship_arg_s_miner_solid_01_a_macro"/>
            <do_all exact="4" counter="$i">
              <create_ship groupname="$ShootTargets" macro="$TargetPracticeFlimsyMacro" sector="$PlayerShip.sector" capturable="false">
                <owner exact="faction.ownerless" overridenpc="true" />
                <pilot>
                  <select race="race.drone" tags="tag.aipilot"/>
                </pilot>
                <safepos object="player.ship" x="200m * $i * $i" z="$PlayerFireRange * 0.45 * $i"/>
              </create_ship>
              <set_relation_boost object="$ShootTargets.{$i}" value="-1" faction="faction.player" silent="true"/>
              <set_object_relation_behaviour object="$ShootTargets.{$i}" disable="true"/>
              <create_order object="$ShootTargets.{$i}" id="'Wait'" immediate="true">
                <param name="noattackresponse" value="true"/>
              </create_order>
            </do_all>
            <set_objective cue="GameStart_Tutorial" action="objective.observe" group="$ShootTargets" />
          </actions>
          <cues>
            <cue name="Tutorial_Shooting_TargetHelper_MakeTargetsMove">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_value name="$ShootTargetsMoving" exact="true"/>
                <do_all exact="$ShootTargets.count" counter="$i">
                  <start_script name="'move.random'" object="$ShootTargets.{$i}.pilot">
                    <param name="MaxDistance" value="5km"/>
                  </start_script>
                </do_all>
              </actions>
            </cue>

            <cue name="Tutorial_Shooting_TargetHelper_TargetDestroyed" instantiate="true">
              <conditions>
                <event_object_destroyed group="$ShootTargets"/>
              </conditions>
              <actions>
                <create_ship groupname="$ShootTargets" macro="$TargetPracticeFlimsyMacro" sector="$PlayerShip.sector" capturable="false">
                  <owner exact="faction.ownerless" overridenpc="true" />
                  <pilot>
                    <select race="race.drone" tags="tag.aipilot"/>
                  </pilot>
                  <safepos object="player.ship" x="[-500m, 500m].random" z="$PlayerFireRange * 0.75"/>
                </create_ship>
                <set_relation_boost object="$ShootTargets.{$ShootTargets.count}" value="-1" faction="faction.player" silent="true"/>
                <set_object_relation_behaviour object="$ShootTargets.{$ShootTargets.count}" disable="true"/>
                <do_if value="$ShootTargetsMoving?">
                  <start_script name="'move.random'" object="$ShootTargets.{$ShootTargets.count}.pilot">
                    <param name="MaxDistance" value="5km"/>
                  </start_script>
                </do_if>
                <do_else>
                  <create_order object="$ShootTargets.{$ShootTargets.count}" id="'Wait'" immediate="true">
                    <param name="noattackresponse" value="true"/>
                  </create_order>
                </do_else>
                <set_objective cue="GameStart_Tutorial" action="objective.destroy" group="$ShootTargets" />
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ShootingPrimary">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <lock_all_shooting_input/>
            <lock_flight_strafe_input/>
            <lock_flight_throttle_input/>
            <set_value name="$PlayerFireRange" exact="$PlayerShip.maxcombatrange.primary"/>
            <add_to_group groupname="$PlayerWeaponsGroup" list="$PlayerShip.weapons.operational.list"/>
            <do_all exact="$PlayerWeaponsGroup.count" counter="$i">
              <remove_weapon_from_all_weapongroups weapon="$PlayerWeaponsGroup.{$i}"/>
            </do_all>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8036, $comment = 'Time to learn how to defend yourself.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8003, $comment = 'There are a handful of targets in front of you. Their HUD colour indicates that they are enemies.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8037, $comment = 'Some are darker than the others.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8038, $comment = 'Those are behind something and cant be hit with your weapons right now.',
                                 $speakcallbackcue = Tutorial_ShootingPrimary_ActivateWeapons ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8001, $comment = 'I’ve now activated your primary weapon.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8002, $comment = 'The small dots that have just appeared indicate where the weapons are currently aiming. They will automatically track your current target, as long as it’s close enough.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8004, $comment = 'Note that the HUD markers of some targets are smaller. These targets are currently outside your weapon range.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8005, $comment = 'Select the closest enemy target.' ],
                        ],
              $callbackcue = Tutorial_ShootingPrimary_SelectClosestTarget,
              $abortcallbackcue = Tutorial_ShootingPrimary_SelectClosestTarget,
            ]" />
            <signal_cue cue="Tutorial_Shooting_TargetHelper"/>
          </actions>
          <cues>
            <cue name="Tutorial_ShootingPrimary_ActivateWeapons">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <do_all exact="$PlayerWeaponsGroup.count" counter="$i">
                  <remove_weapon_from_all_weapongroups weapon="$PlayerWeaponsGroup.{$i}"/>
                  <do_if value="$PlayerWeaponsGroup.{$i}.macro == macro.weapon_gen_s_plasma_01_mk1_macro">
                    <add_weapon_to_weapongroup weapon="$PlayerWeaponsGroup.{$i}" weapongroup="0" primary="true"/>
                  </do_if>
                </do_all>
              </actions>
            </cue>

            <cue name="Tutorial_ShootingPrimary_SelectClosestTarget">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="SetHintID" param="[27003, 27005]" comment="{1012, 27003} or {1012, 27005}"/>
                <do_if value="player.target == $ShootTargets.{1}">
                  <signal_cue cue="Tutorial_ShootingPrimary_ClosestTargetSelected" check="false"/>
                </do_if>
              </actions>
              <cues>
                <cue name="Tutorial_ShootingPrimary_TargetChanged" instantiate="true">
                  <conditions>
                    <event_player_changed_target/>
                  </conditions>
                  <actions>
                    <sort_group group="$ShootTargets" sortbydistanceto="$PlayerShip"/>
                    <do_if value="event.param == $ShootTargets.{1}">
                      <signal_cue cue="Tutorial_ShootingPrimary_ClosestTargetSelected" check="false"/>
                    </do_if>
                  </actions>
                </cue>

                <cue name="Tutorial_ShootingPrimary_ClosestTargetSelected">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8006, $comment = 'A new HUD element has appeared, right in the centre of the target. This is the aim-ahead indicator; it shows you where you need to aim, which is especially useful if the target is moving.',
                                         $speakcallbackcue = Tutorial_ShootingPrimary_CycleTargets ],
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8007, $comment = 'Slowly cycle through all the targets.' ],
                                ],
                      $callbackcue = Tutorial_ShootingPrimary_CycleTargets,
                      $abortcallbackcue = Tutorial_ShootingPrimary_CycleTargets,
                    ]" />
                    <signal_cue_instantly cue="ClearHintID"/>
                  </actions>
                  <cues>
                    <cue name="Tutorial_ShootingPrimary_CycleTargets">
                      <conditions>
                        <event_cue_signalled/>
                      </conditions>
                      <actions>
                        <signal_cue_instantly cue="SetHintID" param="[27004, 27006]" comment="{1012, 27004} or {1012, 27006}"/>
                      </actions>
                      <cues>
                        <cue name="Tutorial_ShootingPrimary_SelectedTargetOutOfRange">
                          <conditions>
                            <event_player_changed_target/>
                            <check_value value="player.target and player.target.hasrelation.enemy.{$PlayerShip} and player.target.distanceto.{$PlayerShip} gt $PlayerFireRange"/>
                          </conditions>
                          <delay exact="1ms"/>
                          <actions>
                            <signal_cue_instantly cue="ClearHintID"/>
                            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                                $script = [
                                            table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8008, $comment = 'When a target outside your weapon range has been selected, you can see the weapon indicators becoming darkened. The aim-ahead indicator also changes its appearance.' ],
                                          ],
                                $callbackcue = Tutorial_ShootingPrimary_OutOfRangeUseCaseDone,
                                $abortcallbackcue = Tutorial_ShootingPrimary_OutOfRangeUseCaseDone,
                              ]" />
                          </actions>
                          <cues>
                            <cue name="Tutorial_ShootingPrimary_OutOfRangeUseCaseDone">
                              <conditions>
                                <event_cue_signalled/>
                              </conditions>
                              <actions>
                                <cancel_cue cue="Tutorial_ShootingPrimary_SelectClosestTarget"/>
                                <signal_cue cue="Tutorial_ShootingPrimary_TargetPractice"/>
                              </actions>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_ShootingPrimary_TargetPractice">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <unlock_primary_shooting_input/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8009, $comment = 'Select the closest enemy target again and shoot at it until it’s destroyed.' ],
                            ],
                ]" />
                <signal_cue_instantly cue="SetHintID" param="27100" comment="{1012, 27100}"/>
                <set_objective cue="GameStart_Tutorial" action="objective.destroy" group="$ShootTargets" />
              </actions>
              <cues>
                <cue name="Tutorial_ShootingPrimary_WeaponFired">
                  <conditions>
                    <event_weapon_fired group="$PlayerWeaponsGroup"/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <do_if value="not player.input.controller and not player.input.joystick and not player.input.shootatcursor">
                      <signal_cue_instantly cue="SetHintID" param="27101" comment="{1012, 27101}"/>
                    </do_if>
                  </actions>
                  <cues>
                    <cue name="Tutorial_ShootingPrimary_WeaponFiredAtCursor">
                      <conditions>
                        <event_weapon_fired group="$PlayerWeaponsGroup"/>
                        <check_value value="player.input.shootatcursor"/>
                      </conditions>
                      <actions>
                        <signal_cue_instantly cue="ClearHintID"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="Tutorial_ShootingPrimary_TargetPractice_FirstTargetDestroyed">
                  <conditions>
                    <event_object_destroyed group="$ShootTargets"/>
                  </conditions>
                  <actions>
                    <unlock_flight_strafe_input/>
                    <unlock_flight_throttle_input/>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8010, $comment = 'Keep destroying targets. You’ll need to move closer in order to hit some of them.' ],
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8011, $comment = 'If you look to the right of your cross-hair, you will see bars next to your weapons that gradually fill up when you are firing. This is heat. It automatically dissipates when you stop firing.' ],
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8032, $comment = 'This happens more slowly if there are multiple weapons cooling down at the same time.' ],
                                ],
                    ]" />
                    <set_value name="$DestroyedTargets" exact="1"/>
                    <signal_cue cue="Tutorial_Shooting_TargetHelper_MakeTargetsMove"/>
                  </actions>
                </cue>

                <cue name="Tutorial_ShootingPrimary_TargetPractice_Overheated">
                  <conditions>
                    <event_weapon_overheated group="$PlayerWeaponsGroup"/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8012, $comment = 'Your weapons just overheated. You will not be able to fire until they’ve cooled to a safe temperature.' ],
                                ],
                    ]" />
                  </actions>
                </cue>

                <cue name="Tutorial_ShootingPrimary_TargetPractice_TargetDestroyed" instantiate="true">
                  <conditions>
                    <event_object_destroyed group="$ShootTargets"/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <set_value name="$DestroyedTargets" operation="add"/>
                    <do_if value="$DestroyedTargets gt 4">
                      <reset_cue cue="Tutorial_Shooting_TargetHelper"/>
                      <destroy_group group="$ShootTargets"/>
                      <signal_cue cue="Tutorial_ShootingPrimary_TargetPractice_Shielded" check="false"/>
                      <cancel_cue cue="this"/>
                    </do_if>
                    <do_else>
                      <set_objective cue="GameStart_Tutorial" action="objective.destroy" group="$ShootTargets" />
                    </do_else>
                  </actions>
                </cue>

                <cue name="Tutorial_ShootingPrimary_TargetPractice_Shielded">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8013, $comment = 'This target is much sturdier than the others. Look at the blue bar above the target. This is its shield strength. After a few seconds without damage it will begin to recharge. All shields work like this, including your own.' ],
                                ],
                    ]" />
                    <create_ship name="$ShieldedTarget" macro="$TargetPracticeShieldedMacro" sector="$PlayerShip.sector" capturable="false">
                      <owner exact="faction.ownerless" overridenpc="true" />
                      <pilot>
                        <select race="race.drone" tags="tag.aipilot"/>
                      </pilot>
                      <loadout ref="flightschool_shielded_training_target"/>
                      <safepos object="player.ship" z="1km"/>
                    </create_ship>
                    <set_relation_boost object="$ShieldedTarget" value="-1" faction="faction.player" silent="true"/>
                    <set_object_relation_behaviour object="$ShieldedTarget" disable="true"/>
                    <create_order object="$ShieldedTarget" id="'Wait'" immediate="true">
                      <param name="noattackresponse" value="true"/>
                    </create_order>
                    <set_objective cue="GameStart_Tutorial" action="objective.destroy" object="$ShieldedTarget" />
                  </actions>
                  <cues>
                    <cue name="Tutorial_ShootingPrimary_TargetPractice_Shielded_Destroyed">
                      <conditions>
                        <event_object_destroyed object="$ShieldedTarget"/>
                      </conditions>
                      <actions>
                        <signal_cue cue="Tutorial_ShootingPrimary_Done"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_ShootingPrimary_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <lock_primary_shooting_input/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ShootingPrimary"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ShootingSecondary">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <unlock_secondary_shooting_input/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8014, $comment = 'I’ve now activated your secondary weapon, a missile launcher. It’s loaded with a type of guided missile that requires a target lock. Please select the target in front of you.' ],
                        ],
            ]" />
            <do_all exact="$PlayerWeaponsGroup.count" counter="$i">
              <do_if value="$PlayerWeaponsGroup.{$i}.isclass.missilelauncher">
                <add_weapon_to_weapongroup weapon="$PlayerWeaponsGroup.{$i}" weapongroup="0" primary="false"/>
              </do_if>
            </do_all>
            <add_ammo object="$PlayerShip" macro="macro.missile_guided_light_mk1_macro" amount="10" comment="Just add as many as can fit"/>
            <create_ship groupname="$ShootTargets" macro="$TargetPracticeFlimsyMacro" sector="$PlayerShip.sector" capturable="false">
              <owner exact="faction.ownerless" overridenpc="true" />
              <pilot>
                <select race="race.drone" tags="tag.aipilot"/>
              </pilot>
              <safepos object="player.ship" x="[-500m, 500m].random" z="$PlayerFireRange * 0.75"/>
            </create_ship>
            <set_relation_boost object="$ShootTargets.{$ShootTargets.count}" value="-1" faction="faction.player" silent="true"/>
            <set_object_relation_behaviour object="$ShootTargets.{$ShootTargets.count}" disable="true"/>
            <start_script name="'move.random'" object="$ShootTargets.{$ShootTargets.count}.pilot">
              <param name="MaxDistance" value="5km"/>
            </start_script>
            <set_objective cue="GameStart_Tutorial" action="objective.destroy" group="$ShootTargets"/>
          </actions>
          <cues>
            <cue name="Tutorial_ShootingSecondary_TargetLocked">
              <conditions>
                <event_lock_initiated attacker="$PlayerShip"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8015, $comment = 'You can now see a lock being acquired. You may fire when ready.' ],
                            ],
                ]" />
                <signal_cue_instantly cue="SetHintID" param="27102" comment="{1012, 27102}"/>
                <signal_cue cue="ShowHint_FireSecondaryWeapon"/>
              </actions>
            </cue>

            <cue name="Tutorial_ShootingSecondary_MissileFired">
              <conditions>
                <event_player_launched_missile/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
              </actions>
            </cue>

            <cue name="Tutorial_ShootingSecondary_TargetDestroyed">
              <conditions>
                <event_object_destroyed group="$ShootTargets" method="killmethod.hitbymissile"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8016, $comment = 'The target has dropped something! Fly right at it to pick it up.' ],
                            ],
                ]" />
                <spawn_drop object="event.object" drop="'drops_flightschool_guided_missile'"/>
                <find_object name="$Drop" class="class.collectable" space="event.object.zone"/>
                <set_object_min_hull object="$Drop" exact="1"/>
                <set_objective cue="GameStart_Tutorial" action="objective.collect" object="$Drop"/>
                <signal_cue cue="ShowHint_CollectItemInSpace"/>
              </actions>
            </cue>

            <cue name="Tutorial_ShootingSecondary_AmmoCollected">
              <conditions>
                <event_player_collected_ammo/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8017, $comment = 'It’s another type of missile. It has been automatically added to your ammunition storage.' ],
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8018, $comment = 'Missile launchers have limited ammunition. You can see the number of remaining missiles to the left of your cross-hair.' ],
                            ],
                  $callbackcue = Tutorial_ShootingSecondary_AmmoStorageUseCaseFinished,
                  $abortcallbackcue = Tutorial_ShootingSecondary_AmmoStorageUseCaseFinished,
                ]" />
                <signal_cue_instantly cue="ClearHintID"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
              </actions>
              <cues>
                <cue name="Tutorial_ShootingSecondary_AmmoStorageUseCaseFinished">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue cue="Tutorial_ShootingSecondary_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_ShootingSecondary_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <lock_secondary_shooting_input/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ShootingSecondary"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Combat_OwnShields">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <find_ship groupname="$allships" space="player.sector" multiple="true" checkoperational="false" owner="faction.ownerless"/>
            <destroy_group group="$allships"/>
            <force_player_speed speed="0"/>
            <lock_flight_strafe_input/>
            <lock_flight_throttle_input/>
            <set_object_min_hull object="player.ship" exact="100"/>
            <set_object_min_shield object="player.ship" exact="25"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8039, $comment = 'Look at the curved blue bar below your crosshairs.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8040, $comment = 'Im going to demonstrate damage to your shields.' ],
                        ],
              $callbackcue = Tutorial_Combat_OwnShields_ExplodeMine,
              $abortcallbackcue = Tutorial_Combat_OwnShields_ExplodeMine,
            ]" />
          </actions>
          <delay exact="2s"/>
          <actions>
            <create_object name="$Mine" macro="macro.weapon_gen_mine_01_macro" sector="player.sector">
              <position object="player.ship" x="0" y="200" z="200"/>
            </create_object>
            <set_value name="$movedirection" exact="player.ship.rotation.up"/>
            <set_object_velocity object="$Mine">
              <linear x="-100 * $movedirection.x" y="-100 * $movedirection.y" z="-100 * $movedirection.z"/>
            </set_object_velocity>
          </actions>
          <cues>
            <cue name="Tutorial_Combat_OwnShields_ExplodeMine">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <cues>
                <cue name="Tutorial_Combat_OwnShields_ExplodeMine_StoppedMoving" checkinterval="1ms">
                  <conditions>
                    <check_value value="$Mine.speed le 1"/>
                  </conditions>
                  <actions>
                    <destroy_object object="$Mine" explosion="true"/>
                  </actions>
                  <cues>
                    <cue name="Tutorial_Combat_OwnShields_PlayerShieldsDamage_Fallback">
                      <delay exact="2s"/>
                      <actions>
                        <set_object_shield object="$PlayerShip" exact="0"/>
                        <signal_cue cue="Tutorial_Combat_OwnShields_PlayerShieldsDamaged"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_Combat_OwnShields_PlayerShieldsDamaged">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_object_shield_damaged group="global.$PlayerShipsGroup"/>
                </check_any>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_Combat_OwnShields_PlayerShieldsDamage_Fallback"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =   32, $comment = 'Wait for it...' ],
                            ],
                ]" />
                <set_value name="$DamagedShieldPercentage" exact="player.ship.shieldpercentage"/>
              </actions>
              <cues>
                <cue name="Tutorial_Combat_OwnShields_Done" checkinterval="1ms">
                  <conditions>
                    <check_value value="player.ship.shieldpercentage gt $DamagedShieldPercentage"/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8041, $comment = 'There we go, its recharging.' ],
                                ],
                      $callbackcue = Tutorial_Combat_OwnShields_UseCase_Done,
                      $abortcallbackcue = Tutorial_Combat_OwnShields_UseCase_Done,
                    ]" />
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_Combat_OwnShields_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Combat_OwnShields"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ManageWeapons_OpenShipMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <lock_all_flight_input/>
            <lock_getup/>
            <lock_all_shooting_input/>
            <find_object_component name="$IonWeapon" object="$PlayerShip" macro="macro.weapon_arg_m_ion_01_mk1_macro"/>
            <find_object_component name="$PlasmaWeapon" object="$PlayerShip" macro="macro.weapon_gen_m_plasma_01_mk1_macro"/>
            <find_object_component name="$BeamWeapon" object="$PlayerShip" macro="macro.weapon_gen_m_beam_01_mk1_macro"/>
            <find_object_component name="$MissileLauncher" object="$PlayerShip" macro="macro.weapon_gen_m_guided_01_mk1_macro"/>
            <find_object_component name="$PlasmaTurret" object="$PlayerShip" macro="macro.turret_par_m_plasma_01_mk1_macro"/>
            <find_object_component name="$BeamTurret" object="$PlayerShip" macro="macro.turret_par_m_beam_01_mk1_macro"/>
            <set_turrets_armed object="$PlayerShip" armed="false"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8019, $comment = 'Lets go into more detail about your weapons.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8020, $comment = 'Open the ship menu.' ],
                        ],
            ]" />
            <do_if value="$ShipMenuOpen?">
              <signal_cue cue="Tutorial_ManageWeapons_OpenShipMenu_Done"/>
            </do_if>
            <do_else>
              <signal_cue cue="ShowHint_OpenShipMenu"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_ManageWeapons_OpenShipMenu_Done">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'DockedMenu'"/>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ManageWeapons_OpenShipMenu"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ManageWeapons_AssignGroups">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8021, $comment = 'Well focus on the highlighted weapon configuration section.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8022, $comment = 'Each installed weapon has its own row.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8023, $comment = 'The squares in each row show you which weapon groups that weapon is a part of.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8024, $comment = 'You can assign any weapon to any weapon group.',
                                  $speakcallbackcue = Tutorial_ManageWeapons_AssignGroups_ShowHint],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8042, $comment = 'Use the highlighted buttons to assign each weapon to its own group.' ],
                        ],
            ]" />
            <show_help_overlay id="'docked_weaponconfig'" highlightonly="true"/>
          </actions>
          <cues>
            <cue name="Tutorial_ManageWeapons_AssignGroups_ShowHint">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="SetHintID" param="27206" comment="{1012,27206}"/>
                <remove_help_overlay id="'docked_weaponconfig'"/>
                <show_help_overlay id="'docked_weaponconfig_primary_1_2'" highlightonly="true"/>
                <show_help_overlay id="'docked_weaponconfig_primary_2_3'" highlightonly="true"/>
                <show_help_overlay id="'docked_weaponconfig_primary_3_4'" highlightonly="true"/>
                <show_help_overlay id="'docked_weaponconfig_secondary_1_1'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_ManageWeapons_AssignGroups_Check">
              <delay exact="1ms"/>
              <actions>
                <remove_value name="$invalid"/>
                <add_to_group groupname="$primaryweapons" object="$IonWeapon" replace="true"/>
                <add_to_group groupname="$primaryweapons" object="$PlasmaWeapon"/>
                <add_to_group groupname="$primaryweapons" object="$BeamWeapon"/>
                <do_all exact="4" counter="$i">
                  <do_if value="$PlayerShip.primaryweapons.{$i - 1}.count gt 1">
                    <set_value name="$invalid" exact="true"/>
                    <break/>
                  </do_if>
                  <do_elseif value="$PlayerShip.primaryweapons.{$i - 1}.count == 1">
                    <do_if value="$primaryweapons.indexof.{$PlayerShip.primaryweapons.{$i - 1}.list.{1}}">
                      <remove_from_group group="$primaryweapons" object="$PlayerShip.primaryweapons.{$i - 1}.list.{1}"/>
                    </do_if>
                    <do_else>
                      <set_value name="$invalid" exact="true"/>
                      <break/>
                    </do_else>
                  </do_elseif>
                </do_all>
                <do_if value="$primaryweapons.count or $invalid?">
                  <reset_cue cue="this"/>
                </do_if>
                <do_else>
                  <signal_cue cue="Tutorial_ManageWeapons_AssignGroups_Done"/>
                </do_else>
              </actions>
            </cue>

            <cue name="Tutorial_ManageWeapons_AssignGroups_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_ManageWeapons_AssignGroups_ShowHint"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'docked_weaponconfig'"/>
                <do_all exact="4" counter="$weapongroup">
                  <do_all exact="player.ship.weapons.numslots" counter="$weaponindex">
                    <remove_help_overlay id="'docked_weaponconfig_primary_%1_%2'.[$weapongroup, $weaponindex]"/>
                    <remove_help_overlay id="'docked_weaponconfig_secondary_%1_%2'.[$weapongroup, $weaponindex]"/>
                  </do_all>
                </do_all>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ManageWeapons_AssignGroups"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ManageWeapons_SelectMissile">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8025, $comment = 'You can also change the ammunition thats loaded into your missile launchers.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8026, $comment = 'Try it if you like. Close the menu to move on.' ],
                        ],
              $callbackcue = ShowHint_CloseMenus_Checked,
              $abortcallbackcue = ShowHint_CloseMenus_Checked,
            ]" />
            <show_help_overlay id="'docked_ammo_config'" highlightonly="true"/>
          </actions>
          <cues>
            <cue name="Tutorial_ManageWeapons_SelectMissile_Done">
              <conditions>
                <event_ui_triggered screen="'DockedMenu'" control="'menu_close'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'docked_ammo_config'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ManageWeapons_SelectMissile"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ManageWeapons_CyclePrimaryWeaponGroups">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8027, $comment = 'You can quickly cycle through your configured weapon groups.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8028, $comment = 'Please activate each primary group at least once.' ],
                        ],
            ]" />
            <signal_cue cue="ShowHint_CyclePrimaryWeapon"/>
            <set_value name="$GroupsToActivate" exact="[0, 1, 2, 3]"/>
            <remove_from_list name="$GroupsToActivate" exact="$PlayerShip.activeweapongroup.primary"/>
          </actions>
          <cues>
            <cue name="Tutorial_ManageWeapons_CyclePrimaryWeaponGroups_GroupActivated" instantiate="true">
              <conditions>
                <event_player_activated_weapongroup primary="true"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <remove_from_list name="$GroupsToActivate" exact="event.param"/>
                <do_if value="not $GroupsToActivate.count">
                  <signal_cue_instantly cue="ClearHintID"/>
                  <signal_cue cue="Tutorial_ManageWeapons_CyclePrimaryWeaponGroups_Done"/>
                </do_if>
              </actions>
            </cue>

            <cue name="Tutorial_ManageWeapons_CyclePrimaryWeaponGroups_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ManageWeapons_CyclePrimaryWeaponGroups"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ManageWeapons_CycleMissile">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="not player.input.ismapped.INPUT_ACTION_CYCLE_NEXT_ACTIVE_WEAPON_AMMO or (player.input.controller and not player.input.ismapped.controller.INPUT_ACTION_CYCLE_NEXT_ACTIVE_WEAPON_AMMO)">
              <signal_cue cue="Tutorial_ManageWeapons_CycleMissile_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8029, $comment = 'You can also cycle through the available ammunition for any active missile launcher here. Try this now.' ],
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8043, $comment = 'Select the swarm missile.' ],
                          ],
              ]" />
              <signal_cue_instantly cue="SetHintID" param="27203" comment="{1012, 27203}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_ManageWeapons_CycleMissile_MissileCycled">
              <conditions>
                <event_player_cycled_active_weapon_ammo/>
                <check_value value="$MissileLauncher.ammo.macro == macro.missile_swarm_light_mk1_macro"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8030, $comment = 'It takes a little time for the new missile type to be loaded into the launcher.' ],
                            ],
                  $callbackcue = Tutorial_ManageWeapons_CycleMissile_UseCaseDone,
                  $abortcallbackcue = Tutorial_ManageWeapons_CycleMissile_UseCaseDone,
                ]" />
              </actions>
              <cues>
                <cue name="Tutorial_ManageWeapons_CycleMissile_UseCaseDone">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue cue="Tutorial_ManageWeapons_CycleMissile_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_ManageWeapons_CycleMissile_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ManageWeapons_CycleMissile"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ManageWeapons_CycleWeaponsHelper">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue cue="Tutorial_ManageWeapons_CycleWeaponsHelper_WeaponCycled"/>
          </actions>
          <cues>
            <cue name="Tutorial_ManageWeapons_CycleWeaponsHelper_WeaponCycled" instantiate="true">
              <conditions>
                <check_any>
                  <event_player_activated_weapon/>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <debug_text text="$IonWeapon.name + ' active? ' + $IonWeapon.isactive"/>
                <debug_text text="$PlasmaWeapon.name + ' active? ' + $PlasmaWeapon.isactive"/>
                <debug_text text="$BeamWeapon.name + ' active? ' + $BeamWeapon.isactive"/>
                <debug_text text="$MissileLauncher.name + ' active? ' + $MissileLauncher.isactive"/>
                <do_if value="$RequiredWeapon.isactive">
                  <unlock_primary_shooting_input/>
                  <signal_cue cue="ShowHint_FirePrimaryWeapon"/>
                </do_if>
                <do_else>
                  <lock_primary_shooting_input/>
                  <signal_cue cue="ShowHint_CyclePrimaryWeapon"/>
                </do_else>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ManageWeapons_KeepTargetShieldsDownHelper" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="$ShieldedTarget? and $ShieldedTarget.isoperational">
              <set_object_shield object="$ShieldedTarget" exact="0"/>
              <signal_cue cue="this" check="false"/>
            </do_if>
          </actions>
        </cue>

        <cue name="Tutorial_ManageWeapons_UseIonWeapon">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8044, $comment = 'The target in front of you has strong shields.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8045, $comment = 'Your ion weapon is especially effective against shields.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8046, $comment = 'Switch to it and fire until the targets shields are down.' ],
                        ],
            ]" />
            <set_value name="$RequiredWeapon" exact="$IonWeapon"/>
            <signal_cue cue="Tutorial_ManageWeapons_CycleWeaponsHelper"/>
            <create_ship name="$ShieldedTarget" macro="macro.ship_arg_s_miner_solid_01_a_macro" sector="$PlayerShip.sector" capturable="false">
              <owner exact="faction.ownerless" overridenpc="true" />
              <pilot>
                <select race="race.drone" tags="tag.aipilot"/>
              </pilot>
              <loadout ref="flightschool_shielded_training_target"/>
              <safepos object="player.ship" z="1km"/>
            </create_ship>
            <set_relation_boost object="$ShieldedTarget" value="-1" faction="faction.player" silent="true"/>
            <set_object_relation_behaviour object="$ShieldedTarget" disable="true"/>
            <create_order object="$ShieldedTarget" id="'Wait'" immediate="true">
              <param name="noattackresponse" value="true"/>
            </create_order>
            <set_objective cue="GameStart_Tutorial" action="objective.destroy" object="$ShieldedTarget" />
            <set_object_min_hull object="$ShieldedTarget" exact="100"/>
          </actions>
          <cues>
            <cue name="Tutorial_ManageWeapons_UseIonWeapon_Done">
              <conditions>
                <event_object_shield_damaged object="$ShieldedTarget"/>
                <check_value value="$ShieldedTarget.shieldpercentage lt 1"/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_ManageWeapons_KeepTargetShieldsDownHelper"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ManageWeapons_UseIonWeapon"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ManageWeapons_UsePlasmaWeapon">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8047, $comment = 'Now switch to your plasma weapon and finish it off.' ],
                        ],
            ]" />
            <set_value name="$RequiredWeapon" exact="$PlasmaWeapon"/>
            <signal_cue cue="Tutorial_ManageWeapons_CycleWeaponsHelper_WeaponCycled"/>
            <set_object_min_hull object="$ShieldedTarget" exact="0"/>
          </actions>
          <cues>
            <cue name="Tutorial_ManageWeapons_UsePlasmaWeapon_Done">
              <conditions>
                <event_object_destroyed object="$ShieldedTarget"/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ManageWeapons_UsePlasmaWeapon"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ManageWeapons_UseBeamWeapon">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8048, $comment = 'This target here is small and agile, quite tricky to hit with a plasma weapon.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8049, $comment = 'Switch to your beam and shoot it down.' ],
                        ],
            ]" />
            <set_value name="$RequiredWeapon" exact="$BeamWeapon"/>
            <signal_cue cue="Tutorial_ManageWeapons_CycleWeaponsHelper_WeaponCycled"/>
            <create_ship name="$AgileTarget" macro="macro.ship_gen_s_fightingdrone_01_a_macro" sector="$PlayerShip.sector" capturable="false">
              <owner exact="faction.ownerless" overridenpc="true" />
              <pilot>
                <select race="race.drone" tags="tag.aipilot"/>
              </pilot>
              <safepos object="player.ship" z="1km"/>
            </create_ship>
            <set_relation_boost object="$AgileTarget" value="-1" faction="faction.player" silent="true"/>
            <set_object_relation_behaviour object="$AgileTarget" disable="true"/>
            <create_order object="$AgileTarget" id="'Wait'" default="true"/>
            <create_order object="$AgileTarget" id="'Attack'" immediate="true">
              <param name="primarytarget" value="$PlayerShip"/>
              <param name="forceprimarytarget" value="true"/>
              <param name="pursuetargets" value="true"/>
              <param name="allowothertargets" value="false"/>
              <param name="allowboost" value="true"/>
            </create_order>
            <set_object_hull object="$AgileTarget" exact="20"/>
            <set_objective cue="GameStart_Tutorial" action="objective.destroy" object="$AgileTarget" />
            <unlock_flight_steering_input/>
          </actions>
          <cues>
            <cue name="Tutorial_ManageWeapons_UseBeamWeapon_Done">
              <conditions>
                <event_object_destroyed object="$AgileTarget"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8050, $comment = 'Well done.' ],
                            ],
                  $callbackcue = Tutorial_ManageWeapons_UseBeamWeapon_UseCase_Done,
                  $abortcallbackcue = Tutorial_ManageWeapons_UseBeamWeapon_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_ManageWeapons_UseBeamWeapon_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <lock_primary_shooting_input/>
                <cancel_cue cue="Tutorial_ManageWeapons_CycleWeaponsHelper"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ManageWeapons_UseBeamWeapon"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ManageWeapons_Turrets_OpenShipMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8051, $comment = 'You probably noticed that this ship also has turrets.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8052, $comment = 'Open the ship menu again.' ],
                        ],
            ]" />
            <do_if value="$ShipMenuOpen?">
              <signal_cue cue="Tutorial_ManageWeapons_Turrets_OpenShipMenu_Done"/>
            </do_if>
            <do_else>
              <signal_cue cue="ShowHint_OpenShipMenu"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_ManageWeapons_Turrets_OpenShipMenu_Done">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'DockedMenu'"/>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ManageWeapons_Turrets_OpenShipMenu"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ManageWeapons_Turrets_Arm">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8053, $comment = 'You have a plasma and a beam turret.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8054, $comment = 'You can arm and disarm them using the buttons on the right.' ],
                        ],
            ]" />
            <do_if value="$PlasmaTurret.ammo.macro and $BeamTurret.ammo.macro">
              <signal_cue cue="Tutorial_ManageWeapons_Turrets_Arm_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8055, $comment = 'Arm both turrets now.' ],
                          ],
              ]" />
              <show_help_overlay id="'docked_turretconfig_arm'" highlightonly="true"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_ManageWeapons_Turrets_Arm_Done">
              <conditions>
                <check_any>
                  <event_object_weapon_ammo_changed group="$PlayerShipGroup"/>
                  <event_cue_signalled/>
                </check_any>
                <check_value value="$PlasmaTurret.ammo.macro and $BeamTurret.ammo.macro"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'docked_turretconfig_arm'"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ManageWeapons_Turrets_Arm"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ManageWeapons_ExplainTurretModes">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <show_help_overlay id="'docked_turretconfig_modes_dropdown'" highlightonly="true"/>
            <show_help_overlay id="'docked_turrets_modes_dropdown1'" highlightonly="true"/>
            <show_help_overlay id="'docked_turrets_modes_dropdown2'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8056, $comment = 'Theyre set to Defend, which means they will fire at whoever attacks you.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8057, $comment = 'Lets go through the other modes.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_ManageWeapons_ExplainTurretModes_IndividualModes">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'DockedMenu'" control="'docked_turretconfig_modes'"/>
                  <event_ui_triggered screen="'DockedMenu'" control="'docked_turrets_modes1'"/>
                  <event_ui_triggered screen="'DockedMenu'" control="'docked_turrets_modes2'"/>
                </check_any>
                <check_value value="event.param3 == 'activated'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'docked_turretconfig_modes_dropdown'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown1'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown2'"/>
                <show_help_overlay id="'docked_turretconfig_modes_dropdown_attackenemies'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_attackenemies1'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_attackenemies2'" highlightonly="true"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8058, $comment = 'Attack all Enemies means that the turret will choose a suitable target in range on its own.',
                                      $speakcallbackcue = Tutorial_ManageWeapons_ExplainTurretModes_Attack ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8059, $comment = 'Attack only capital ships, Attack only fighters and Shoot only missiles work similarly, but only allow a subset of targets.',
                                      $speakcallbackcue = Tutorial_ManageWeapons_ExplainTurretModes_Prefer ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8060, $comment = 'Attack capital ships first, Attack fighters first and Shoot missiles first prioritise a subset of targets, but other targets are allowed.',
                                      $speakcallbackcue = Tutorial_ManageWeapons_ExplainTurretModes_AutoAssist ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8064, $comment = 'Attack my current enemy makes the turret fire at whatever you have selected, as long as its hostile.',
                                      $speakcallbackcue = Tutorial_ManageWeapons_ExplainTurretModes_Mining ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8065, $comment = 'Mining may be obvious... It makes the turret fire at asteroids within range.' ],
                            ],
                  $callbackcue = Tutorial_ManageWeapons_ExplainTurretModes_UseCase_Done,
                  $abortcallbackcue = Tutorial_ManageWeapons_ExplainTurretModes_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_ManageWeapons_ExplainTurretModes_Attack">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'docked_turretconfig_modes_dropdown_attackenemies'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_attackenemies1'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_attackenemies2'"/>
                <show_help_overlay id="'docked_turretconfig_modes_dropdown_attackcapital'" highlightonly="true"/>
                <show_help_overlay id="'docked_turretconfig_modes_dropdown_attackfighters'" highlightonly="true"/>
                <show_help_overlay id="'docked_turretconfig_modes_dropdown_missiledefence'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_attackcapital1'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_attackfighters1'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_missiledefence1'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_attackcapital2'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_attackfighters2'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_missiledefence2'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_ManageWeapons_ExplainTurretModes_Prefer">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'docked_turretconfig_modes_dropdown_attackcapital'"/>
                <remove_help_overlay id="'docked_turretconfig_modes_dropdown_attackfighters'"/>
                <remove_help_overlay id="'docked_turretconfig_modes_dropdown_missiledefence'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_attackcapital1'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_attackfighters1'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_missiledefence1'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_attackcapital2'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_attackfighters2'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_missiledefence2'"/>
                <show_help_overlay id="'docked_turretconfig_modes_dropdown_prefercapital'" highlightonly="true"/>
                <show_help_overlay id="'docked_turretconfig_modes_dropdown_preferfighters'" highlightonly="true"/>
                <show_help_overlay id="'docked_turretconfig_modes_dropdown_prefermissiles'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_prefercapital1'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_preferfighters1'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_prefermissiles1'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_prefercapital2'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_preferfighters2'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_prefermissiles2'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_ManageWeapons_ExplainTurretModes_AutoAssist">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'docked_turretconfig_modes_dropdown_prefercapital'"/>
                <remove_help_overlay id="'docked_turretconfig_modes_dropdown_preferfighters'"/>
                <remove_help_overlay id="'docked_turretconfig_modes_dropdown_prefermissiles'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_prefercapital1'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_preferfighters1'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_prefermissiles1'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_prefercapital2'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_preferfighters2'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_prefermissiles2'"/>
                <show_help_overlay id="'docked_turretconfig_modes_dropdown_autoassist'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_autoassist1'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_autoassist2'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_ManageWeapons_ExplainTurretModes_Mining">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'docked_turretconfig_modes_dropdown_autoassist'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_autoassist1'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_autoassist2'"/>
                <show_help_overlay id="'docked_turretconfig_modes_dropdown_mining'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_mining1'" highlightonly="true"/>
                <show_help_overlay id="'docked_turrets_modes_dropdown_mining2'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_ManageWeapons_ExplainTurretModes_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'docked_turretconfig_modes_dropdown_mining'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_mining1'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_mining2'"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ManageWeapons_ExplainTurretModes"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ManageWeapons_SetTurretModes">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8061, $comment = 'Set the beam turret to only shoot missiles, and the plasma turret to attack capital ships first.' ],
                        ],
            ]" />
            <do_if value="$PlasmaTurret.mode == weaponmode.prefercapital and $BeamTurret.mode == weaponmode.missiledefence">
              <signal_cue cue="Tutorial_ManageWeapons_SetTurretModes_Done"/>
            </do_if>
            <do_else>
              <!--TODO: would be nice to highlight the dropdown buttons requiring action while none are opened-->
              <show_help_overlay id="'docked_turrets_modes_dropdown_missiledefence1'" highlightonly="true"/>
              <show_help_overlay id="'docked_turrets_modes_dropdown_prefercapital2'" highlightonly="true"/>
              <signal_cue_instantly cue="SetHintPosition" param="6"/>
              <signal_cue_instantly cue="SetHintID" param="27208" comment="{1012,27208}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_ManageWeapons_SetTurretModes_Done">
              <conditions>
                <check_any>
                  <event_object_weaponmode_changed object="$PlayerShip"/>
                  <event_cue_signalled/>
                </check_any>
                <check_value value="$PlasmaTurret.mode == weaponmode.prefercapital and $BeamTurret.mode == weaponmode.missiledefence"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_missiledefence1'"/>
                <remove_help_overlay id="'docked_turrets_modes_dropdown_prefercapital2'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="SetHintPosition" param="1"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 21, $comment = 'Good.' ],
                            ],
                  $callbackcue = Tutorial_ManageWeapons_SetTurretModes_UseCase_Done,
                  $abortcallbackcue = Tutorial_ManageWeapons_SetTurretModes_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_ManageWeapons_SetTurretModes_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ManageWeapons_SetTurretModes"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ManageWeapons_TurretsShoot">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8062, $comment = 'Ive disabled your weapons.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 8063, $comment = 'Just sit still and watch your turrets defend you.' ],
                        ],
            ]" />
            <create_ship name="$TurretTargetShip" macro="macro.ship_arg_l_destroyer_02_a_macro" sector="$PlayerShip.sector" capturable="false">
              <pilot group="argon.pilot"/>
              <loadout ref="flightschool_turret_shooting_target"/>
              <owner exact="$AlliedFaction" overridenpc="true"/>
              <position z="2km" object="$PlayerShip"/>
              <rotation yaw="$PlayerShip.rotation.yaw + 90deg"/>
            </create_ship>
            <find_object_component name="$turrets" object="$TurretTargetShip" class="class.turret" multiple="true"/>
            <do_for_each name="$turret" in="$turrets">
              <set_object_min_hull object="$turret" exact="100"/>
            </do_for_each>
            <find_object_component groupname="$engines" object="$TurretTargetShip" class="class.engine" multiple="true"/>
            <destroy_group group="$engines" explosion="false"/>
            <set_relation_boost object="$TurretTargetShip" value="-1" faction="faction.player" silent="true"/>
            <set_object_relation_behaviour object="$TurretTargetShip" disable="true"/>
            <add_ammo object="$TurretTargetShip" macro="macro.missile_guided_heavy_mk1_macro" amount="160"/>
            <create_order object="$TurretTargetShip" id="'Wait'" immediate="true"/>
            <signal_objects object="$TurretTargetShip.defencenpc" param="'attack'" param2="$PlayerShip" param3="[[], false, false]"/>
            <create_group groupname="$IncomingMissiles"/>
            <set_value name="$DestroyedMissiles" exact="0"/>
          </actions>
          <cues>
            <cue name="Tutorial_ManageWeapons_TurretsShoot_IncomingMissile" instantiate="true">
              <conditions>
                <event_object_incoming_missile group="$PlayerShipGroup"/>
              </conditions>
              <actions>
                <add_to_group groupname="$IncomingMissiles" object="event.param2"/>
              </actions>
            </cue>

            <cue name="Tutorial_ManageWeapons_TurretsShoot_Done">
              <conditions>
                <event_object_destroyed group="$IncomingMissiles"/>
                <set_value name="$DestroyedMissiles" exact="1" operation="add"/>
                <check_value value="$DestroyedMissiles ge 8"/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ManageWeapons_TurretsShoot"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_RelativeMovement">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 9001, $comment = 'There’s a capital ship nearby. Please approach it.' ],
                        ],
            ]" />
            <create_ship name="$RelativeMovementShip" macro="macro.ship_arg_xl_resupplier_01_a_macro" sector="$PlayerShip.sector" capturable="false">
              <pilot group="argon.pilot"/>
              <loadout ref="flightschool_relative_movement_target"/>
              <owner exact="$AlliedFaction" overridenpc="true"/>
              <position z="10km" object="$PlayerShip"/>
            </create_ship>
            <set_object_relation_behaviour object="$RelativeMovementShip" disable="true"/>
            <set_objective cue="GameStart_Tutorial" action="objective.flyto" object="$RelativeMovementShip"/>
          </actions>
          <cues>
            <cue name="Tutorial_RelativeMovement_ApproachingShip" checkinterval="0.1s">
              <conditions>
                <check_value value="$RelativeMovementShip.distanceto.{$PlayerShip} lt 5km"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 9002, $comment = 'Get as close as possible to its surface.' ],
                            ],
                  $callbackcue = Tutorial_RelativeMovement_GetCloseToSurface_UseCaseFinished,
                  $abortcallbackcue = Tutorial_RelativeMovement_GetCloseToSurface_UseCaseFinished,
                ]" />
              </actions>
              <cues>
                <!-- wait for the current voice lines to finish before checking whether to say the "get closer" lines-->
                <cue name="Tutorial_RelativeMovement_GetCloseToSurface_UseCaseFinished">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <cues>
                    <cue name="Tutorial_RelativeMovement_GetCloserCheck" checkinterval="0.1s">
                      <conditions>
                        <check_value value="player.input.flight.throttle == 0 and $PlayerShip.movementrefobject != $RelativeMovementShip"/>
                      </conditions>
                      <delay exact="1ms"/>
                      <actions>
                        <do_if value="not $GetCloserHints?">
                          <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                            $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                            $script = [
                                        table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 9003, $comment = 'You can get much closer than that.' ],
                                      ],
                            $callbackcue = Tutorial_RelativeMovement_GetCloserCheck_ResetDelay,
                            $abortcallbackcue = Tutorial_RelativeMovement_GetCloserCheck_ResetDelay,
                          ]" />
                          <set_value name="$GetCloserHints" exact="1"/>
                        </do_if>
                        <do_elseif value="@$GetCloserHints == 1">
                          <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                            $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                            $script = [
                                        table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 9004, $comment = 'Don’t be nervous! Get even closer.' ],
                                      ],
                            $callbackcue = Tutorial_RelativeMovement_GetCloserCheck_ResetDelay,
                            $abortcallbackcue = Tutorial_RelativeMovement_GetCloserCheck_ResetDelay,
                          ]" />
                          <set_value name="$GetCloserHints" exact="2"/>
                        </do_elseif>
                        <do_else>
                          <!--this one can repeat indefinitely-->
                          <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                            $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                            $script = [
                                        table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 9005, $comment = 'Closer...' ],
                                      ],
                            $callbackcue = Tutorial_RelativeMovement_GetCloserCheck_ResetDelay,
                            $abortcallbackcue = Tutorial_RelativeMovement_GetCloserCheck_ResetDelay,
                          ]" />
                        </do_else>
                      </actions>
                      <cues>
                        <cue name="Tutorial_RelativeMovement_GetCloserCheck_ResetDelay">
                          <conditions>
                            <event_cue_signalled/>
                          </conditions>
                          <delay exact="2s"/>
                          <actions>
                            <reset_cue cue="Tutorial_RelativeMovement_GetCloserCheck"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>

                <cue name="Tutorial_RelativeMovement_Collided">
                  <conditions>
                    <event_object_collided group="$PlayerShipGroup" otherobject="$RelativeMovementShip"/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 9006, $comment = '(laugh a little before speaking)Okay, that was a bit too close. But as you can see, small collisions are no big deal.' ],
                                ],
                    ]" />
                  </actions>
                </cue>

                <cue name="Tutorial_RelativeMovement_CloseEnough" checkinterval="0.1s">
                  <conditions>
                    <check_value value="$PlayerShip.movementrefobject == $RelativeMovementShip"/>
                  </conditions>
                  <actions>
                    <!--stop giving "get closer" hints even if the player leaves-->
                    <cancel_cue cue="Tutorial_RelativeMovement_GetCloserCheck"/>
                    <do_if value="player.input.flight.throttle != 0">
                      <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                        $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                        $script = [
                                    table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 9013, $comment = 'All right, now come to a stop.' ],
                                  ],
                      ]" />
                    </do_if>
                  </actions>
                  <cues>
                    <cue name="Tutorial_RelativeMovement_Stopped" checkinterval="0.1s">
                      <conditions>
                        <check_value value="player.input.flight.throttle == 0"/>
                      </conditions>
                      <actions>
                        <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                          $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                          $script = [
                                      table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 9007, $comment = 'Your are now flying relative to the ship, thanks to special flight assistance software. This works for most things that are bigger than medium-sized ships.' ],
                                      table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 9008, $comment = 'No matter what the capital ship does, you will move along with it.' ],
                                      table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 9009, $comment = 'This is especially useful for combat, as well as for docking or undocking.',
                                             $speakcallbackcue = Tutorial_RelativeMovement_SurfaceTargetsObjective ],
                                      table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 9010, $comment = 'I’ve set up some targets on the ship’s surface. Please destroy them.' ],
                                      table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 9011, $comment = 'Try to use the ship’s surface as cover wherever possible. Your strafe thrusters are useful here.' ],
                                    ],
                        ]" />
                      </actions>
                      <cues>
                        <cue name="Tutorial_RelativeMovement_SurfaceTargetsObjective">
                          <conditions>
                            <event_cue_signalled/>
                          </conditions>
                          <actions>
                            <set_relation_boost object="$RelativeMovementShip" value="-1" faction="faction.player" silent="true"/>
                            <add_to_group groupname="$SurfaceTargetsGroup" list="$RelativeMovementShip.turrets.operational.list"/>
                            <set_objective cue="GameStart_Tutorial" action="objective.destroy" group="$SurfaceTargetsGroup"/>
                            <set_value name="$TargetCount" exact="$SurfaceTargetsGroup.count - 2"/>
                          </actions>
                          <cues>
                            <!--this cue shouldn't technically be necessary but it's here to make this part robust against stalling progress-->
                            <cue name="Tutorial_RelativeMovement_AllSurfaceTargetsDestroyed_FallbackCheck" checkinterval="1s">
                              <conditions>
                                <check_value value="$RelativeMovementShip.turrets.operational.count == 0"/>
                              </conditions>
                              <actions>
                                <signal_cue cue="Tutorial_RelativeMovement_EnoughSurfaceTargetsDestroyed"/>
                              </actions>
                            </cue>

                            <cue name="Tutorial_RelativeMovement_EnoughSurfaceTargetsDestroyed">
                              <conditions>
                                <check_any>
                                  <check_all>
                                    <event_object_destroyed group="$SurfaceTargetsGroup"/>
                                    <check_value value="$SurfaceTargetsGroup.count le $TargetCount"/>
                                  </check_all>
                                  <event_cue_signalled/>
                                </check_any>
                              </conditions>
                              <actions>
                                <cancel_cue cue="Tutorial_RelativeMovement_AllSurfaceTargetsDestroyed_FallbackCheck"/>
                                <reset_relation_boost object="$RelativeMovementShip" faction="faction.player"/>
                                <cease_fire object="$RelativeMovementShip"/>
                                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                                  $script = [
                                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 9012, $comment = 'Now fly away from the ship’s surface until it leaves you behind.' ],
                                            ],
                                ]" />
                                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1087}"/>
                              </actions>
                              <cues>
                                <cue name="Tutorial_RelativeMovement_LeftShip" checkinterval="0.1s">
                                  <conditions>
                                    <check_value value="not $PlayerShip.movementrefobject"/>
                                  </conditions>
                                  <actions>
                                    <signal_cue cue="Tutorial_RelativeMovement_Done"/>
                                  </actions>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_RelativeMovement_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_RelativeMovement"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_SpaceSuit">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <!--spawn wreck-->
            <find_object name="$SpaceSuitTutorialWreck" space="player.sector" macro="macro.env_debris_station_l_05_container_macro"/>
            <set_object_min_hull object="$SpaceSuitTutorialWreck" exact="100"/>
            <find_object_component name="$SpaceSuitTutorialInterior" object="$SpaceSuitTutorialWreck" macro="macro.int_exploration_02_macro"/>
            <create_position name="$SpaceSuitTutorialInteriorEntryPos" object="$SpaceSuitTutorialInterior" z="-10m" space="$SpaceSuitTutorialWreck"/>
            <!--create a sequence of guidance positions to lead the player into the space suit exploration wreck-->
            <create_list name="$SpaceSuit_EnterWreck_GuidancePositions"/>
            <create_position name="$SpaceSuit_EnterWreck_GuidancePosition" x="-392" z="-267"/>
            <append_to_list name="$SpaceSuit_EnterWreck_GuidancePositions" exact="$SpaceSuit_EnterWreck_GuidancePosition"/>
            <create_position name="$SpaceSuit_EnterWreck_GuidancePosition" x="-371" z="-269"/>
            <append_to_list name="$SpaceSuit_EnterWreck_GuidancePositions" exact="$SpaceSuit_EnterWreck_GuidancePosition"/>
            <create_position name="$SpaceSuit_EnterWreck_GuidancePosition" x="-356" z="-278"/>
            <append_to_list name="$SpaceSuit_EnterWreck_GuidancePositions" exact="$SpaceSuit_EnterWreck_GuidancePosition"/>
            <create_position name="$SpaceSuit_EnterWreck_GuidancePosition" x="-338" z="-278"/>
            <append_to_list name="$SpaceSuit_EnterWreck_GuidancePositions" exact="$SpaceSuit_EnterWreck_GuidancePosition"/>
            <remove_value name="$SpaceSuit_EnterWreck_GuidancePosition"/>
            <find_object_component name="$SpaceSuitTutorialEntryRepairPanel" object="$SpaceSuitTutorialInterior" macro="macro.interactive_repairpanel_01_macro" grouptag="tag.interactionspot_1"/>
            <find_object_component name="$SpaceSuitTutorialLockboxRepairPanel" object="$SpaceSuitTutorialInterior" macro="macro.interactive_repairpanel_01_macro" grouptag="tag.interactionspot_2"/>
            <find_object_component name="$SpaceSuitTutorialDummyRepairPanel" object="$SpaceSuitTutorialInterior" macro="macro.interactive_repairpanel_01_macro" grouptag="tag.interactionspot_3"/>
            <destroy_object object="$SpaceSuitTutorialDummyRepairPanel"/>
            <remove_value name="$SpaceSuitTutorialDummyRepairPanel"/>
            <find_object_component groupname="$InteriorCollectables" object="$SpaceSuitTutorialInterior" macro="macro.sm_gen_wares_exploration_01_macro" includeobjects="true" multiple="true"/>
            <destroy_group group="$InteriorCollectables"/>
            <find_object name="$SpaceSuitTutorialLockbox" space="player.sector" macro="macro.sm_gen_lockbox_unusual_01_macro"/>
            <set_object_min_hull object="$SpaceSuitTutorialLockbox" exact="1"/>
            <set_object_radar_visible object="$SpaceSuitTutorialLockbox" visible="false"/>
            <set_drop_object object="$SpaceSuitTutorialLockbox" drop="'drops_flightschool_lockbox'"/>
            <add_to_group groupname="$SpaceSuitTutorialLocks" list="$SpaceSuitTutorialLockbox.locks.operational.list"/>
            <disable_collisions_between object="$SpaceSuitTutorialWreck" target="$SpaceSuitTutorialLockbox"/>
            <disable_collision_response object="$SpaceSuitTutorialLockbox"/>
            <!--check start position - if we're close enough skip the "approach" usecase and objective-->
            <do_if value="$PlayerShip.distanceto.[$SpaceSuitTutorialWreck, $SpaceSuitTutorialInteriorEntryPos] lt 100m">
              <cancel_cue cue="Tutorial_SpaceSuit_ArrivingAtWreck"/>
            </do_if>
            <do_else>
              <set_objective cue="GameStart_Tutorial" action="objective.flyto" object="$SpaceSuitTutorialWreck" offset="$SpaceSuitTutorialInteriorEntryPos"/>
              <do_if value="$PlayerShip.distanceto.{$SpaceSuitTutorialWreck} ge 50km">
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10001, $comment = 'Fly to the next objective. You may use travel mode or the autopilot if you like.' ],
                            ],
                ]" />
              </do_if>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_SpaceSuit_ArrivingAtWreck" checkinterval="0.1s">
              <conditions>
                <check_value value="$PlayerShip.distanceto.{$SpaceSuitTutorialWreck} lt 50km"/>
              </conditions>
              <actions>
                <do_if value="$PlayerShip.distanceto.[$SpaceSuitTutorialWreck, $SpaceSuitTutorialInteriorEntryPos] ge 250m">
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10002, $comment = 'This wreck has something inside it. Your ship will not fit so you’re going to have to get out of your ship and do a space walk.' ],
                                table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10003, $comment = 'Move a little closer to the indicated position and park your ship there.' ],
                              ],
                  ]" />
                </do_if>
              </actions>
            </cue>

            <cue name="Tutorial_SpaceSuit_NearWreck" checkinterval="0.1s">
              <conditions>
                <check_value value="$PlayerShip.distanceto.[$SpaceSuitTutorialWreck, $SpaceSuitTutorialInteriorEntryPos] lt 250m"/>
              </conditions>
              <actions>
                <unlock_getup/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10004, $comment = 'Please get up and leave the ship in your space suit.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_SpaceSuit_EnterSpaceSuit"/>
              </actions>
            </cue>

            <cue name="Tutorial_SpaceSuit_EnterSpaceSuit">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <find_player_transporter_slot name="$TransporterSlot" object="$PlayerShip.controlroom"/>
                <set_objective cue="GameStart_Tutorial" action="objective.usespacesuit" slot="$TransporterSlot" comment="Use Spacesuit"/>
                <signal_cue cue="Tutorial_SpaceSuit_EnterSpaceSuit_GetUpHint"/>
              </actions>
              <cues>
                <cue name="Tutorial_SpaceSuit_EnterSpaceSuit_StoppedControl" instantiate="true">
                  <conditions>
                    <event_player_stopped_control/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <remove_help_overlay id="'docked_getup'"/>
                    <signal_cue cue="Tutorial_SpaceSuit_EnterSpaceSuit_TransporterMenuHint"/>
                  </actions>
                </cue>

                <cue name="Tutorial_SpaceSuit_EnterSpaceSuit_StartedControl" instantiate="true">
                  <conditions>
                    <event_player_started_control/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <signal_cue cue="Tutorial_SpaceSuit_EnterSpaceSuit_GetUpHint"/>
                  </actions>
                </cue>

                <cue name="Tutorial_SpaceSuit_EnterSpaceSuit_OpenedTransporterMenu" instantiate="true">
                  <conditions>
                    <event_ui_triggered screen="'TransporterMenu'" control="''"/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <signal_cue cue="Tutorial_SpaceSuit_EnterSpaceSuit_MenuUsageHint"/>
                  </actions>
                </cue>

                <cue name="Tutorial_SpaceSuit_EnterSpaceSuit_ClosedTransporterMenu" instantiate="true">
                  <conditions>
                    <event_ui_triggered screen="'TransporterMenu'" control="'menu_close'"/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <signal_cue cue="Tutorial_SpaceSuit_EnterSpaceSuit_TransporterMenuHint"/>
                  </actions>
                </cue>

                <cue name="Tutorial_SpaceSuit_EnterSpaceSuit_OpenedUserQuestionMenu" instantiate="true">
                  <conditions>
                    <event_ui_triggered screen="'UserQuestionMenu'" control="''"/>
                  </conditions>
                  <actions>
                    <signal_cue cue="ShowHint_ConfirmInMenu"/>
                  </actions>
                </cue>

                <cue name="Tutorial_SpaceSuit_EnterSpaceSuit_ClosedUserQuestionMenu" instantiate="true">
                  <conditions>
                    <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <signal_cue cue="Tutorial_SpaceSuit_EnterSpaceSuit_TransporterMenuHint"/>
                  </actions>
                </cue>

                <cue name="Tutorial_SpaceSuit_EnterSpaceSuit_GetUpHint" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue cue="ShowHint_GetUp"/>
                    <remove_help_overlay all="true"/>
                    <show_help_overlay id="'docked_getup'" highlightonly="true"/>
                    <set_value name="$GetUpHintActive" exact="true"/>
                  </actions>
                </cue>

                <cue name="Tutorial_SpaceSuit_EnterSpaceSuit_TransporterMenuHint" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="0.5s"/>
                  <actions>
                    <remove_value name="$GetUpHintActive"/>
                    <do_if value="not player.ship.isclass.spacesuit">
                      <signal_cue_instantly cue="SetHintID" param="[27303, 27302, 27302]" comment="{1012, 27303} or {1012, 27302}"/>
                    </do_if>
                  </actions>
                  <cues>
                    <cue name="Tutorial_SpaceSuit_EnterSpaceSuit_TransporterMenuHint_Cancel">
                      <conditions>
                        <check_any>
                          <event_ui_triggered screen="'UserQuestionMenu'" control="''"/>
                          <event_ui_triggered screen="'TransporterMenu'" control="''"/>
                          <event_player_started_control/>
                        </check_any>
                      </conditions>
                      <actions>
                        <cancel_cue cue="parent"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="Tutorial_SpaceSuit_EnterSpaceSuit_MenuUsageHint" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="SetHintID" param="27304" comment="{1012, 27304}"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_SpaceSuit_Basics">
              <conditions>
                <event_object_changed_room object="player.entity"/>
                <check_value value="player.ship.isclass.spacesuit"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <find_object_component groupname="$SpaceSuitRepairWeapons" object="player.ship" weapontype="repair" multiple="true"/>
                <find_object_component groupname="$SpaceSuitCombatWeapons" object="player.ship" weapontype="combat" multiple="true"/>
                <cancel_cue cue="Tutorial_SpaceSuit_EnterSpaceSuit"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10005, $comment = 'You’ve probably noticed that you keep moving in the same direction. That’s because space suits don’t have flight assistance and are limited to Newtonian flight.' ],
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10006, $comment = 'Any directional input, whether it’s strafing, accelerating or decelerating, will push you in that direction. I’ll let you try it out for a little while.' ],
                              1s,
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10022, $comment = 'While you do that...' ],
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10018, $comment = 'Your space suit is equipped with a small hand laser. Please don’t try to use it in fights with actual ships. You’d be pulverised immediately!' ],
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10012, $comment = 'You also have a repair tool. This tool works on most damaged objects, as long as they’re not actually wrecked. This thing is beyond repair, though.' ],
                            ],
                  $callbackcue = Tutorial_SpaceSuit_ExplanationFinished_Delay,
                  $abortcallbackcue = Tutorial_SpaceSuit_ExplanationFinished_Delay,
                ]" />
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30179,3011}" comment="Adapt to Spacesuit"/>
              </actions>
              <cues>
                <cue name="Tutorial_SpaceSuit_ExplanationFinished_Delay">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="3s"/>
                  <actions>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10007, $comment = 'Try to come to a stop using these inputs.' ],
                                ],
                      $callbackcue = Tutorial_SpaceSuit_StopManual,
                      $abortcallbackcue = Tutorial_SpaceSuit_StopManual,
                    ]" />
                    <signal_cue_instantly cue="SetHintID" param="[27401, 27400]" comment="{1012, 27401} or {1012, 27400}"/>
                  </actions>
                  <cues>
                    <cue name="Tutorial_SpaceSuit_StopManual">
                      <conditions>
                        <event_cue_signalled/>
                      </conditions>
                      <delay exact="10s"/>
                      <actions>
                        <signal_cue cue="Tutorial_SpaceSuit_StopAssisted_Helper"/>
                      </actions>
                      <cues>
                        <cue name="Tutorial_SpaceSuit_StopAssisted_Helper">
                          <conditions>
                            <event_cue_signalled/>
                          </conditions>
                          <cues>
                            <cue name="Tutorial_SpaceSuit_StopAssisted_MappingCheck">
                              <actions>
                                <do_if value="player.input.controller">
                                  <do_if value="player.input.ismapped.controller.INPUT_ACTION_STOP">
                                    <set_value name="$FullStopMapped" exact="true"/>
                                  </do_if>
                                  <do_else>
                                    <do_if value="player.input.ismapped.controller.INPUT_STATE_ACCELERATE">
                                      <set_value name="$AccInput" exact="'$INPUT_STATE_ACCELERATE$'"/>
                                    </do_if>
                                    <do_elseif value="player.input.ismapped.controller.INPUT_STATE_FULLFORWARD">
                                      <set_value name="$AccInput" exact="'$INPUT_STATE_FULLFORWARD$'"/>
                                    </do_elseif>
                                    <do_elseif value="player.input.ismapped.controller.INPUT_RANGE_THROTTLE">
                                      <set_value name="$AccInput" exact="'$INPUT_RANGE_THROTTLE$'"/>
                                    </do_elseif>
                                    <do_if value="player.input.ismapped.controller.INPUT_STATE_DECELERATE">
                                      <set_value name="$DecInput" exact="'$INPUT_STATE_DECELERATE$'"/>
                                    </do_if>
                                    <do_elseif value="player.input.ismapped.controller.INPUT_STATE_FULLREVERSE">
                                      <set_value name="$DecInput" exact="'$INPUT_STATE_FULLREVERSE$'"/>
                                    </do_elseif>
                                  </do_else>
                                </do_if>
                                <do_else>
                                  <do_if value="player.input.ismapped.INPUT_ACTION_STOP">
                                    <set_value name="$FullStopMapped" exact="true"/>
                                  </do_if>
                                  <do_else>
                                    <do_if value="player.input.ismapped.INPUT_STATE_ACCELERATE">
                                      <set_value name="$AccInput" exact="'$INPUT_STATE_ACCELERATE$'"/>
                                    </do_if>
                                    <do_elseif value="player.input.ismapped.INPUT_STATE_FULLFORWARD">
                                      <set_value name="$AccInput" exact="'$INPUT_STATE_FULLFORWARD$'"/>
                                    </do_elseif>
                                    <do_elseif value="player.input.ismapped.INPUT_RANGE_THROTTLE">
                                      <set_value name="$AccInput" exact="'$INPUT_RANGE_THROTTLE$'"/>
                                    </do_elseif>
                                    <do_if value="player.input.ismapped.INPUT_STATE_DECELERATE">
                                      <set_value name="$DecInput" exact="'$INPUT_STATE_DECELERATE$'"/>
                                    </do_if>
                                    <do_elseif value="player.input.ismapped.INPUT_STATE_FULLREVERSE">
                                      <set_value name="$DecInput" exact="'$INPUT_STATE_FULLREVERSE$'"/>
                                    </do_elseif>
                                  </do_else>
                                </do_else>
                                <do_if value="$FullStopMapped?">
                                  <signal_cue_instantly cue="SetHintID" param="26419" comment="{1012, 26419}"/>
                                  <set_value name="$InputHintShown" exact="true"/>
                                </do_if>
                                <do_elseif value="$AccInput? and $DecInput?">
                                  <substitute_text text="$FullStopHintText" source="{1012,26433}">
                                    <replace string="'$ACCINPUT$'" with="$AccInput"/>
                                    <replace string="'$DECINPUT$'" with="$DecInput"/>
                                  </substitute_text>
                                  <signal_cue_instantly cue="SetHintText" param="$FullStopHintText"/>
                                  <set_value name="$InputHintShown" exact="true"/>
                                </do_elseif>
                                <do_if value="$InputHintShown?">
                                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                                    $script = [
                                                table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10008, $comment = 'Tricky, isn’t it? Luckily there’s an easier way. Try it now.' ],
                                              ],
                                  ]" />
                                </do_if>
                                <do_else>
                                  <signal_cue_instantly cue="SetHintAllowClose"/>
                                  <signal_cue_instantly cue="SetHintID" param="100008" comment="{1012, 100008}"/>
                                </do_else>
                              </actions>
                              <cues>
                                <cue name="Tutorial_SpaceSuit_StopAssisted_MappingCheck_HintClosed">
                                  <conditions>
                                    <check_any>
                                      <event_ui_triggered screen="'hintclosed'"/>
                                    </check_any>
                                  </conditions>
                                  <delay exact="1ms"/>
                                  <actions>
                                    <open_menu menu="OptionsMenu" param="'keyboard_space'"/>
                                    <signal_cue_instantly cue="SetHintPosition" param="17"/>
                                    <signal_cue_instantly cue="SetHintID" param="26434" comment="{1012, 26434}"/>
                                    <signal_cue_instantly cue="SetHintAllowInOptionsMenu"/>
                                  </actions>
                                  <cues>
                                    <cue name="Tutorial_SpaceSuit_StopAssisted_MappingCheck_InputMenuClosed">
                                      <conditions>
                                        <event_ui_triggered screen="'OptionsMenu'" control="'menu_close'"/>
                                      </conditions>
                                      <actions>
                                        <signal_cue_instantly cue="SetHintPosition" param="1"/>
                                        <signal_cue_instantly cue="ClearHintID"/>
                                        <signal_cue_instantly cue="ClearHintAllowInOptionsMenu"/>
                                        <reset_cue cue="Tutorial_SpaceSuit_StopAssisted_MappingCheck"/>
                                      </actions>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>

                    <cue name="Tutorial_SpaceSuit_StopAssisted" checkinterval="0.1s">
                      <conditions>
                        <check_value value="player.occupiedship.speed == 0"/>
                      </conditions>
                      <actions>
                        <signal_cue_instantly cue="ClearHintID"/>
                        <signal_cue cue="Tutorial_SpaceSuit_InsideWreck"/>
                        <cancel_cue cue="Tutorial_SpaceSuit_ExplanationFinished_Delay"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_SpaceSuit_InsideWreck">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10009, $comment = 'Much better. I think you’re ready for some manoeuvring. Please fly inside the wreck using the indicated entry point.' ],
                            ],
                ]" />
                <set_objective cue="GameStart_Tutorial" action="objective.flyto" object="$SpaceSuitTutorialWreck" offset="$SpaceSuitTutorialInteriorEntryPos"/>
              </actions>
              <cues>
                <cue name="Tutorial_SpaceSuit_NearClosedEntry" checkinterval="0.1s">
                  <conditions>
                    <check_value value="player.occupiedship.distanceto.[$SpaceSuitTutorialWreck, $SpaceSuitTutorialInteriorEntryPos] lt 10m"/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <do_if value="$SpaceSuitTutorialEntryRepairPanel.hullpercentage lt 100">
                      <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                        $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                        $script = [
                                    table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10019, $comment = 'There’s an access hatch, but it’s malfunctioning. Look for a broken control panel and use your repair tool to fix it.' ],
                                  ],
                      ]" />
                      <set_objective cue="GameStart_Tutorial" action="objective.repair" object="$SpaceSuitTutorialEntryRepairPanel"/>
                      <signal_cue cue="Tutorial_SpaceSuit_EntryPanel_WeaponCheck"/>
                    </do_if>
                    <do_else>
                      <signal_cue cue="Tutorial_SpaceSuit_EntryPanelRepaired"/>
                    </do_else>
                  </actions>
                  <cues>
                    <cue name="Tutorial_SpaceSuit_EntryPanel_WeaponCheck">
                      <conditions>
                        <event_cue_signalled/>
                      </conditions>
                      <delay exact="1ms"/>
                      <actions>
                        <signal_cue cue="Tutorial_SpaceSuit_EntryPanel_WeaponChanged"/>
                      </actions>
                      <cues>
                        <cue name="Tutorial_SpaceSuit_EntryPanel_WeaponChanged" instantiate="true">
                          <conditions>
                            <check_any>
                              <event_cue_signalled/>
                              <event_player_activated_weapongroup primary="true"/>
                            </check_any>
                          </conditions>
                          <actions>
                            <remove_value name="$RepairWeaponActive"/>
                            <do_for_each in="$SpaceSuitRepairWeapons">
                              <do_if value="loop.element.isreadytofire">
                                <set_value name="$RepairWeaponActive" exact="true"/>
                                <break/>
                              </do_if>
                            </do_for_each>
                            <signal_cue_instantly cue="ClearHintID"/>
                            <do_if value="$RepairWeaponActive?">
                              <signal_cue_instantly cue="SetHintID" param="27408" comment="{1012, 27408}"/>
                            </do_if>
                            <do_elseif value="player.input.ismapped.INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_1 and player.input.ismapped.INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_2 and player.input.ismapped.INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_3 and player.input.ismapped.INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_4">
                              <signal_cue_instantly cue="SetHintID" param="[27412, 27407, 27407]" comment="{1012, 27412} or {1012, 27407}"/>
                            </do_elseif>
                            <do_else>
                              <signal_cue_instantly cue="SetHintID" param="27407" comment="{1012, 27407}"/>
                            </do_else>
                          </actions>
                        </cue>
                      </cues>
                    </cue>

                    <cue name="Tutorial_SpaceSuit_EntryPanelRepaired">
                      <conditions>
                        <check_any>
                          <event_object_hull_repaired object="$SpaceSuitTutorialEntryRepairPanel"/>
                          <event_cue_signalled/>
                        </check_any>
                      </conditions>
                      <actions>
                        <signal_cue_instantly cue="ClearHintID"/>
                        <set_objective cue="GameStart_Tutorial" action="objective.flyto" object="$SpaceSuitTutorialWreck" offset="$SpaceSuit_EnterWreck_GuidancePositions.{1}"/>
                        <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                          $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                          $script = [
                                      table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10020, $comment = 'Now fly into the corridor.' ],
                                    ],
                        ]" />
                        <cancel_cue cue="Tutorial_SpaceSuit_EntryPanel_WeaponChanged"/>
                      </actions>
                      <cues>
                        <cue name="Tutorial_SpaceSuit_EnterWreck" checkinterval="0.1s">
                          <conditions>
                            <check_value value="player.occupiedship.distanceto.[$SpaceSuitTutorialWreck, $SpaceSuit_EnterWreck_GuidancePositions.{1}] lt 5m"/>
                          </conditions>
                          <actions>
                            <do_if value="not $Tutorial_SpaceSuit_InsideWreck_UseCaseTriggered?">
                              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                                $script = [
                                            table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10014, $comment = 'You may have noticed the oxygen indicator, which is slowly going down. There’s no need to worry about it; you will be back in your ship with plenty of time to spare.' ],
                                          ],
                              ]" />
                              <set_value name="$Tutorial_SpaceSuit_InsideWreck_UseCaseTriggered" exact="true"/>
                            </do_if>
                            <remove_value name="$SpaceSuit_EnterWreck_GuidancePositions.{1}"/>
                            <do_if value="$SpaceSuit_EnterWreck_GuidancePositions.count">
                              <set_objective cue="GameStart_Tutorial" action="objective.flyto" object="$SpaceSuitTutorialWreck" offset="$SpaceSuit_EnterWreck_GuidancePositions.{1}"/>
                              <reset_cue cue="this"/>
                            </do_if>
                            <do_else>
                              <signal_cue cue="Tutorial_SpaceSuit_WreckEntered"/>
                            </do_else>
                          </actions>
                        </cue>

                        <cue name="Tutorial_SpaceSuit_WreckEntered">
                          <conditions>
                            <event_cue_signalled/>
                          </conditions>
                          <delay exact="1ms"/>
                          <actions>
                            <!--move playership to a position a bit away from the entry, so that boosting back to it makes more sense-->
                            <warp object="$PlayerShip" sector="$SpaceSuitTutorialWreck.sector">
                              <position object="$SpaceSuitTutorialWreck" x="-1000" y="0" z="-267.6"/>
                              <rotation yaw="90deg"/>
                            </warp>
                            <do_if value="$SpaceSuitTutorialLockboxRepairPanel.hullpercentage lt 100">
                              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                                $script = [
                                            table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10021, $comment = 'There’s another broken control panel. Repair this one as well.' ],
                                          ],
                              ]" />
                              <signal_cue cue="Tutorial_SpaceSuit_LockboxPanel_WeaponCheck"/>
                              <set_objective cue="GameStart_Tutorial" action="objective.repair" object="$SpaceSuitTutorialLockboxRepairPanel"/>
                            </do_if>
                            <do_else>
                              <signal_cue cue="Tutorial_SpaceSuit_LockboxPanelRepaired"/>
                            </do_else>
                          </actions>
                          <cues>
                            <cue name="Tutorial_SpaceSuit_LockboxPanel_WeaponCheck">
                              <conditions>
                                <event_cue_signalled/>
                              </conditions>
                              <delay exact="1ms"/>
                              <actions>
                                <signal_cue cue="Tutorial_SpaceSuit_LockboxPanel_WeaponChanged"/>
                              </actions>
                              <cues>
                                <cue name="Tutorial_SpaceSuit_LockboxPanel_WeaponChanged" instantiate="true">
                                  <conditions>
                                    <check_any>
                                      <event_cue_signalled/>
                                      <event_player_activated_weapongroup primary="true"/>
                                    </check_any>
                                  </conditions>
                                  <actions>
                                    <remove_value name="$RepairWeaponActive"/>
                                    <do_for_each in="$SpaceSuitRepairWeapons">
                                      <do_if value="loop.element.isreadytofire">
                                        <set_value name="$RepairWeaponActive" exact="true"/>
                                        <break/>
                                      </do_if>
                                    </do_for_each>
                                    <signal_cue_instantly cue="ClearHintID"/>
                                    <do_if value="$RepairWeaponActive?">
                                      <signal_cue_instantly cue="SetHintID" param="27408" comment="{1012, 27408}"/>
                                    </do_if>
                                    <do_elseif value="player.input.ismapped.INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_1 and player.input.ismapped.INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_2 and player.input.ismapped.INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_3 and player.input.ismapped.INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_4">
                                      <signal_cue_instantly cue="SetHintID" param="[27212, 27207, 27207]" comment="{1012, 27412} or {1012, 27407}"/>
                                    </do_elseif>
                                    <do_else>
                                      <signal_cue_instantly cue="SetHintID" param="27407" comment="{1012, 27407}"/>
                                    </do_else>
                                  </actions>
                                </cue>
                              </cues>
                            </cue>

                            <cue name="Tutorial_SpaceSuit_LockboxPanelRepaired">
                              <conditions>
                                <check_any>
                                  <event_object_hull_repaired object="$SpaceSuitTutorialLockboxRepairPanel"/>
                                  <event_cue_signalled/>
                                </check_any>
                              </conditions>
                              <delay exact="1ms"/>
                              <actions>
                                <signal_cue_instantly cue="ClearHintID"/>
                                <do_if value="$SpaceSuitTutorialLocks.count">
                                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                                    $script = [
                                                table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10010, $comment = 'There’s a lockbox here! What a lucky find. Please activate your weapon and carefully shoot off all the locks.' ],
                                              ],
                                  ]" />
                                  <set_objective cue="GameStart_Tutorial" action="objective.destroy" group="$SpaceSuitTutorialLocks"/>
                                  <signal_cue cue="Tutorial_SpaceSuit_Lockbox_WeaponCheck"/>
                                </do_if>
                                <do_else>
                                  <signal_cue cue="Tutorial_SpaceSuit_LockboxOpened"/>
                                </do_else>
                              </actions>
                              <cues>
                                <cue name="Tutorial_SpaceSuit_Lockbox_WeaponCheck">
                                  <conditions>
                                    <event_cue_signalled/>
                                  </conditions>
                                  <delay exact="1ms"/>
                                  <actions>
                                    <signal_cue cue="Tutorial_SpaceSuit_Lockbox_WeaponChanged"/>
                                  </actions>
                                  <cues>
                                    <cue name="Tutorial_SpaceSuit_Lockbox_WeaponChanged" instantiate="true">
                                      <conditions>
                                        <check_any>
                                          <event_cue_signalled/>
                                          <event_player_activated_weapongroup primary="true"/>
                                        </check_any>
                                      </conditions>
                                      <actions>
                                        <remove_value name="$CombatWeaponActive"/>
                                        <do_for_each in="$SpaceSuitCombatWeapons">
                                          <do_if value="loop.element.isreadytofire">
                                            <set_value name="$CombatWeaponActive" exact="true"/>
                                            <break/>
                                          </do_if>
                                        </do_for_each>
                                        <signal_cue_instantly cue="ClearHintID"/>
                                        <do_if value="$CombatWeaponActive?">
                                          <signal_cue_instantly cue="SetHintID" param="27410" comment="{1012, 27410}"/>
                                        </do_if>
                                        <do_elseif value="player.input.ismapped.INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_1 and player.input.ismapped.INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_2 and player.input.ismapped.INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_3 and player.input.ismapped.INPUT_ACTION_SELECT_PRIMARY_WEAPONGROUP_4">
                                          <signal_cue_instantly cue="SetHintID" param="[27413, 27407, 27407]" comment="{1012, 27413} or {1012, 27409}"/>
                                        </do_elseif>
                                        <do_else>
                                          <signal_cue_instantly cue="SetHintID" param="27409" comment="{1012, 27409}"/>
                                        </do_else>
                                      </actions>
                                    </cue>
                                  </cues>
                                </cue>

                                <cue name="Tutorial_SpaceSuit_LockDamaged">
                                  <conditions>
                                    <event_object_hull_damaged group="$SpaceSuitTutorialLocks"/>
                                  </conditions>
                                  <actions>
                                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                                      $script = [
                                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10023, $comment = 'Ship weapons also work, but you have to be much more careful with those.' ],
                                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10024, $comment = 'Lockboxes are fragile things. Some even explode!' ],
                                                ],
                                    ]" />
                                  </actions>
                                </cue>

                                <cue name="Tutorial_SpaceSuit_LockboxOpened">
                                  <conditions>
                                    <check_any>
                                      <event_lockbox_opened object="$SpaceSuitTutorialLockbox"/>
                                      <event_cue_signalled/>
                                    </check_any>
                                  </conditions>
                                  <actions>
                                    <cancel_cue cue="Tutorial_SpaceSuit_Lockbox_WeaponCheck"/>
                                    <signal_cue_instantly cue="ClearHintID"/>
                                    <signal_cue cue="Tutorial_SpaceSuit_ReturnToShip"/>
                                    <find_object name="$Drop" class="class.collectable" space="player.zone"/>
                                    <do_if value="$Drop.exists">
                                      <set_object_velocity object="$Drop">
                                        <linear x="0" y="0" z="0"/>
                                      </set_object_velocity>
                                      <signal_cue cue="ShowHint_CollectItemInSpace"/>
                                    </do_if>
                                  </actions>
                                  <cues>
                                    <cue name="Tutorial_SpaceSuit_WareCollected">
                                      <conditions>
                                        <event_player_collected_ware/>
                                      </conditions>
                                      <delay exact="1ms"/>
                                      <actions>
                                        <signal_cue_instantly cue="ClearHintID"/>
                                      </actions>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_SpaceSuit_ReturnToShip">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1026}" object="$SpaceSuitTutorialWreck" offset="$SpaceSuitTutorialInteriorEntryPos"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10011, $comment = 'Congratulations, you did it! You may keep the item for yourself after you’ve finished here.' ],
                              0.5s,
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10013, $comment = 'Please leave the wreck and return to your ship now.' ],
                            ],
                ]" />
              </actions>
              <cues>
                <cue name="Tutorial_SpaceSuit_WreckLeft" checkinterval="0.1s">
                  <conditions>
                    <check_value value="player.occupiedship.distanceto.[$SpaceSuitTutorialWreck, $SpaceSuitTutorialInteriorEntryPos] lt 10m"/>
                  </conditions>
                  <actions>
                    <set_objective cue="GameStart_Tutorial" action="objective.dockat" object="$PlayerShip"/>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10015, $comment = 'The space suit is also equipped with a booster. You can use it now to reach your ship more quickly. Be careful, though. It’s easy to overshoot or crash into your target that way.' ],
                                ],
                    ]" />
                    <signal_cue cue="ShowHint_Boost"/>
                  </actions>
                  <cues>
                    <cue name="Tutorial_SpaceSuit_ApproachingShip" checkinterval="0.1s">
                      <conditions>
                        <check_value value="player.occupiedship.distanceto.{$PlayerShip} lt 50m"/>
                      </conditions>
                      <actions>
                        <do_if value="player.occupiedship != $PlayerShip and player.occupiedship.assigneddock == null">
                          <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                            $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                            $script = [
                                        table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10016, $comment = 'To get back in, you need to make a docking request. Please do so now.' ],
                                      ],
                          ]" />
                          <signal_cue cue="ShowHint_RequestDocking"/>
                        </do_if>
                        <do_else>
                          <signal_cue cue="PlayerAlreadyKnewUseCase"/>
                        </do_else>
                      </actions>
                      <cues>
                        <cue name="Tutorial_SpaceSuit_DockingGranted">
                          <conditions>
                            <event_object_dock_assigned object="player.occupiedship"/>
                          </conditions>
                          <actions>
                            <signal_cue cue="ShowHint_DockingLights"/>
                            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                              $script = [
                                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 10017, $comment = 'Now follow the green lights to the dock and fly inside.' ],
                                        ],
                            ]" />
                          </actions>
                        </cue>

                        <cue name="Tutorial_SpaceSuit_ReturnedToShip">
                          <conditions>
                            <event_object_changed_room object="player.entity"/>
                            <check_value value="not player.ship.isclass.spacesuit"/>
                          </conditions>
                          <delay exact="1ms"/>
                          <actions>
                            <signal_cue_instantly cue="SetHintID" param="[1040, 1042, 1042]" comment="{1012, 1040} or {1012, 1042}"/>
                            <set_objective cue="GameStart_Tutorial" action="objective.embark" object="$PlayerShip"/>
                          </actions>
                          <cues>
                            <cue name="Tutorial_SpaceSuit_StartedShipcontrol">
                              <conditions>
                                <event_player_started_control/>
                                <check_value value="player.controlled == $PlayerShip"/>
                              </conditions>
                              <actions>
                                <signal_cue_instantly cue="ClearHintID"/>
                                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                                <signal_cue cue="Tutorial_SpaceSuit_Done"/>
                              </actions>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_SpaceSuit_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_SpaceSuit"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_FlightAssist">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 11002, $comment = 'Please turn off flight assistance now.' ],
                        ],
            ]" />
            <signal_cue cue="ShowHint_DisableFlightAssist"/>
            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1093}"/>
          </actions>
          <cues>
            <cue name="Tutorial_FlightAssist_TurnedOff" checkinterval="0.1s">
              <conditions>
                <check_value value="not player.flightassist"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 11003, $comment = 'I’ll give you some time to play around with it. Re-enable flight assistance when you want to move on to the next step.' ],
                            ],
                ]" />
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
              </actions>
              <cues>
                <cue name="Tutorial_FlightAssist_TurnOnHint">
                  <delay exact="10s"/>
                  <actions>
                    <signal_cue cue="ShowHint_ReenableFlightAssist"/>
                  </actions>
                </cue>

                <cue name="Tutorial_FlightAssist_TurnedOn" checkinterval="0.1s">
                  <conditions>
                    <check_value value="player.flightassist"/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <cancel_cue cue="Tutorial_FlightAssist_TurnOnHint"/>
                    <signal_cue cue="Tutorial_FlightAssist_Travel"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_FlightAssist_Travel">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 11004, $comment = 'This next part is technically against the rules, so you didn’t hear it from me.' ],
                              0.2s,
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 11005, $comment = 'We’ll combine two of the things you’ve learned. Aim at empty space and activate travel mode.' ],
                            ],
                  $callbackcue = Tutorial_FlightAssist_Travel_ActivateModeObjectiveAndHint,
                  $abortcallbackcue = Tutorial_FlightAssist_Travel_ActivateModeObjectiveAndHint,
                ]" />
              </actions>
              <cues>
                <cue name="Tutorial_FlightAssist_Travel_ActivateModeObjectiveAndHint">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue cue="ShowHint_ActivateTravelMode"/>
                    <set_value name="$TravelModeHintActive" exact="true"/>
                    <show_help_overlay id="'docked_modes'" highlightonly="true"/>
                    <show_help_overlay id="'docked_mode_dropdown_travel'" highlightonly="true"/>
                    <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1090}"/>
                  </actions>
                </cue>

                <cue name="Tutorial_FlightAssist_Travel_ModeActivated">
                  <conditions>
                    <check_any>
                      <event_player_travelmode_charge_started/>
                      <event_player_travelmode_started/>
                    </check_any>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <remove_help_overlay id="'docked_modes'"/>
                    <remove_help_overlay id="'docked_mode_dropdown_travel'"/>
                    <do_if value="$ShipMenuOpen?">
                      <signal_cue cue="ShowHint_CloseMenus"/>
                    </do_if>
                    <cancel_cue cue="Tutorial_FlightAssist_Travel_ActivateModeObjectiveAndHint"/>
                    <remove_value name="$TravelModeHintActive"/>
                  </actions>
                  <cues>
                    <cue name="Tutorial_FlightAssist_Travel_MenuClosed">
                      <conditions>
                        <event_ui_triggered screen="'DockedMenu'" control="'menu_close'"/>
                      </conditions>
                      <actions>
                        <signal_cue_instantly cue="ClearHintID"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="Tutorial_FlightAssist_Travel_Started">
                  <conditions>
                    <event_player_travelmode_started/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 11006, $comment = 'Build up some speed.' ],
                                ],
                    ]" />
                    <set_value name="$TargetSpeed" exact="$PlayerShip.travel.maxspeed * 0.33"/>
                    <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1076}">
                      <progress progress="0" max="100"/>
                    </set_objective>
                  </actions>
                  <cues>
                    <cue name="Tutorial_FlightAssist_Travel_GainSpeedObjective">
                      <delay exact="1ms"/>
                      <actions>
                        <update_objective_progress cue="GameStart_Tutorial" progress="1000 * $PlayerShip.speed / $TargetSpeed" max="1000" silent="true"/>
                        <reset_cue cue="this"/>
                      </actions>
                    </cue>

                    <cue name="Tutorial_FlightAssist_Travel_SpeedGained" checkinterval="0.1s">
                      <conditions>
                        <check_value value="$PlayerShip.speed gt $TargetSpeed"/>
                      </conditions>
                      <actions>
                        <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                          $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                          $script = [
                                      table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 11007, $comment = 'Now turn off flight assist.' ],
                                    ],
                        ]" />
                        <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1093}"/>
                        <cancel_cue cue="Tutorial_FlightAssist_Travel_MenuClosed"/>
                        <signal_cue cue="ShowHint_DisableFlightAssist"/>
                      </actions>
                      <cues>
                        <cue name="Tutorial_FlightAssist_Travel_AssistOff" checkinterval="0.1s">
                          <conditions>
                            <check_value value="not player.flightassist"/>
                          </conditions>
                          <actions>
                            <create_object name="$FlyToBeacon" macro="macro.env_deco_nav_beacon_t1_macro" sector="$PlayerShip.sector">
                              <position object="$PlayerShip" x="9000km" comment="do not use coordinates >= 10000km"/>
                            </create_object>
                            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                              $script = [
                                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 11008, $comment = 'Your speed is no longer increasing.' ],
                                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 11009, $comment = 'More importantly though, your ship is very manoeuvrable again.' ],
                                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 11010, $comment = 'It takes some practice, but you can use this for significant course corrections during travel mode.',
                                                 $speakcallbackcue = Tutorial_FlightAssist_Travel_AlignObjective ],
                                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 11011, $comment = 'Try this now by aligning to the new objective, then re-enabling flight assistance.' ],
                                        ],
                            ]" />
                            <signal_cue_instantly cue="ClearHintID"/>
                          </actions>
                          <cues>
                            <cue name="Tutorial_FlightAssist_Travel_AlignObjective">
                              <conditions>
                                <event_cue_signalled/>
                              </conditions>
                              <actions>
                                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1089}" object="$FlyToBeacon"/>
                              </actions>
                              <cues>
                                <cue name="Tutorial_FlightAssist_Travel_Aligned" checkinterval="0.1s">
                                  <conditions>
                                    <check_value value="@$FlyToBeacon.exists"/>
                                    <check_object object="$FlyToBeacon">
                                      <match_is_in_view_of object="player.ship" vertical="10deg" horizontal="10deg"/>
                                    </check_object>
                                  </conditions>
                                  <actions>
                                    <signal_cue cue="ShowHint_ReenableFlightAssist"/>
                                    <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1094}"/>
                                  </actions>
                                  <cues>
                                    <cue name="Tutorial_FlightAssist_Travel_AssistOn" checkinterval="0.1s">
                                      <conditions>
                                        <check_value value="player.flightassist"/>
                                      </conditions>
                                      <actions>
                                        <signal_cue_instantly cue="ClearHintID"/>
                                        <signal_cue cue="Tutorial_FlightAssist_Finish"/>
                                      </actions>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_FlightAssist_Finish">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 11012, $comment = 'I find it really fun to drift my way into jump gates at high speed that way, but do be careful and practice in a safe environment first. I don’t want to hear about you turning your ship into a pancake, right?' ],
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 11013, $comment = 'Right. Now that the exciting part is over, let’s wind down with something a bit calmer.' ],
                            ],
                  $callbackcue = Tutorial_FlightAssist_Finish_SpeakFinished,
                  $abortcallbackcue = Tutorial_FlightAssist_Finish_SpeakFinished,
                ]" />
              </actions>
              <cues>
                <cue name="Tutorial_FlightAssist_Finish_SpeakFinished">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue cue="Tutorial_FlightAssist_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_FlightAssist_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_FlightAssist"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Docking">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_objective cue="GameStart_Tutorial" action="objective.dockat" object="$Wharf"/>
            <signal_cue cue="ShowHint_Accelerate"/>
            <do_if value="$PlayerShip.distanceto.{$Wharf} gt 5km">
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 12001, $comment = 'Fly to the marked station.' ],
                          ],
              ]" />
            </do_if>
          </actions>
          <cues>
            <cue name="Tutorial_Docking_NearStation" checkinterval="0.1s">
              <conditions>
                <check_value value="$PlayerShip.distanceto.{$Wharf} lt 5km"/>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_RequestDocking"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 12020, $comment = 'Now that youre in range, interact with the station to request docking permission.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Docking_DockAssigned">
              <conditions>
                <event_object_dock_assigned group="$PlayerShipGroup"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <cancel_cue cue="Tutorial_Docking_NearStation"/>
                <signal_cue cue="ShowHint_DockingLights"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 12003, $comment = 'Follow the trail of lights to your assigned dock.' ],
                            ],
                  $callbackcue = Tutorial_Docking_FlyToDock_SpeakFinished,
                  $abortcallbackcue = Tutorial_Docking_FlyToDock_SpeakFinished,
                ]" />
                <set_value name="$MaxOffsetRot" exact="$PlayerShip.assigneddock.maxoffset.{$PlayerShip.docksize}.rotation" />
                <set_value name="$MaxOffsetPos" exact="$PlayerShip.assigneddock.maxoffset.{$PlayerShip.docksize}.position" />
                <set_value name="$DockTargetPos" exact="$PlayerShip.assigneddock.dockslot.relativeposition.{$PlayerShip.assigneddock}"/>
                <set_value name="$DockTargetRot" exact="$PlayerShip.assigneddock.dockslot.relativerotation.{$PlayerShip.assigneddock}"/>
                <set_value name="$ViewDirectionHintAngle" exact="30deg"/>
              </actions>
              <cues>
                <cue name="Tutorial_Docking_FlyToDock_SpeakFinished">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <set_value name="$FlyToDockSpeakFinished" exact="true"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_Docking_Helper" checkinterval="0.1s">
              <conditions>
                <check_value value="player.isdockuiactive and $FlyToDockSpeakFinished?"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue cue="Tutorial_Docking_Check"/>
              </actions>
              <cues>
                <cue name="Tutorial_Docking_Check" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <debug_text text="'Tutorial_Docking_Check'"/>
                    <!--check orientation first-->
                    <set_value name="$DeltaYaw" exact="$PlayerShip.dockslot.relativerotation.{$PlayerShip.assigneddock}.yaw - $DockTargetRot.yaw" />
                    <set_value name="$DeltaPitch" exact="$PlayerShip.dockslot.relativerotation.{$PlayerShip.assigneddock}.pitch - $DockTargetRot.pitch" />
                    <set_value name="$DeltaRoll" exact="$PlayerShip.dockslot.relativerotation.{$PlayerShip.assigneddock}.roll - $DockTargetRot.roll" />
                    <do_if value="$DeltaYaw lt -$ViewDirectionHintAngle or $DeltaYaw gt $ViewDirectionHintAngle or $DeltaPitch lt -$ViewDirectionHintAngle or $DeltaPitch gt $ViewDirectionHintAngle">
                      <debug_text text="'-> Tutorial_Docking_ViewDirection'"/>
                      <signal_cue cue="Tutorial_Docking_ViewDirection"/>
                    </do_if>
                    <do_elseif value="not $Align_General_UseCase_Triggered?">
                      <debug_text text="'-> Tutorial_Docking_Align_General_UseCase'"/>
                      <set_value name="$Align_General_UseCase_Triggered" exact="true"/>
                      <signal_cue cue="Tutorial_Docking_Align_General_UseCase"/>
                    </do_elseif>
                    <do_elseif value="$DeltaYaw lt -$MaxOffsetRot.yaw or $DeltaYaw gt $MaxOffsetRot.yaw or $DeltaPitch lt -$MaxOffsetRot.pitch or $DeltaPitch gt $MaxOffsetRot.pitch">
                      <debug_text text="'-> Tutorial_Docking_YawAndPitch'"/>
                      <signal_cue cue="Tutorial_Docking_YawAndPitch"/>
                    </do_elseif>
                    <do_elseif value="$DeltaRoll lt -$MaxOffsetRot.roll or $DeltaRoll gt $MaxOffsetRot.roll">
                      <debug_text text="'-> Tutorial_Docking_Roll'"/>
                      <signal_cue cue="Tutorial_Docking_Roll"/>
                    </do_elseif>
                    <do_elseif value="not $Rotation_OK_UseCases_Triggered?">
                      <debug_text text="'-> Tutorial_Docking_Rotation_OK_UseCase'"/>
                      <set_value name="$Rotation_OK_UseCases_Triggered" exact="true"/>
                      <signal_cue cue="Tutorial_Docking_Rotation_OK_UseCase"/>
                    </do_elseif>
                    <do_else>
                      <debug_text text="'-> else'"/>
                      <!--check x and z positions-->
                      <set_value name="$DeltaX" exact="$PlayerShip.dockslot.relativeposition.{$PlayerShip.assigneddock}.x - $DockTargetPos.x" />
                      <set_value name="$DeltaZ" exact="$PlayerShip.dockslot.relativeposition.{$PlayerShip.assigneddock}.z - $DockTargetPos.z" />
                      <do_if value="$DeltaZ lt -$MaxOffsetPos.z or $DeltaZ gt $MaxOffsetPos.z">
                        <signal_cue cue="Tutorial_Docking_Z"/>
                      </do_if>
                      <do_elseif value="$DeltaX lt -$MaxOffsetPos.x or $DeltaX gt $MaxOffsetPos.x">
                        <signal_cue cue="Tutorial_Docking_X"/>
                      </do_elseif>
                      <do_else>
                        <!--all aligned, touch down-->
                        <signal_cue_instantly cue="SetHintID" param="[27530, 27531]" comment="{1012, 27530} or {1012, 27531}"/>
                        <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                          $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                          $script = [
                                      table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 12018, $comment = 'Now gently move your ship down until the docking computer takes over.' ],
                                    ],
                        ]" />
                      </do_else>
                    </do_else>
                  </actions>
                </cue>

                <cue name="Tutorial_Docking_ViewDirection" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <signal_cue_instantly cue="SetHintID" param="[27506, 27507, 27507]" comment="{1012, 27506} or {1012, 27507}"/>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 12004, $comment = 'Turn your ship in the indicated direction.' ],
                                ],
                      $callbackcue = Tutorial_Docking_ViewDirection_SpeakFinished,
                      $abortcallbackcue = Tutorial_Docking_ViewDirection_SpeakFinished,
                    ]" />
                  </actions>
                  <cues>
                    <cue name="Tutorial_Docking_ViewDirection_SpeakFinished">
                      <conditions>
                        <event_cue_signalled/>
                      </conditions>
                      <cues>
                        <cue name="Tutorial_Docking_ViewDirection_OK" checkinterval="0.1s">
                          <conditions>
                            <set_value name="$DeltaYaw" exact="$PlayerShip.dockslot.relativerotation.{$PlayerShip.assigneddock}.yaw - $DockTargetRot.yaw" />
                            <set_value name="$DeltaPitch" exact="$PlayerShip.dockslot.relativerotation.{$PlayerShip.assigneddock}.pitch - $DockTargetRot.pitch" />
                            <debug_text text="'DeltaYaw' + $DeltaYaw"/>
                            <debug_text text="'DeltaPitch' + $DeltaPitch"/>
                            <check_value value="$DeltaYaw gt -$ViewDirectionHintAngle and $DeltaYaw lt $ViewDirectionHintAngle and $DeltaPitch gt -$ViewDirectionHintAngle and $DeltaPitch lt $ViewDirectionHintAngle"/>
                          </conditions>
                          <actions>
                            <debug_text text="'Tutorial_Docking_ViewDirection_OK -> Tutorial_Docking_Check'"/>
                            <signal_cue cue="Tutorial_Docking_Check"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>

                <cue name="Tutorial_Docking_Align_General_UseCase">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <signal_cue_instantly cue="SetHintID" param="[27509, 27510]" comment="{1012, 27509} or {1012, 27510}"/>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 12005, $comment = 'You should now be able to see an abstract representation of the docking bay, and your position relative to it.' ],
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 12006, $comment = 'Each element must be aligned before you can dock.' ],
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 12007, $comment = 'When aligned, the elements change colour from red to green.' ],
                                ],
                      $callbackcue = Tutorial_Docking_Align_General_SpeakFinished,
                      $abortcallbackcue = Tutorial_Docking_Align_General_SpeakFinished,
                    ]" />
                  </actions>
                  <cues>
                    <cue name="Tutorial_Docking_Align_General_SpeakFinished">
                      <conditions>
                        <event_cue_signalled/>
                      </conditions>
                      <actions>
                        <signal_cue cue="Tutorial_Docking_Check"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="Tutorial_Docking_YawAndPitch" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <signal_cue_instantly cue="SetHintID" param="[27509, 27510]" comment="{1012, 27509} or {1012, 27510}"/>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 12008, $comment = 'I usually align my orientation first. Begin by moving the centre of your cross-hair to the matching element in the docking UI.' ],
                                ],
                      $callbackcue = Tutorial_Docking_YawAndPitch_SpeakFinished,
                      $abortcallbackcue = Tutorial_Docking_YawAndPitch_SpeakFinished,
                    ]" />
                  </actions>
                  <cues>
                    <cue name="Tutorial_Docking_YawAndPitch_SpeakFinished">
                      <conditions>
                        <event_cue_signalled/>
                      </conditions>
                      <cues>
                        <cue name="Tutorial_Docking_YawAndPitch_OK" checkinterval="0.1s">
                          <conditions>
                            <set_value name="$DeltaYaw" exact="$PlayerShip.dockslot.relativerotation.{$PlayerShip.assigneddock}.yaw - $DockTargetRot.yaw" />
                            <set_value name="$DeltaPitch" exact="$PlayerShip.dockslot.relativerotation.{$PlayerShip.assigneddock}.pitch - $DockTargetRot.pitch" />
                            <check_value value="$DeltaYaw gt -$MaxOffsetRot.yaw and $DeltaYaw lt $MaxOffsetRot.yaw and $DeltaPitch gt -$MaxOffsetRot.pitch and $DeltaPitch lt $MaxOffsetRot.pitch"/>
                          </conditions>
                          <actions>
                            <signal_cue cue="Tutorial_Docking_Check"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>

                <cue name="Tutorial_Docking_Roll" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <signal_cue_instantly cue="SetHintID" param="[27513, 27512, 27512]" comment="{1012, 27513} or {1012, 27512}"/>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 12009, $comment = 'Now align your roll axis until it turns green.' ],
                                ],
                      $callbackcue = Tutorial_Docking_Roll_SpeakFinished,
                      $abortcallbackcue = Tutorial_Docking_Roll_SpeakFinished,
                    ]" />
                  </actions>
                  <cues>
                    <cue name="Tutorial_Docking_Roll_SpeakFinished">
                      <conditions>
                        <event_cue_signalled/>
                      </conditions>
                      <cues>
                        <cue name="Tutorial_Docking_Roll_OK" checkinterval="0.1s">
                          <conditions>
                            <set_value name="$DeltaRoll" exact="$PlayerShip.dockslot.relativerotation.{$PlayerShip.assigneddock}.roll - $DockTargetRot.roll" />
                            <check_value value="$DeltaRoll gt -$MaxOffsetRot.roll and $DeltaRoll lt $MaxOffsetRot.roll"/>
                          </conditions>
                          <actions>
                            <signal_cue cue="Tutorial_Docking_Check"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>

                <cue name="Tutorial_Docking_Rotation_OK_UseCase">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 12010, $comment = 'Now that your ship is fully aligned, let go of the steering controls.' ],
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 12011, $comment = 'There’s a triangular element, pointing upwards, that represents your ship’s position over the dock.' ],
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 12012, $comment = 'If it’s darkened, then your ship is outside the displayable area.' ],
                                ],
                      $callbackcue = Tutorial_Docking_Rotation_OK_SpeakFinished,
                      $abortcallbackcue = Tutorial_Docking_Rotation_OK_SpeakFinished,
                    ]" />
                  </actions>
                  <cues>
                    <cue name="Tutorial_Docking_Rotation_OK_SpeakFinished">
                      <conditions>
                        <event_cue_signalled/>
                      </conditions>
                      <actions>
                        <signal_cue cue="Tutorial_Docking_Check"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="Tutorial_Docking_Z" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <do_if value="player.input.ismapped.controller.INPUT_STATE_FULLFORWARD and player.input.ismapped.controller.INPUT_STATE_FULLREVERSE">
                      <signal_cue_instantly cue="SetHintID" param="[27525, 27526, 27529]" comment="{1012, 27525} or {1012, 27526} or {1012, 27529}"/>
                    </do_if>
                    <do_elseif value="player.input.ismapped.controller.INPUT_STATE_FULLFORWARD">
                      <signal_cue_instantly cue="SetHintID" param="[27525, 27527, 27529]" comment="{1012, 27525} or {1012, 27527} or {1012, 27529}"/>
                    </do_elseif>
                    <do_elseif value="player.input.ismapped.controller.INPUT_STATE_FULLREVERSE">
                      <signal_cue_instantly cue="SetHintID" param="[27525, 27528, 27529]" comment="{1012, 27525} or {1012, 27528} or {1012, 27529}"/>
                    </do_elseif>
                    <do_else>
                      <signal_cue_instantly cue="SetHintID" param="[27525, 27529, 27529]" comment="{1012, 27525} or {1012, 27529}"/>
                    </do_else>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = if ($DeltaZ lt 0) then 12013 else 12014, $comment = 'Your ship is currently too far back/ahead. Slowly accelerate forward/decelerate backward, and stop when the horizontal line turns green.' ],
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 12015, $comment = 'If you overshoot, just stop and correct.' ],
                                ],
                      $callbackcue = Tutorial_Docking_Z_SpeakFinished,
                      $abortcallbackcue = Tutorial_Docking_Z_SpeakFinished,
                    ]" />
                  </actions>
                  <cues>
                    <cue name="Tutorial_Docking_Z_SpeakFinished">
                      <conditions>
                        <event_cue_signalled/>
                      </conditions>
                      <cues>
                        <cue name="Tutorial_Docking_Z_OK" checkinterval="0.1s">
                          <conditions>
                            <set_value name="$DeltaZ" exact="$PlayerShip.dockslot.relativeposition.{$PlayerShip.assigneddock}.z - $DockTargetPos.z" />
                            <check_value value="$DeltaZ gt -$MaxOffsetPos.z and $DeltaZ lt $MaxOffsetPos.z"/>
                          </conditions>
                          <actions>
                            <signal_cue cue="Tutorial_Docking_Check"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>

                <cue name="Tutorial_Docking_X" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <signal_cue_instantly cue="SetHintID" param="[27517, 27518]" comment="{1012, 27517} or {1012, 27518}"/>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = if ($DeltaX lt 0) then 12016 else 12017, $comment = 'Your ship is currently too far to the left/right. Move right/left until the remaining lines turn green.' ],
                                ],
                      $callbackcue = Tutorial_Docking_X_SpeakFinished,
                      $abortcallbackcue = Tutorial_Docking_X_SpeakFinished,
                    ]" />
                  </actions>
                  <cues>
                    <cue name="Tutorial_Docking_X_SpeakFinished">
                      <conditions>
                        <event_cue_signalled/>
                      </conditions>
                      <cues>
                        <cue name="Tutorial_Docking_X_OK" checkinterval="0.1s">
                          <conditions>
                            <set_value name="$DeltaX" exact="$PlayerShip.dockslot.relativeposition.{$PlayerShip.assigneddock}.x - $DockTargetPos.x" />
                            <check_value value="$DeltaX gt -$MaxOffsetPos.x and $DeltaX lt $MaxOffsetPos.x"/>
                          </conditions>
                          <actions>
                            <signal_cue cue="Tutorial_Docking_Check"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_Docking_Docked">
              <conditions>
                <event_object_docked group="$PlayerShipGroup"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <cancel_cue cue="Tutorial_Docking_Helper"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 12019, $comment = 'If you can afford them, there are software upgrades that make this process a bit easier.' ],
                            ],
                  $callbackcue = Tutorial_Docking_Done,
                  $abortcallbackcue = Tutorial_Docking_Done,
                ]" />
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
              </actions>
            </cue>

            <cue name="Tutorial_Docking_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Docking"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_UpgradeShip_OpenUpgradeMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <set_object_hull object="$PlayerShip" exact="94"/>
            <add_wares object="$Wharf" ware="ware.energycells" exact="10000"/>
            <add_wares object="$Wharf" ware="ware.shieldcomponents" exact="10"/>
            <add_wares object="$Wharf" ware="ware.engineparts" exact="15"/>
            <add_wares object="$Wharf" ware="ware.hullparts" exact="200"/>
            <add_wares object="$Wharf" ware="ware.antimatterconverters" exact="10"/>
            <add_wares object="$Wharf" ware="ware.advancedcomposites" exact="10"/>
            <add_workforce object="$Wharf" race="race.argon" exact="$Wharf.workforce.{race.argon}.capacity - $Wharf.workforce.{race.argon}.amount"/>
            <show_help_overlay id="'docked_upgrade_repair'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13017, $comment = 'Lets upgrade your ship.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22, $comment = 'Open the highlighted menu.' ],
                        ],
            ]" />
            <signal_cue cue="ShipMenuCallback" comment="signal this cue manually to initialise to correct menu state"/>
            <signal_cue_instantly cue="SetHintID" param="100271" comment="{1012, 100271}"/>
          </actions>
          <cues>
            <cue name="Tutorial_UpgradeShip_OpenUpgradeMenu_Done">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="''"/>
                <check_value value="@event.param3.{4} == 'upgrade'"/>
              </conditions>
              <actions>
                <remove_help_overlay all="true"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13018, $comment = 'Theres a lot here, so lets go through it bit by bit.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13019, $comment = 'Well start on the left side.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13020, $comment = 'The vertical bar of icons shows you the different categories of upgrades you can get.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13021, $comment = 'The engine list is open by default.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13022, $comment = 'They generally come in three basic types.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13098, $comment = 'Combat engines focus on agility and short-term bursts of speed.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13099, $comment = 'Travel engines specialize in, you probably guessed it, optimal performance in Travel mode.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13025, $comment = 'Allround engines try to find a middle ground between these extremes.' ],
                            ],
                  $callbackcue = Tutorial_UpgradeShip_OpenUpgradeMenu_UseCase_Done,
                  $abortcallbackcue = Tutorial_UpgradeShip_OpenUpgradeMenu_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_UpgradeShip_OpenUpgradeMenu_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_UpgradeShip_OpenUpgradeMenu"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_UpgradeShip_Thruster">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13026, $comment = 'Select Thrusters now.' ],
                        ],
            ]" />
            <show_help_overlay id="'shipconfig_leftbar_thruster'" highlightonly="true"/>
            <signal_cue cue="ShowHint_OpenHighlightedMenu"/>
          </actions>
          <cues>
            <cue name="Tutorial_UpgradeShip_Thruster_MenuOpened">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'thruster'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_leftbar_thruster'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13027, $comment = 'These can also have variations, though usually only combat and allround.',
                                      $speakcallbackcue = Tutorial_UpgradeShip_Thruster_Highlight ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13029, $comment = 'Select the All-round Mk1 thruster.(Mk pronounced mark)' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_UpgradeShip_Thruster_Highlight">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <show_help_overlay id="'shipconfig_upgrade_thruster_gen_s_allround_01_mk1_macro'" highlightonly="true"/>
                <signal_cue cue="ShowHint_LoadoutEditor_ChooseEquipment"/>
              </actions>
            </cue>

            <cue name="Tutorial_UpgradeShip_Thruster_Selected" checkinterval="1ms">
              <conditions>
                <check_value value="player.holomap.loadouteditor.loadout.wares.{ware.thruster_gen_s_allround_01_mk1}.exists"/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_UpgradeShip_Thruster_Highlight"/>
                <remove_help_overlay id="'shipconfig_upgrade_thruster_gen_s_allround_01_mk1_macro'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13030, $comment = 'Its actually cheaper than the combat thruster.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13031, $comment = 'This will reduce the final bill.' ],
                            ],
                  $callbackcue = Tutorial_UpgradeShip_Thruster_UseCase_Done,
                  $abortcallbackcue = Tutorial_UpgradeShip_Thruster_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_UpgradeShip_Thruster_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_UpgradeShip_Thruster"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_UpgradeShip_ChangeShield">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13032, $comment = 'Select Shield Generators now.' ],
                        ],
            ]" />
            <show_help_overlay id="'shipconfig_leftbar_shield'" highlightonly="true"/>
            <signal_cue cue="ShowHint_OpenHighlightedMenu"/>
          </actions>
          <cues>
            <cue name="Tutorial_UpgradeShip_ChangeShield_MenuOpened">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'shield'"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <remove_help_overlay id="'shipconfig_leftbar_shield'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13033, $comment = 'Theres a Shield Mk1 installed here.(Mk pronounced mark)',
                                      $speakcallbackcue = Tutorial_UpgradeShip_ChangeShield_HighlightOtherModels ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13034, $comment = 'Select one of the other models.' ],
                            ],
                ]" />
              </actions>
              <cues>
                <cue name="Tutorial_UpgradeShip_ChangeShield_HighlightOtherModels">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <show_help_overlay id="'shipconfig_upgrade_shield_arg_s_standard_01_mk2_macro'" highlightonly="true"/>
                    <show_help_overlay id="'shipconfig_upgrade_shield_arg_s_standard_01_mk3_macro'" highlightonly="true"/>
                    <signal_cue cue="ShowHint_LoadoutEditor_ChooseEquipment"/>
                  </actions>
                </cue>

                <cue name="Tutorial_UpgradeShip_ChangeShield_OtherModelSelected" checkinterval="1ms">
                  <conditions>
                    <check_value value="player.holomap.loadouteditor.loadout.wares.{ware.shield_arg_s_standard_01_mk2}.exists or player.holomap.loadouteditor.loadout.wares.{ware.shield_arg_s_standard_01_mk3}.exists"/>
                  </conditions>
                  <actions>
                    <cancel_cue cue="Tutorial_UpgradeShip_ChangeShield_HighlightOtherModels"/>
                    <remove_help_overlay id="'shipconfig_upgrade_shield_arg_s_standard_01_mk2_macro'"/>
                    <remove_help_overlay id="'shipconfig_upgrade_shield_arg_s_standard_01_mk3_macro'"/>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13035, $comment = 'Now look to the stats shown in the bottom half.' ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13036, $comment = 'The shield capacity as well as the recharge rate went up.' ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13037, $comment = 'Thats why theyre shown in green now.',
                                          $speakcallbackcue = Tutorial_UpgradeShip_ChangeShield_HighlightOriginalModel ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13038, $comment = 'You cant afford an upgrade right now, so go back to the basic one.' ],
                                ],
                    ]" />
                  </actions>
                  <cues>
                    <cue name="Tutorial_UpgradeShip_ChangeShield_HighlightOriginalModel">
                      <conditions>
                        <event_cue_signalled/>
                      </conditions>
                      <actions>
                        <show_help_overlay id="'shipconfig_upgrade_shield_arg_s_standard_01_mk1_macro'" highlightonly="true"/>
                        <signal_cue cue="ShowHint_LoadoutEditor_ChooseEquipment"/>
                      </actions>
                    </cue>

                    <cue name="Tutorial_UpgradeShip_ChangeShield_Reverted" checkinterval="1ms">
                      <conditions>
                        <check_value value="player.holomap.loadouteditor.loadout.wares.{ware.shield_arg_s_standard_01_mk1}.exists and not player.holomap.loadouteditor.loadout.wares.{ware.shield_arg_s_standard_01_mk2}.exists and not player.holomap.loadouteditor.loadout.wares.{ware.shield_arg_s_standard_01_mk3}.exists"/>
                      </conditions>
                      <actions>
                        <cancel_cue cue="Tutorial_UpgradeShip_ChangeShield_HighlightOriginalModel"/>
                        <remove_help_overlay id="'shipconfig_upgrade_shield_arg_s_standard_01_mk1_macro'"/>
                        <signal_cue_instantly cue="ClearHintID"/>
                        <signal_cue cue="Tutorial_UpgradeShip_ChangeShield_Done"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_UpgradeShip_ChangeShield_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_UpgradeShip_ChangeShield"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_UpgradeShip_AddShield">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13039, $comment = 'What you can afford is a second shield generator.(emphasis on can and second)' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13040, $comment = 'Select the second slot at the top.' ],
                        ],
            ]" />
            <show_help_overlay id="'shipconfig_slot_S2'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintID" param="100273" comment="{1012, 100273}"/>
          </actions>
          <cues>
            <cue name="Tutorial_UpgradeShip_AddShield_SecondSlotSelected">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'shipconfig_slot_S2'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_slot_S2'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13041, $comment = 'Now select the Shield Mk1.(Mk pronounced mark)' ],
                            ],
                ]" />
                <show_help_overlay id="'shipconfig_upgrade_shield_arg_s_standard_01_mk1_macro'" highlightonly="true"/>
                <signal_cue cue="ShowHint_LoadoutEditor_ChooseEquipment"/>
              </actions>
            </cue>

            <cue name="Tutorial_UpgradeShip_AddShield_ShieldSelected" checkinterval="1ms">
              <conditions>
                <check_value value="player.holomap.loadouteditor.loadout.wares.list.countof.{ware.shield_arg_s_standard_01_mk1} == 2"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_upgrade_shield_arg_s_standard_01_mk1_macro'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13042, $comment = 'Your shield capacity and recharge rate have doubled.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_UpgradeShip_AddShield"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_UpgradeShip_Weapons">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13043, $comment = 'Select Weapons now.' ],
                        ],
            ]" />
            <show_help_overlay id="'shipconfig_leftbar_weapon'" highlightonly="true"/>
            <signal_cue cue="ShowHint_OpenHighlightedMenu"/>
          </actions>
          <cues>
            <cue name="Tutorial_UpgradeShip_Weapons_MenuOpened">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'weapon'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_leftbar_weapon'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13044, $comment = 'Youre not allowed to buy most of these yet.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13045, $comment = 'Thats because you need a special licence for proper military equipment, which a faction gives you once you gain a rank.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13046, $comment = 'Theres another lesson that explains how that works.',
                                      $speakcallbackcue = Tutorial_UpgradeShip_Weapons_Highlight ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13047, $comment = 'For now simply select any of the weapons shown in white.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_UpgradeShip_Weapons_Highlight">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <show_help_overlay id="'shipconfig_upgrade_weapon_gen_s_laser_01_mk1_macro'" highlightonly="true"/>
                <show_help_overlay id="'shipconfig_upgrade_weapon_gen_s_laser_01_mk2_macro'" highlightonly="true"/>
                <signal_cue cue="ShowHint_LoadoutEditor_ChooseEquipment"/>
              </actions>
            </cue>

            <cue name="Tutorial_UpgradeShip_Weapons_WeaponSelected" checkinterval="1ms">
              <conditions>
                <check_value value="player.holomap.loadouteditor.loadout.wares.{ware.weapon_gen_s_laser_01_mk1}.exists or player.holomap.loadouteditor.loadout.wares.{ware.weapon_gen_s_laser_01_mk2}.exists"/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_UpgradeShip_Weapons_Highlight"/>
                <remove_help_overlay id="'shipconfig_upgrade_weapon_gen_s_laser_01_mk1_macro'"/>
                <remove_help_overlay id="'shipconfig_upgrade_weapon_gen_s_laser_01_mk2_macro'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13048, $comment = 'The stats at the bottom have changed again.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13049, $comment = 'The two values are burst and sustained damage output.(put a little emphasis on burst and sustained - damage output belongs to both)' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13050, $comment = 'The difference between these two is that the former ignores heat, while the latter takes it into account.',
                                      $speakcallbackcue = Tutorial_UpgradeShip_Weapons_RemoveWeapon_Highlight ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13051, $comment = 'Unfortunately these are a bit too expensive right now, so select the empty slot option again.' ],
                            ],
                ]" />
              </actions>
              <cues>
                <cue name="Tutorial_UpgradeShip_Weapons_RemoveWeapon_Highlight">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <show_help_overlay id="'shipconfig_upgrade_empty'" highlightonly="true"/>
                    <signal_cue_instantly cue="SetHintID" param="100274" comment="{1012, 100274}"/>
                  </actions>
                </cue>

                <cue name="Tutorial_UpgradeShip_Weapons_WeaponRemoved" checkinterval="1ms">
                  <conditions>
                    <check_value value="not player.holomap.loadouteditor.loadout.wares.{ware.weapon_gen_s_laser_01_mk1}.exists and not player.holomap.loadouteditor.loadout.wares.{ware.weapon_gen_s_laser_01_mk2}.exists"/>
                  </conditions>
                  <actions>
                    <cancel_cue cue="Tutorial_UpgradeShip_Weapons_RemoveWeapon_Highlight"/>
                    <remove_help_overlay id="'shipconfig_upgrade_empty'"/>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <signal_cue cue="Tutorial_UpgradeShip_Weapons_Done"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_UpgradeShip_Weapons_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_UpgradeShip_Weapons"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_UpgradeShip_Software">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13052, $comment = 'In addition to hardware you can also install software.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22, $comment = 'Open the highlighted menu.' ],
                        ],
            ]" />
            <show_help_overlay id="'shipconfig_leftbar_software'" highlightonly="true"/>
          </actions>
          <cues>
            <cue name="Tutorial_UpgradeShip_Software_MenuOpened">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'software'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_leftbar_software'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13053, $comment = 'Some of these are mandatory in almost all ships, like the flight assist software.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13054, $comment = 'But there are always optional additions and upgrades you can buy.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13055, $comment = 'The docking computer is quite popular, for example.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13056, $comment = 'You can afford the basic one.',
                                      $speakcallbackcue = Tutorial_UpgradeShip_Software_Highlight ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13057, $comment = 'Select it.(it is a docking computer software)' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_UpgradeShip_Software_Highlight">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <show_help_overlay id="'shipconfig_software_software_dockmk1'" highlightonly="true"/>
                <signal_cue_instantly cue="SetHintID" param="100275" comment="{1012, 100275}"/>
              </actions>
            </cue>

            <cue name="Tutorial_UpgradeShip_Software_Done">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'software_added'"/>
                <check_value value="event.param3 == 'software_dockmk1'"/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_UpgradeShip_Software_Highlight"/>
                <remove_help_overlay id="'shipconfig_software_software_dockmk1'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_UpgradeShip_Software"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_UpgradeShip_Repair">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13058, $comment = 'This ship has some light hull damage.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13059, $comment = 'Open the Repair menu.' ],
                        ],
            ]" />
            <show_help_overlay id="'shipconfig_leftbar_repair'" highlightonly="true"/>
            <signal_cue cue="ShowHint_OpenHighlightedMenu"/>
          </actions>
          <cues>
            <cue name="Tutorial_UpgradeShip_Repair_MenuOpened">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'repair'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_leftbar_repair'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13060, $comment = 'Select the item to repair your ships hull.' ],
                            ],
                ]" />
                <show_help_overlay id="'shipconfig_repair_' + player.ship.macro.id" highlightonly="true"/>
                <signal_cue_instantly cue="SetHintID" param="100276" comment="{1012, 100276}"/>
              </actions>
            </cue>

            <cue name="Tutorial_UpgradeShip_Repair_Done">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'shipconfig_repair'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_repair_' + player.ship.macro.id"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 33, $comment = 'There we go.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_UpgradeShip_Repair"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_UpgradeShip_Confirm">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13061, $comment = 'You can review all the changes youve made on the right-hand side.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13062, $comment = 'Additions are green, removals are red.',
                                  $speakcallbackcue = Tutorial_UpgradeShip_Confirm_AddToShoppingList_Highlight ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13063, $comment = 'Before confirming the order you need to add your changes to the shopping list, using the highlighted button.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_UpgradeShip_Confirm_AddToShoppingList_Highlight">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <show_help_overlay id="'shipconfig_addtoshoppinglist'" highlightonly="true"/>
                <signal_cue_instantly cue="SetHintID" param="100277" comment="{1012, 100277}"/>
              </actions>
            </cue>

            <cue name="Tutorial_UpgradeShip_Confirm_AddedToShoppingList">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'shipconfig_addtoshoppinglist'"/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_UpgradeShip_Confirm_AddToShoppingList_Highlight"/>
                <remove_help_overlay id="'shipconfig_addtoshoppinglist'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13064, $comment = 'Finally, confirm the order with the highlighted button in the bottom right.' ],
                            ],
                ]" />
                <show_help_overlay id="'shipconfig_confirm'" highlightonly="true"/>
                <signal_cue_instantly cue="SetHintID" param="100262" comment="{1012, 100262}"/>
              </actions>
            </cue>

            <cue name="Tutorial_UpgradeShip_Confirm_Done">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'shipconfig_confirm'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_confirm'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13011, $comment = 'Your upgrades are now being installed. This will take a few minutes.' ],
                            ],
                  $callbackcue = Tutorial_UpgradeShip_Confirm_UseCase_Done,
                  $abortcallbackcue = Tutorial_UpgradeShip_Confirm_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_UpgradeShip_Confirm_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_UpgradeShip_Confirm"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuyShip">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <transfer_money from="$AlliedFaction" to="faction.player" amount="1000000Cr"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13065, $comment = 'While we wait, lets try buying a completely new ship.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22, $comment = 'Open the highlighted menu.' ],
                        ],
            ]" />
            <show_help_overlay id="'docked_buyships'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintID" param="100278" comment="{1012, 100278}"/>
            <signal_cue_instantly cue="SetHintPosition" param="4"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuyShip_MenuOpened">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="''"/>
                <check_value value="@event.param3.{4} == 'purchase'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13066, $comment = 'First you need to select the size of ship you want to buy.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13067, $comment = 'This is a wharf, which sells small and medium-sized ships.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13068, $comment = 'For larger ships you need to visit a shipyard.',
                                      $speakcallbackcue = Tutorial_BuyShip_SizeSelection_Highlight ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13069, $comment = 'Select Size M in the highlighted list.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_BuyShip_SizeSelection_Highlight">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <show_help_overlay id="'shipconfig_classoptions'" highlightonly="true"/>
                <show_help_overlay id="'shipconfig_classoptions_ship_m'" highlightonly="true"/>
                <signal_cue_instantly cue="SetHintID" param="100279" comment="{1012, 100279}"/>
                <signal_cue_instantly cue="SetHintPosition" param="4"/>
              </actions>
            </cue>

            <cue name="Tutorial_BuyShip_SizeSelected">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'shipclass_selected'"/>
                <check_value value="event.param3 == 'ship_m'"/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_BuyShip_SizeSelection_Highlight"/>
                <remove_help_overlay id="'shipconfig_classoptions'"/>
                <remove_help_overlay id="'shipconfig_classoptions_ship_m'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13070, $comment = 'Now select Mercury Vanguard in the list next to it.' ],
                            ],
                ]" />
                <show_help_overlay id="'shipconfig_shipoptions'" highlightonly="true"/>
                <show_help_overlay id="'shipconfig_shipoptions_ship_arg_m_trans_container_01_a_macro'" highlightonly="true"/>
                <signal_cue_instantly cue="SetHintID" param="100280" comment="{1012, 100280}"/>
                <signal_cue_instantly cue="SetHintPosition" param="4"/>
              </actions>
            </cue>

            <cue name="Tutorial_BuyShip_Done">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'shipmacro_selected'"/>
                <check_value value="event.param3 == 'ship_arg_m_trans_container_01_a_macro'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_shipoptions'"/>
                <remove_help_overlay id="'shipconfig_shipoptions_ship_arg_m_trans_container_01_a_macro'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="SetHintPosition" param="1"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuyShip"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuyShip_MandatoryUpgrades">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13071, $comment = 'You can see that some of the icons on the left side are now red.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13072, $comment = 'Thats because some upgrades are mandatory.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13073, $comment = 'Cant have a functional ship without an engine, can you?' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13074, $comment = 'Select the Travel Mk1 engine, as well as the other highlighted upgrades.' ],
                        ],
            ]" />
            <!--highlight all mandatory upgrades (except pilot)-->
            <set_value name="$MandatoryUpgradeOverlayIDs" exact="['shipconfig_upgrade_engine_arg_m_travel_01_mk1_macro',
                                                                  'shipconfig_upgrade_thruster_gen_m_allround_01_mk1_macro',
                                                                  'shipconfig_software_software_flightassistmk1',
                                                                  'shipconfig_software_software_scannerlongrangemk1',
                                                                  'shipconfig_software_software_scannerobjectmk1',
                                                                  'shipconfig_software_software_trademk1']"/>
            <create_list name="$InstalledMandatoryUpgradeOverlayIDs"/>
            <signal_cue cue="Tutorial_BuyShip_MandatoryUpgrades_UpdateOverlayIDs"/>
            <signal_cue_instantly cue="SetHintID" param="100281" comment="{1012, 100281}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuyShip_MandatoryUpgrades_UpdateOverlayIDs" instantiate="true">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_value name="$allsoftwareinstalled" exact="true"/>
                <do_for_each name="$overlayid" in="$MandatoryUpgradeOverlayIDs">
                  <do_if value="$InstalledMandatoryUpgradeOverlayIDs.indexof.{$overlayid}">
                    <remove_help_overlay id="$overlayid"/>
                  </do_if>
                  <do_else>
                    <show_help_overlay id="$overlayid" highlightonly="true"/>
                    <do_if value="$overlayid != 'shipconfig_upgrade_engine_arg_m_travel_01_mk1_macro' and $overlayid != 'shipconfig_upgrade_thruster_gen_m_allround_01_mk1_macro'">
                      <set_value name="$allsoftwareinstalled" exact="false"/>
                    </do_if>
                  </do_else>
                </do_for_each>
                <do_if value="$InstalledMandatoryUpgradeOverlayIDs.indexof.{'shipconfig_upgrade_engine_arg_m_travel_01_mk1_macro'}">
                  <debug_text text="'engine installed'"/>
                  <remove_help_overlay id="'shipconfig_leftbar_engine'"/>
                </do_if>
                <do_else>
                  <debug_text text="'engine not installed'"/>
                  <show_help_overlay id="'shipconfig_leftbar_engine'" highlightonly="true"/>
                </do_else>
                <do_if value="$InstalledMandatoryUpgradeOverlayIDs.indexof.{'shipconfig_upgrade_thruster_gen_m_allround_01_mk1_macro'}">
                  <debug_text text="'thruster installed'"/>
                  <remove_help_overlay id="'shipconfig_leftbar_thruster'"/>
                </do_if>
                <do_else>
                  <debug_text text="'thruster not installed'"/>
                  <show_help_overlay id="'shipconfig_leftbar_thruster'" highlightonly="true"/>
                </do_else>
                <do_if value="$allsoftwareinstalled">
                  <debug_text text="'software installed'"/>
                  <remove_help_overlay id="'shipconfig_leftbar_software'"/>
                </do_if>
                <do_else>
                  <debug_text text="'software not installed'"/>
                  <show_help_overlay id="'shipconfig_leftbar_software'" highlightonly="true"/>
                </do_else>
              </actions>
            </cue>

            <cue name="Tutorial_BuyShip_MandatoryUpgrades_LoadoutCheck">
              <delay exact="1ms"/>
              <actions>
                <!--Engine:-->
                <set_value name="$overlayid" exact="'shipconfig_upgrade_engine_arg_m_travel_01_mk1_macro'"/>
                <set_value name="$installed" exact="player.holomap.loadouteditor.loadout.wares.{ware.engine_arg_m_travel_01_mk1}.exists"/>
                <do_if value="($InstalledMandatoryUpgradeOverlayIDs.indexof.{$overlayid} != 0) != $installed">
                  <do_if value="$InstalledMandatoryUpgradeOverlayIDs.indexof.{$overlayid}">
                    <debug_text text="'removed ' + $overlayid"/>
                    <remove_from_list name="$InstalledMandatoryUpgradeOverlayIDs" exact="$overlayid"/>
                  </do_if>
                  <do_else>
                    <debug_text text="'added ' + $overlayid"/>
                    <append_to_list name="$InstalledMandatoryUpgradeOverlayIDs" exact="$overlayid"/>
                  </do_else>
                  <signal_cue cue="Tutorial_BuyShip_MandatoryUpgrades_UpdateOverlayIDs"/>
                </do_if>
                <!--Thruster:-->
                <set_value name="$overlayid" exact="'shipconfig_upgrade_thruster_gen_m_allround_01_mk1_macro'"/>
                <set_value name="$installed" exact="player.holomap.loadouteditor.loadout.wares.{ware.thruster_gen_m_allround_01_mk1}.exists"/>
                <do_if value="($InstalledMandatoryUpgradeOverlayIDs.indexof.{$overlayid} != 0) != $installed">
                  <do_if value="$InstalledMandatoryUpgradeOverlayIDs.indexof.{$overlayid}">
                    <debug_text text="'removed ' + $overlayid"/>
                    <remove_from_list name="$InstalledMandatoryUpgradeOverlayIDs" exact="$overlayid"/>
                  </do_if>
                  <do_else>
                    <debug_text text="'added ' + $overlayid"/>
                    <append_to_list name="$InstalledMandatoryUpgradeOverlayIDs" exact="$overlayid"/>
                  </do_else>
                  <signal_cue cue="Tutorial_BuyShip_MandatoryUpgrades_UpdateOverlayIDs"/>
                </do_if>
                <reset_cue cue="this"/>
              </actions>
            </cue>

            <cue name="Tutorial_BuyShip_MandatoryUpgrades_SoftwareAdded" instantiate="true">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'software_added'"/>
                <debug_text text="event.param3"/>
              </conditions>
              <actions>
                <set_value name="$overlayid" exact="'shipconfig_software_' + event.param3"/>
                <debug_text text="$overlayid"/>
                <do_if value="$MandatoryUpgradeOverlayIDs.indexof.{$overlayid}">
                  <append_to_list name="$InstalledMandatoryUpgradeOverlayIDs" exact="$overlayid"/>
                </do_if>
                <signal_cue cue="Tutorial_BuyShip_MandatoryUpgrades_UpdateOverlayIDs"/>
              </actions>
            </cue>

            <cue name="Tutorial_BuyShip_MandatoryUpgrades_SoftwareRemoved" instantiate="true">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'software_removed'"/>
                <debug_text text="event.param3"/>
              </conditions>
              <actions>
                <set_value name="$overlayid" exact="'shipconfig_software_' + event.param3"/>
                <debug_text text="$overlayid"/>
                <do_if value="$MandatoryUpgradeOverlayIDs.indexof.{$overlayid}">
                  <remove_from_list name="$InstalledMandatoryUpgradeOverlayIDs" exact="$overlayid"/>
                </do_if>
                <signal_cue cue="Tutorial_BuyShip_MandatoryUpgrades_UpdateOverlayIDs"/>
              </actions>
            </cue>

            <cue name="Tutorial_BuyShip_MandatoryUpgrades_Done" checkinterval="1ms">
              <conditions>
                <check_value value="$InstalledMandatoryUpgradeOverlayIDs? and $MandatoryUpgradeOverlayIDs? and $InstalledMandatoryUpgradeOverlayIDs.count == $MandatoryUpgradeOverlayIDs.count"/>
              </conditions>
              <actions>
                <do_for_each name="$overlayid" in="$MandatoryUpgradeOverlayIDs">
                  <remove_help_overlay id="$overlayid"/>
                </do_for_each>
                <remove_help_overlay id="'shipconfig_leftbar_engine'"/>
                <remove_help_overlay id="'shipconfig_leftbar_thruster'"/>
                <remove_help_overlay id="'shipconfig_leftbar_software'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuyShip_MandatoryUpgrades"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuyShip_Consumables">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13075, $comment = 'Now open the Consumables menu.' ],
                        ],
            ]" />
            <show_help_overlay id="'shipconfig_leftbar_consumables'" highlightonly="true"/>
            <signal_cue cue="ShowHint_OpenHighlightedMenu"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuyShip_Consumables_MenuOpened">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'consumables'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_leftbar_consumables'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13076, $comment = 'Here you can buy - or sell - a wide variety of deployables.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13077, $comment = 'Their use is covered in a different lesson.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13078, $comment = 'This is also where you would buy missiles, if you had a launcher installed.',
                                      $speakcallbackcue = Tutorial_BuyShip_Consumables_Highlight ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13079, $comment = 'For now, buy the maximum amount of flares, which are used to defend against most types of guided missile.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_BuyShip_Consumables_Highlight">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <show_help_overlay id="'shipconfig_ammo_countermeasure_flares_01_macro'" highlightonly="true"/>
                <signal_cue_instantly cue="SetHintID" param="100282" comment="{1012, 100282}"/>
              </actions>
            </cue>

            <cue name="Tutorial_BuyShip_Consumables_Done">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'ammo_changed'"/>
                <check_value value="event.param3 gt 0"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_ammo_countermeasure_flares_01_macro'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuyShip_Consumables"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuyShip_Captain">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13080, $comment = 'Now open the Crew menu.' ],
                        ],
            ]" />
            <show_help_overlay id="'shipconfig_leftbar_crew'" highlightonly="true"/>
            <signal_cue cue="ShowHint_OpenHighlightedMenu"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuyShip_Captain_MenuOpened">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'crew'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_leftbar_crew'"/>
                <do_if value="$ShipConfigurationMenu_CaptainHired?">
                  <signal_cue cue="Tutorial_BuyShip_Captain_Done"/>
                </do_if>
                <do_else>
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13081, $comment = 'Its mandatory to hire a pilot when ordering a ship.' ],
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 15, $comment = 'Do so now.' ],
                              ],
                  ]" />
                  <show_help_overlay id="'shipconfig_crew_captain'" highlightonly="true"/>
                  <signal_cue_instantly cue="SetHintID" param="100283" comment="{1012, 100283}"/>
                </do_else>
              </actions>
            </cue>

            <cue name="Tutorial_BuyShip_Captain_Done">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'ShipConfigurationMenu'" control="'shipconfig_crew_captain'"/>
                </check_any>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_crew_captain'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuyShip_Captain"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuyShip_Crew">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13082, $comment = 'Service crew helps operate and maintain a ship.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13083, $comment = 'Hire the maximum amount by dragging the slider all the way to the right.' ],
                        ],
            ]" />
            <show_help_overlay id="'shipconfig_crew_service'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintID" param="100284" comment="{1012, 100284}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuyShip_Crew_Done">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'crew_added'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_crew_service'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuyShip_Crew"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuyShip_SaveLoadout">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13084, $comment = 'I find it useful to save ship loadouts for future use.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13085, $comment = 'Do so using the highlighted button.' ],
                        ],
            ]" />
            <show_help_overlay id="'shipconfig_saveloadout'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintID" param="100285" comment="{1012, 100285}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuyShip_SaveLoadout_ButtonPressed">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'shipconfig_saveloadout'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_saveloadout'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13086, $comment = 'Now give the loadout a name and select Save as New.' ],
                            ],
                ]" />
                <show_help_overlay id="'shipconfig_saveloadout_saveasnew'" highlightonly="true"/>
                <signal_cue_instantly cue="SetHintID" param="100286" comment="{1012, 100286}"/>
              </actions>
            </cue>

            <cue name="Tutorial_BuyShip_SaveLoadout_Done">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'ShipConfigurationMenu'" control="'shipconfig_saveloadout_saveasnew'"/>
                  <event_ui_triggered screen="'ShipConfigurationMenu'" control="'shipconfig_saveloadout_overwrite'"/>
                </check_any>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_saveloadout_saveasnew'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13087, $comment = 'There we go, it has been saved and can be selected from the list whenever youre outfitting a ship of this type.' ],
                            ],
                  $callbackcue = Tutorial_BuyShip_SaveLoadout_UseCase_Done,
                  $abortcallbackcue = Tutorial_BuyShip_SaveLoadout_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_BuyShip_SaveLoadout_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuyShip_SaveLoadout"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuyShip_AddToShoppingList">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13088, $comment = 'To order this one first add it to the shopping list.' ],
                        ],
            ]" />
            <show_help_overlay id="'shipconfig_addtoshoppinglist'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintID" param="100287" comment="{1012, 100287}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuyShip_AddToShoppingList_Done">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'shipconfig_addtoshoppinglist'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_addtoshoppinglist'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuyShip_AddToShoppingList"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuyShip_ChangeShoppingListAmount">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13089, $comment = 'You can change the amount for convenient mass-ordering of ships.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13090, $comment = 'Ive given you enough Credits to buy two of these, so set it to that amount now.' ],
                        ],
            ]" />
            <show_help_overlay id="'shipconfig_purchaseamount'" highlightonly="true"/>
            <show_help_overlay id="'shipconfig_purchaseamount_2'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintID" param="100288" comment="{1012, 100288}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuyShip_ChangeShoppingListAmount_Done">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'shipconfig_purchaseamount'"/>
                <check_value value="event.param3 == 2"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_purchaseamount'"/>
                <remove_help_overlay id="'shipconfig_purchaseamount_2'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuyShip_ChangeShoppingListAmount"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuyShip_Confirm">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13091, $comment = 'Take note of the lower right corner.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13092, $comment = 'There is a warning now that some resources are missing.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13093, $comment = 'It wasnt shown when you ordered only one ship, so the station is able to begin construction of one right away.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13094, $comment = 'But it needs to wait for delivery of additional resources in order to build the second one.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13095, $comment = 'You can expedite this process by delivering the missing resources yourself, something that the ship youre ordering will be perfectly suited for.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13096, $comment = 'How to do that will be covered in another lesson.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 13097, $comment = 'Confirm the order to complete this tutorial.' ],
                        ],
            ]" />
            <show_help_overlay id="'shipconfig_confirm'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintID" param="100267" comment="{1012, 100267}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuyShip_Confirm_Done">
              <conditions>
                <event_ui_triggered screen="'ShipConfigurationMenu'" control="'shipconfig_confirm'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'shipconfig_confirm'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuyShip_Confirm"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_AdaptiveSteering">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 14001, $comment = 'Now here’s a little thing that many pilots don’t use, but if you do end up liking it you’ll really appreciate it.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 14002, $comment = 'Depending on how you’ve set up your flight controls, you might only have convenient control over two steering axes, rather than all three.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 14003, $comment = 'This is fine for most pilots. However, with many ship configurations, rolling is much more effective than yawing, or vice versa.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 14004, $comment = 'This is where adaptive steering can help.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 14005, $comment = 'When turned on, the primary steering axis will be set to whichever one is the best for your current ship configuration.',
                                 $speakcallbackcue = Tutorial_AdaptiveSteering_ForceAdaptiveSteering],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 14006, $comment = 'I’ve turned on adaptive steering and changed the thruster configuration of your ship to favour roll over yaw.' ],
                          table[ $actor = '$FlightInstructor', $recipient = 'player', $speak = 14007, $comment = 'Fly around a little to get a feeling for it.' ],
                        ],
              $callbackcue = Tutorial_AdaptiveSteering_Done,
              $abortcallbackcue = Tutorial_AdaptiveSteering_Done,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_AdaptiveSteering_ForceAdaptiveSteering">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_value name="$AdaptiveSteeringDuration" exact="30s"/>
                <generate_loadout macro="$PlayerShip.macro" macros="[macro.thruster_gen_s_combat_01_mk1_macro]" result="$Loadouts" flags="thrusters"/>
                <apply_loadout object="$PlayerShip" flags="thrusters" loadout="$Loadouts.{1}"/>
                <set_adaptive_steering_forced/>
              </actions>
            </cue>

            <cue name="Tutorial_AdaptiveSteering_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_AdaptiveSteering"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_AdaptiveSteering_SettingQuestion">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <reset_adaptive_steering/>
            <do_if value="player.input.controller or player.input.joystick">
              <do_if value="player.input.adaptivesticksteering">
                <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ 'Input Profile', {30178,1114}, [ 'adaptivesticksteering_on', {30178,1121}, false ], [ 'adaptivesticksteering_off', {30178,1122} ], 'stick_steering_adaptive', 'right' ]]"/>
              </do_if>
              <do_else>
                <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ 'Input Profile', {30178,1115}, [ 'adaptivesticksteering_on', {30178,1120}, true ], [ 'adaptivesticksteering_off', {30178,1122} ], 'stick_steering_adaptive', 'right' ]]"/>
              </do_else>
            </do_if>
            <do_else>
              <do_if value="player.input.adaptivemousesteering">
                <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ 'Input Profile', {30178,1116}, [ 'adaptivemousesteering_on', {30178,1121}, false ], [ 'adaptivemousesteering_off', {30178,1122} ], 'mouse_steering_adaptive', 'right' ]]"/>
              </do_if>
              <do_else>
                <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ 'Input Profile', {30178,1117}, [ 'adaptivemousesteering_on', {30178,1120}, true ], [ 'adaptivemousesteering_off', {30178,1122} ], 'mouse_steering_adaptive', 'right' ]]"/>
              </do_else>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_AdaptiveSteering_SettingQuestion_AnsweredOrClosed">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'UserQuestionMenu'" control="'selected'"/>
                  <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_AdaptiveSteering_SettingQuestion"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Deploy_Intro">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <create_group groupname="$DeployedSatelliteGroup"/>
            <add_ammo object="$PlayerShip" macro="macro.eq_arg_satellite_01_macro" amount="1"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19001, $comment = 'Most ships are able to carry and deploy certain small objects.' ],
                        ],
              $callbackcue = Tutorial_Deploy_Intro_Done,
              $abortcallbackcue = Tutorial_Deploy_Intro_Done,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Deploy_SatelliteDeployed">
              <conditions>
                <event_object_launched_satellite group="$PlayerShipGroup"/>
              </conditions>
              <actions>
                <add_to_group groupname="$DeployedSatelliteGroup" object="event.param"/>
                <set_object_min_hull object="event.param" exact="100"/>
                <signal_cue cue="Tutorial_Deploy_DeploySatellite_Deployed" check="false"/>
              </actions>
            </cue>

            <cue name="Tutorial_Deploy_Intro_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <!--don't cancel the parent cue - we want to keep the other child cue running-->
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Deploy_OpenShipMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <set_objective cue="GameStart_Tutorial" action="objective.deploy" text="{20201,20301}"/>
            <do_if value="$ShipMenuOpen?">
              <signal_cue cue="Tutorial_Deploy_ShipMenuOpened"/>
            </do_if>
            <do_else>
              <signal_cue cue="ShowHint_OpenShipMenu"/>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =  8020, $comment = 'Open the Ship Menu.' ],
                          ],
              ]" />
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_Deploy_ShipMenuOpened">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'DockedMenu'" control="''"/>
                </check_any>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Deploy_OpenShipMenu"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Deploy_DeploySatellite">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <show_help_overlay id="'docked_deploy_civ'" highlightonly="true"/>
            <show_help_overlay id="'docked_deploy_civ_dropdown_satellite'" highlightonly="true"/>
            <do_if value="$DeployedSatelliteGroup.count ge 1">
              <signal_cue cue="Tutorial_Deploy_DeploySatellite_Deployed"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19003, $comment = 'Select the option to deploy a civilian object.' ],
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19004, $comment = 'Then select the satellite.' ],
                          ],
              ]" />
              <signal_cue_instantly cue="SetHintID" param="100215" comment="{1012, 100215}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_Deploy_DeploySatellite_Deployed">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_object_launched_satellite group="$PlayerShipGroup"/>
                </check_any>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <remove_help_overlay id="'docked_deploy_civ'"/>
                <remove_help_overlay id="'docked_deploy_civ_dropdown_satellite'"/>
                <do_if value="event.name == 'event_object_launched_satellite'">
                  <add_to_group groupname="$DeployedSatelliteGroup" object="event.param"/>
                </do_if>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <do_if value="$ShipMenuOpen?">
                  <signal_cue cue="ShowHint_CloseMenus"/>
                </do_if>
                <do_else>
                  <cancel_cue cue="Tutorial_Deploy_DeploySatellite_ShipMenuClosed"/>
                </do_else>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19005, $comment = 'The satellite has been successfully deployed.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19006, $comment = 'Its now sending its gravidar data to you, so youll be able to observe this space on the map remotely.' ],
                            ],
                  $callbackcue = Tutorial_Deploy_DeploySatellite_Deployed_UseCase_Done,
                  $abortcallbackcue = Tutorial_Deploy_DeploySatellite_Deployed_UseCase_Done,
                ]" />
              </actions>
              <cues>
                <cue name="Tutorial_Deploy_DeploySatellite_ShipMenuClosed">
                  <conditions>
                    <event_ui_triggered screen="'DockedMenu'" control="'menu_close'"/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                  </actions>
                </cue>

                <cue name="Tutorial_Deploy_DeploySatellite_Deployed_UseCase_Done">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <signal_cue cue="Tutorial_TriggerNext"/>
                    <cancel_cue cue="Tutorial_Deploy_DeploySatellite"/>
                  </actions>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Deploy_SelectSatellite">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="$DeployedSatelliteGroup.count ge 1">
              <set_objective cue="GameStart_Tutorial" action="objective.collect" group="$DeployedSatelliteGroup"/>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19007, $comment = 'You can also pick it back up.' ],
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19008, $comment = 'Select the satellite as your target.' ],
                          ],
              ]" />
              <signal_cue cue="ShowHint_SelectObject"/>
            </do_if>
          </actions>
          <cues>
            <cue name="Tutorial_Deploy_SelectSatellite_Selected" checkinterval="1ms">
              <conditions>
                <check_value value="$DeployedSatelliteGroup.count == 0 or @player.target.isclass.satellite"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Deploy_SelectSatellite"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Deploy_DeactivateSatellite">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="$DeployedSatelliteGroup.count ge 1 and $DeployedSatelliteGroup.{1}.isactive">
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19009, $comment = 'Interact with it and select the deactivate option.' ],
                          ],
              ]" />
              <signal_cue_instantly cue="SetHintID" param="[100211, 100212]" comment="{1012,100211} or {1012,100212}"/>
            </do_if>
          </actions>
          <cues>
            <cue name="Tutorial_Deploy_DeactivateSatellite_Deactivated" checkinterval="1ms">
              <conditions>
                <check_value value="$DeployedSatelliteGroup.count == 0 or not $DeployedSatelliteGroup.{1}.isactive"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Deploy_DeactivateSatellite"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Deploy_CollectSatellite">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="$DeployedSatelliteGroup.count == 0">
              <signal_cue cue="Tutorial_Deploy_CollectSatellite_Collected"/>
            </do_if>
            <do_else>
              <signal_cue cue="ShowHint_CollectItemInSpace"/>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19010, $comment = 'Now simply fly your ship over it.' ],
                          ],
              ]" />
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_Deploy_CollectSatellite_Collected">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_player_collected_ammo/>
                </check_any>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19011, $comment = 'Its back in your storage and can be deployed again.' ],
                            ],
                  $callbackcue = Tutorial_Deploy_SatelliteCollected_UseCase_Done,
                  $abortcallbackcue = Tutorial_Deploy_SatelliteCollected_UseCase_Done,
                ]" />
              </actions>
              <cues>
                <cue name="Tutorial_Deploy_SatelliteCollected_UseCase_Done">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue cue="Tutorial_TriggerNext"/>
                    <cancel_cue cue="Tutorial_Deploy_CollectSatellite"/>
                  </actions>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Deploy_NavBeacons_UseCase">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19012, $comment = 'Navigation beacons are a cheap way of marking a location.' ],
                        ],
              $callbackcue = Tutorial_Deploy_NavBeacons_UseCase_Done,
              $abortcallbackcue = Tutorial_Deploy_NavBeacons_UseCase_Done,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Deploy_NavBeacons_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Deploy_NavBeacons_UseCase"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Deploy_ResourceProbes_UseCase">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19002, $comment = 'Resource probes help with mining, well cover them in another lesson.' ],
                        ],
              $callbackcue = Tutorial_Deploy_ResourceProbes_UseCase_Done,
              $abortcallbackcue = Tutorial_Deploy_ResourceProbes_UseCase_Done,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Deploy_ResourceProbes_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Deploy_ResourceProbes_UseCase"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Deploy_Mine">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <add_ammo object="$PlayerShip" macro="macro.weapon_gen_mine_01_macro" amount="1"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19013, $comment = 'Ive unlocked military deployables.',
                                  $speakcallbackcue = Tutorial_Deploy_Mine_Objective],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19014, $comment = 'Deploy the mine.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Deploy_Mine_Objective">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <do_if value="$ShipMenuOpen?">
                  <signal_cue cue="Tutorial_Deploy_Mine_ShipMenuOpened"/>
                </do_if>
                <do_else>
                  <signal_cue cue="ShowHint_OpenShipMenu"/>
                </do_else>
                <show_help_overlay id="'docked_deploy_mil'" highlightonly="true"/>
                <show_help_overlay id="'docked_deploy_mil_dropdown_mine'" highlightonly="true"/>
                <set_objective cue="GameStart_Tutorial" action="objective.deploy" text="{20201,20201}"/>
              </actions>
            </cue>

            <cue name="Tutorial_Deploy_Mine_ShipMenuOpened">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'DockedMenu'" control="''"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue_instantly cue="SetHintID" param="100216" comment="{1012, 100216}"/>
              </actions>
            </cue>

            <cue name="Tutorial_Deploy_Mine_Deployed">
              <conditions>
                <event_object_launched_mine group="$PlayerShipGroup"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <set_value name="$Mine" exact="event.param"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'docked_deploy_mil'"/>
                <remove_help_overlay id="'docked_deploy_mil_dropdown_mine'"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19015, $comment = 'It will not arm before youre out of its safety range, but you should still be careful around them.' ],
                            ],
                  $callbackcue = Tutorial_Deploy_Mine_UseCase_Done,
                  $abortcallbackcue = Tutorial_Deploy_Mine_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Deploy_Mine_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Deploy_Mine"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Deploy_Mine_GainDistance">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19023, $comment = 'Move to a safe distance.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Deploy_Mine_GainDistance_Objective">
              <actions>
                <set_value name="$distance" exact="$Mine.distanceto.{$PlayerShip}"/>
                <set_value name="$SafeDistance" exact="250m + $PlayerShip.size"/>
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1145}" silent="true">
                  <progress progress="$distance" max="$SafeDistance"/>
                </set_objective>
              </actions>
              <cues>
                <cue name="Tutorial_Deploy_Mine_GainDistance_Objective_Update">
                  <delay exact="1ms"/>
                  <actions>
                    <set_value name="$distance" exact="$Mine.distanceto.{$PlayerShip}"/>
                    <do_if value="$distance gt $SafeDistance">
                      <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                        $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                        $script = [
                                    table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19020, $comment = 'Other types of mines can move to track targets.' ],
                                    table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19021, $comment = 'Some can even distinguish friend from foe.' ],
                                    table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19022, $comment = 'This basic mine is static and just has a proximity trigger.' ],
                                  ],
                        $callbackcue = Tutorial_Deploy_Mine_GainDistance_UseCase_Done,
                        $abortcallbackcue = Tutorial_Deploy_Mine_GainDistance_UseCase_Done,
                      ]" />
                      <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                      <!--prevent player triggering the mine by approaching it-->
                      <set_playership_throttle value="0"/>
                      <lock_flight_throttle_input/>
                    </do_if>
                    <do_else>
                      <update_objective_progress cue="GameStart_Tutorial" progress="$distance" max="$SafeDistance" silent="true"/>
                      <reset_cue cue="this"/>
                    </do_else>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_Deploy_Mine_GainDistance_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Deploy_Mine_GainDistance"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Deploy_Mine_SelfDestruct">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19016, $comment = 'Unlike other deployables, mines can not be deactivated and picked back up.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19017, $comment = 'All you can do is have them self-destruct.' ],
                        ],
            ]" />
            <do_if value="$Mine.exists">
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19024, $comment = 'Interact with the mine and select the self-destruct option.' ],
                          ],
              ]" />
              <set_objective cue="GameStart_Tutorial" action="objective.destroy" object="$Mine"/>
              <signal_cue_instantly cue="SetHintID" param="[100213, 100214, 100214]" comment="{1012, 100213} or {1012, 100214}"/>
            </do_if>
            <do_else>
              <signal_cue cue="Tutorial_Deploy_Mine_SelfDestruct_UseCase_Done"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_Deploy_Mine_SelfDestructed">
              <conditions>
                <event_object_destroyed object="$Mine"/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <unlock_flight_throttle_input/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 33, $comment = 'There we go.' ],
                            ],
                  $callbackcue = Tutorial_Deploy_Mine_SelfDestruct_UseCase_Done,
                  $abortcallbackcue = Tutorial_Deploy_Mine_SelfDestruct_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Deploy_Mine_SelfDestruct_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Deploy_Mine_SelfDestruct"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Deploy_Lasertower">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <add_ammo object="$PlayerShip" macro="macro.ship_gen_xs_lasertower_01_a_macro" amount="1"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19018, $comment = 'There are also laser towers, small automated weapon platforms that can aim but not move around.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19019, $comment = 'Very useful if you need to defend something stationary.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19025, $comment = 'Deploy one now.' ],
                        ],
            ]" />
            <show_help_overlay id="'docked_deploy_mil'" highlightonly="true"/>
            <show_help_overlay id="'docked_deploy_mil_dropdown_lasertower'" highlightonly="true"/>
            <set_objective cue="GameStart_Tutorial" action="objective.deploy" text="{20201,20501}"/>
            <do_if value="$ShipMenuOpen?">
              <signal_cue cue="Tutorial_Deploy_Lasertower_ShipMenuOpened"/>
            </do_if>
            <do_else>
              <signal_cue cue="ShowHint_OpenShipMenu"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_Deploy_Lasertower_ShipMenuOpened">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'DockedMenu'" control="''"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue_instantly cue="SetHintID" param="100217" comment="{1012, 100217}"/>
              </actions>
            </cue>

            <cue name="Tutorial_Deploy_Lasertower_Deployed">
              <conditions>
                <event_object_launched_lasertower group="$PlayerShipGroup"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'docked_deploy_mil'"/>
                <remove_help_overlay id="'docked_deploy_mil_dropdown_lasertower'"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <set_value name="$Lasertower" exact="event.param"/>
                <set_object_min_hull object="$Lasertower" exact="100"/>
                <create_ship name="$LasertowerTarget" macro="macro.ship_gen_s_fightingdrone_01_a_macro" sector="$PlayerShip.sector" capturable="false">
                  <owner exact="faction.ownerless" overridenpc="true" />
                  <pilot>
                    <select race="race.drone" tags="tag.aipilot"/>
                  </pilot>
                  <safepos object="player.ship" z="1km"/>
                </create_ship>
                <set_object_hull object="$LasertowerTarget" exact="25"/>
                <set_relation_boost object="$LasertowerTarget" value="-1" faction="faction.player" silent="true"/>
                <set_object_relation_behaviour object="$LasertowerTarget" disable="true"/>
                <create_order object="$LasertowerTarget" id="'Attack'" immediate="true">
                  <param name="primarytarget" value="$PlayerShip"/>
                  <param name="forceprimarytarget" value="true"/>
                  <param name="pursuetargets" value="true"/>
                  <param name="allowothertargets" value="false"/>
                  <param name="allowboost" value="true"/>
                </create_order>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19026, $comment = 'Observe it attacking the hostile drone.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 19027, $comment = 'There are larger laser towers, but they can only be deployed from ships with S-sized docking bays.' ],
                            ],
                  $callbackcue = Tutorial_Deploy_Lasertower_UseCase_Done,
                  $abortcallbackcue = Tutorial_Deploy_Lasertower_UseCase_Done,
                ]" />
              </actions>
              <cues>
                <cue name="Tutorial_Deploy_Lasertower_TargetDestroyed">
                  <conditions>
                    <event_object_destroyed object="$LasertowerTarget"/>
                  </conditions>
                  <actions>
                    <do_if value="Tutorial_Deploy_Lasertower_UseCase_Done.state == cuestate.complete">
                      <signal_cue cue="Tutorial_Deploy_Lasertower_Done"/>
                    </do_if>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_Deploy_Lasertower_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <do_if value="not $LasertowerTarget.isoperational">
                  <signal_cue cue="Tutorial_Deploy_Lasertower_Done"/>
                </do_if>
              </actions>
            </cue>

            <cue name="Tutorial_Deploy_Lasertower_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Deploy_Lasertower"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Scan_Gravidar">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18001, $comment = 'Lets take a look at your scanners.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18002, $comment = 'First theres the Gravidar.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18003, $comment = 'Its always on and passively detects objects around you.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18004, $comment = 'There are ship modifications and some regions that affect this, but the usual range is around 40 kilometers.' ],
                        ],
              $callbackcue = Tutorial_Scan_Gravidar_Done,
              $abortcallbackcue = Tutorial_Scan_Gravidar_Done,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Scan_Gravidar_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Scan_Gravidar"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Scan_LongRange">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <find_object groupname="$UnidentifiedObjects" class="[class.gate, class.station]" space="player.sector" multiple="true"/>
            <create_lockbox name="$LongRangeScanTarget" groupname="$dropgroup" macro="macro.sm_gen_lockbox_rare_01_macro" sector="player.sector">
              <safepos object="player.ship" z="45km" x="-5km" y="5km"/>
            </create_lockbox>
            <add_cargo object="$LongRangeScanTarget" ware="ware.inv_fluxcapacitor" exact="1"/>
            <!--<update_mission cue="GameStart_Tutorial" scantarget="$ScanShip"/>-->
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18005, $comment = 'Then theres the long range scanner.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18006, $comment = 'Its a mode you need to activate manually.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    15, $comment = 'Do so now.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Scan_LongRange_ActivateMode_ref" ref="LIB_ActivateMode">
              <param name="Mode" value="activity.scan_longrange"/>
              <param name="CallbackCue" value="Tutorial_Scan_LongRange_ModeActivated"/>
            </cue>

            <cue name="Tutorial_Scan_LongRange_ModeActivated">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_SendLongRangeScan"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18007, $comment = 'This scanner works by sending out a charged wave of particles.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18008, $comment = 'The longer you charge the higher the range.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18009, $comment = 'But if you overcharge it you need to start over.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18010, $comment = 'Dont worry, it wont damage anything.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    16, $comment = 'Try it.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Scan_LongRange_MoveScanTarget">
              <delay exact="1s"/>
              <actions>
                <!--cheat a bit by placing the target ship always more or less in front of the player (with a slight offset)-->
                <warp object="$LongRangeScanTarget" sector="player.sector">
                  <safepos object="player.ship" z="45km" x="-5km" y="5km"/>
                </warp>
                <reset_cue cue="this"/>
              </actions>
            </cue>

            <cue name="Tutorial_Scan_LongRange_Sent">
              <conditions>
                <event_long_range_scan_sent object="player.ship"/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_Scan_LongRange_MoveScanTarget"/>
                <do_if value="event.param lt 0.2">
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18011, $comment = 'A bit more.' ],
                              ],
                  ]" />
                </do_if>
                <do_elseif value="event.param gt 0.8">
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    17, $comment = 'Good one!' ],
                              ],
                  ]" />
                </do_elseif>
                <reset_cue cue="this"/>
              </actions>
            </cue>

            <cue name="Tutorial_Scan_LongRange_RemoveDetectedObjects" instantiate="true">
              <conditions>
                <event_player_detected_object/>
              </conditions>
              <actions>
                <set_object_long_range_scanned object="event.param" scanned="false"/>
              </actions>
            </cue>

            <cue name="Tutorial_Scan_LongRange_Ping">
              <conditions>
                <event_long_range_scan_ping object="$LongRangeScanTarget"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <cancel_cue cue="Tutorial_Scan_LongRange_Sent"/>
                <set_objective cue="GameStart_Tutorial" action="objective.flyto" text="{20109,5001}" comment="Unknown Object"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18012, $comment = 'Youve got a result.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    18, $comment = 'Fly towards it.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18013, $comment = 'I recommend using travel mode.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18014, $comment = 'The maximum range of this scanner is around 200 kilometers, so this thing could be pretty far off.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18015, $comment = 'The long range scanner is directional, by the way; only certain massive objects like stations and jumpgates can be detected all around you.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18016, $comment = 'I recommend switching back to the long range scanner from time to time, and send another pulse to re-orient yourself.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Scan_LongRange_TargetNear" checkinterval="1ms">
              <conditions>
                <check_value value="$LongRangeScanTarget.distanceto.{player.ship} lt 5km"/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <update_mission cue="GameStart_Tutorial" scantarget="0"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18017, $comment = 'Theres our target!' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18053, $comment = 'Its a lockbox.' ],
                            ],
                  $callbackcue = Tutorial_Scan_LongRange_Done,
                  $abortcallbackcue = Tutorial_Scan_LongRange_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Scan_LongRange_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Scan_LongRange"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Open_Lockbox">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18054, $comment = 'Most of these are stashes that were abandoned for one reason or another.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18055, $comment = 'Theres no telling whats inside, so be careful when opening them.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18056, $comment = 'And be sure to double-check whether you picked up anything illegal.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18057, $comment = 'I promise that this ones fine, though.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18058, $comment = 'Shoot all of the locks to open it, while taking care not to damage the box itself.' ],
                        ],
              $callbackcue = Tutorial_Open_Lockbox_Objective,
              $abortcallbackcue = Tutorial_Open_Lockbox_Objective,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Open_Lockbox_Objective">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.destroy" group="$LongRangeScanTarget.locks.operational.list"/>
              </actions>
            </cue>

            <cue name="Tutorial_Open_Lockbox_Done">
              <conditions>
                <check_any>
                  <event_lockbox_opened object="$LongRangeScanTarget"/>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_Open_Lockbox_Objective"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    20, $comment = 'Well done.' ],
                            ],
                  $callbackcue = Tutorial_Open_Lockbox_UseCase_Done,
                  $abortcallbackcue = Tutorial_Open_Lockbox_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Open_Lockbox_Failed">
              <conditions>
                <check_any>
                  <event_object_destroyed object="$LongRangeScanTarget"/>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_Open_Lockbox_Objective"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    31, $comment = 'Better luck next time.' ],
                            ],
                  $callbackcue = Tutorial_Open_Lockbox_UseCase_Done,
                  $abortcallbackcue = Tutorial_Open_Lockbox_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Open_Lockbox_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Open_Lockbox"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Scan_Ship">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <unlock_getup/>
            <create_ship name="$ScanShip" macro="macro.ship_arg_m_miner_solid_01_a_macro" sector="player.sector" capturable="false">
              <owner exact="faction.argon" overridenpc="true" />
              <pilot group="argon.pilot"/>
              <loadout>
                <level exact="1"/>
                <variation exact="0"/>
              </loadout>
              <safepos object="player.ship" z="1km"/>
            </create_ship>
            <add_cargo object="$ScanShip" ware="ware.ore" exact="100"/>
            <create_order object="$ScanShip" id="'Wait'" immediate="true"/>
            <set_objective cue="GameStart_Tutorial" action="objective.scan" object="$ScanShip"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18018, $comment = 'Theres a ship ahead of you.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18019, $comment = 'Lets scan it.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18020, $comment = 'Activate the object scan mode.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Scan_Ship_ActivateMode_Ref" ref="LIB_ActivateMode">
              <param name="Mode" value="activity.scan"/>
              <param name="CallbackCue" value="Tutorial_Scan_Ship_ModeActivated"/>
            </cue>

            <cue name="Tutorial_Scan_Ship_ModeActivated">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <show_help_overlay id="'interactmenu_scan'" highlightonly="true"/>
                <signal_cue_instantly cue="SetHintID" param="[100241, 100242]" comment="{1012,100241} or {1012,100242}"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18021, $comment = 'Now interact with the ship and select the scan option.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Scan_Ship_ScanStarted">
              <conditions>
                <event_scan_started scanner="player.ship" scanned="$ScanShip"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18022, $comment = 'Keep the ship near your cross-hair.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Scan_Ship_ScanAborted">
              <conditions>
                <event_scan_aborted scanner="player.ship" scanned="$ScanShip"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18023, $comment = 'Ah, you lost it. Try again.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Scan_Ship_ScanFinished">
              <conditions>
                <event_scan_finished scanner="player.ship" scanned="$ScanShip"/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18024, $comment = 'There you go, the ship has been scanned.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18025, $comment = 'You can now see the cargo its carrying, for example.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18026, $comment = 'Some ships, especially military, are more hardened against scans.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18027, $comment = 'Youll need to buy a better scanner or even get up close in your spacesuit.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18028, $comment = 'This scan mode can also display minerals in asteroids, but that will be covered in another lesson.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    19, $comment = 'Lets move on for now.' ],
                            ],
                  $callbackcue = Tutorial_Scan_Ship_Done,
                  $abortcallbackcue = Tutorial_Scan_Ship_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Scan_Ship_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'interactmenu_scan'"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Scan_Ship"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Scan_LongRange_Unidentified">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <cancel_cue cue="Tutorial_Scan_LongRange_RemoveDetectedObjects"/>
            <do_for_each name="$object" in="$UnidentifiedObjects">
              <set_object_long_range_scanned object="$object"/>
            </do_for_each>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18029, $comment = 'If you open the map you may notice that there are several question marks.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18030, $comment = 'These are massive objects, detected but not identified by the long range scanner.',
                                  $speakcallbackcue = Tutorial_Scan_LongRange_Unidentified_Objective],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18031, $comment = 'Fly to any one of them.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Scan_LongRange_Unidentified_Objective">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.flyto" group="$UnidentifiedObjects"/>
              </actions>
            </cue>

            <cue name="Tutorial_Scan_LongRange_Unidentified_ObjectInRange" instantiate="true">
              <conditions>
                <event_object_entered_live_view group="$UnidentifiedObjects"/>
              </conditions>
              <actions>
                <remove_from_group group="$UnidentifiedObjects" object="event.object"/>
                <do_if value="event.object.isclass.station">
                  <set_value name="$ScanStation" exact="event.object"/>
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18033, $comment = 'Now that you are in Gravidar range, you can see what kind of station it is.' ],
                              ],
                    $callbackcue = Tutorial_Scan_LongRange_Unidentified_Done,
                    $abortcallbackcue = Tutorial_Scan_LongRange_Unidentified_Done,
                  ]" />
                </do_if>
                <do_else>
                  <set_objective cue="GameStart_Tutorial" action="objective.flyto" group="$UnidentifiedObjects"/>
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18032, $comment = 'Now that you are in Gravidar range, you can see that it is a gate.' ],
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18034, $comment = 'Lets check out the other object.' ],
                              ],
                  ]" />
                </do_else>
              </actions>
            </cue>

            <cue name="Tutorial_Scan_LongRange_Unidentified_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Scan_LongRange_Unidentified"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Scan_Station">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <unlock_getup/>
            <do_if value="not $ScanStation?">
              <find_station name="$ScanStation" space="player.sector"/>
            </do_if>
            <set_objective cue="GameStart_Tutorial" action="objective.scan" object="$ScanStation"/>
            <do_if value="player.ship.movementrefobject != $ScanStation">
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18035, $comment = 'Approach the station.' ],
                          ],
              ]" />
            </do_if>
          </actions>
          <cues>
            <cue name="Tutorial_Scan_Station_NearStation" checkinterval="1ms">
              <conditions>
                <check_value value="player.ship.movementrefobject == $ScanStation"/>
              </conditions>
              <actions>
                <do_if value="player.activity != activity.scan">
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18036, $comment = 'Activate the object scan mode again.' ],
                              ],
                  ]" />
                </do_if>
              </actions>
              <cues>
                <cue name="Tutorial_Scan_Station_ActivateScanMode" ref="LIB_ActivateMode">
                  <param name="Mode" value="activity.scan"/>
                  <param name="CallbackCue" value="Tutorial_Scan_Station_ScanModeActivated"/>
                </cue>

                <cue name="Tutorial_Scan_Station_ScanModeActivated">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18037, $comment = 'Your heads up display has overlaid a filter over the modules.' ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18038, $comment = 'Pick any module and approach it.' ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18039, $comment = 'Try to have it in your view, too.' ],
                                ],
                    ]" />
                    <do_if value="$ScanStation.revealedpercentage lt 100">
                      <do_for_each name="$module" in="$ScanStation.modules.all.list">
                        <do_if value="$module.revealedpercentage gt 0 and $module.revealedpercentage lt 100 and $module.secrecylevel gt player.ship.maxscanlevel">
                          <signal_cue_instantly cue="Tutorial_Scan_Station_ScanLevelLow" param="$module"/>
                          <break/>
                        </do_if>
                      </do_for_each>
                    </do_if>
                  </actions>
                </cue>

                <cue name="Tutorial_Scan_Station_ModuleScanned">
                  <conditions>
                    <event_player_discovered_object/>
                    <check_value value="event.param.isclass.module"/>
                  </conditions>
                  <delay exact="1ms" comment="just to make sure it happens after Tutorial_Scan_Station_ScanModeActivated"/>
                  <actions>
                    <cancel_cue cue="Tutorial_Scan_Station_ScanModeActivated"/>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18040, $comment = 'There we go, its scanned.' ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18059, $comment = 'Keep scanning modules until youve fully scanned the entire station.' ],
                                ],
                    ]" />
                  </actions>
                </cue>

                <cue name="Tutorial_Scan_Station_ScanLevelLow">
                  <conditions>
                    <check_any>
                      <event_player_discovered_object/>
                      <event_cue_signalled/>
                    </check_any>
                    <check_value value="event.param.isclass.module and event.param.secrecylevel gt player.ship.maxscanlevel"/>
                  </conditions>
                  <actions>
                    <set_value name="$ScanModule" exact="event.param"/>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18041, $comment = 'This module is hardened against scans and requires a better scanner than your ship can carry.' ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18060, $comment = 'You need to scan it from your spacesuit.' ],
                                ],
                    ]" />
                  </actions>
                  <cues>
                    <cue name="Tutorial_Scan_Station_ScanLevelLow_EnterSpaceSuit">
                      <delay exact="1ms"/>
                      <actions>
                        <find_player_transporter_slot name="$TransporterSlot" object="$PlayerShip.controlroom"/>
                        <set_objective cue="GameStart_Tutorial" action="objective.usespacesuit" slot="$TransporterSlot" comment="Use Spacesuit"/>
                        <signal_cue cue="Tutorial_Scan_Station_ScanLevelLow_EnterSpaceSuit_StartedControl"/>
                      </actions>
                      <cues>
                        <cue name="Tutorial_Scan_Station_ScanLevelLow_EnterSpaceSuit_StoppedControl" instantiate="true">
                          <conditions>
                            <event_player_stopped_control/>
                          </conditions>
                          <delay exact="1ms"/>
                          <actions>
                            <signal_cue_instantly cue="ClearHintID"/>
                            <remove_help_overlay id="'docked_getup'"/>
                            <signal_cue cue="Tutorial_Scan_Station_ScanLevelLow_EnterSpaceSuit_TransporterMenuHint"/>
                          </actions>
                        </cue>

                        <cue name="Tutorial_Scan_Station_ScanLevelLow_EnterSpaceSuit_StartedControl" instantiate="true">
                          <conditions>
                            <check_any>
                              <event_player_started_control/>
                              <event_cue_signalled/>
                            </check_any>
                          </conditions>
                          <actions>
                            <signal_cue cue="ShowHint_GetUp"/>
                            <remove_help_overlay all="true"/>
                            <show_help_overlay id="'docked_getup'" highlightonly="true"/>
                            <set_value name="$GetUpHintActive" exact="true"/>
                          </actions>
                        </cue>

                        <cue name="Tutorial_Scan_Station_ScanLevelLow_EnterSpaceSuit_OpenedTransporterMenu" instantiate="true">
                          <conditions>
                            <event_ui_triggered screen="'TransporterMenu'" control="''"/>
                          </conditions>
                          <actions>
                            <signal_cue_instantly cue="SetHintID" param="27304" comment="{1012, 27304}"/>
                          </actions>
                        </cue>

                        <cue name="Tutorial_Scan_Station_ScanLevelLow_EnterSpaceSuit_ClosedTransporterMenu" instantiate="true">
                          <conditions>
                            <event_ui_triggered screen="'TransporterMenu'" control="'menu_close'"/>
                          </conditions>
                          <actions>
                            <signal_cue_instantly cue="ClearHintID"/>
                            <signal_cue cue="Tutorial_Scan_Station_ScanLevelLow_EnterSpaceSuit_TransporterMenuHint"/>
                          </actions>
                        </cue>

                        <cue name="Tutorial_Scan_Station_ScanLevelLow_EnterSpaceSuit_OpenedUserQuestionMenu" instantiate="true">
                          <conditions>
                            <event_ui_triggered screen="'UserQuestionMenu'" control="''"/>
                          </conditions>
                          <actions>
                            <signal_cue cue="ShowHint_ConfirmInMenu"/>
                          </actions>
                        </cue>

                        <cue name="Tutorial_Scan_Station_ScanLevelLow_EnterSpaceSuit_ClosedUserQuestionMenu" instantiate="true">
                          <conditions>
                            <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                          </conditions>
                          <actions>
                            <signal_cue_instantly cue="ClearHintID"/>
                            <signal_cue cue="Tutorial_Scan_Station_ScanLevelLow_EnterSpaceSuit_TransporterMenuHint"/>
                          </actions>
                        </cue>

                        <cue name="Tutorial_Scan_Station_ScanLevelLow_EnterSpaceSuit_TransporterMenuHint" instantiate="true">
                          <conditions>
                            <event_cue_signalled/>
                          </conditions>
                          <delay exact="0.5s"/>
                          <actions>
                            <remove_value name="$GetUpHintActive"/>
                            <do_if value="not player.ship.isclass.spacesuit">
                              <signal_cue_instantly cue="SetHintID" param="[27303, 27302, 27302]" comment="{1012, 27303} or {1012, 27302}"/>
                            </do_if>
                          </actions>
                          <cues>
                            <cue name="Tutorial_Scan_Station_ScanLevelLow_EnterSpaceSuit_TransporterMenuHint_Cancel">
                              <conditions>
                                <check_any>
                                  <event_ui_triggered screen="'UserQuestionMenu'" control="''"/>
                                  <event_ui_triggered screen="'TransporterMenu'" control="''"/>
                                  <event_player_started_control/>
                                </check_any>
                              </conditions>
                              <actions>
                                <cancel_cue cue="parent"/>
                              </actions>
                            </cue>
                          </cues>
                        </cue>

                        <cue name="Tutorial_Scan_Station_ScanLevelLow_EnterSpaceSuit_Done">
                          <conditions>
                            <event_object_changed_room object="player.entity"/>
                            <check_value value="player.ship.isclass.spacesuit"/>
                          </conditions>
                          <actions>
                            <set_objective cue="GameStart_Tutorial" action="objective.scan" object="$ScanModule"/>
                            <cancel_cue cue="Tutorial_Scan_Station_ScanLevelLow_EnterSpaceSuit"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>

                    <cue name="Tutorial_Scan_Station_ScanLevelLow_ModuleScanned">
                      <conditions>
                        <event_player_discovered_object object="$ScanModule"/>
                        <check_value value="$ScanModule.revealedpercentage == 100"/>
                      </conditions>
                      <actions>
                        <set_objective cue="GameStart_Tutorial" action="objective.scan" object="$ScanStation"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_Scan_Station_Done">
              <conditions>
                <event_player_discovered_object/>
                <check_value value="$ScanStation.revealedpercentage == 100"/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Scan_Station"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Scan_Leak">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="not $ScanStation?">
              <find_station name="$ScanStation" space="player.sector"/>
            </do_if>
            <set_value name="$LeakMacro" exact="macro.dataleak_s_standard_01_macro"/>
            <create_signal_leak name="$ScanLeak" macro="$LeakMacro" type="signalleaktype.data" object="$ScanStation">
              <position x="-148.2m + ($LeakMacro.boundingbox.max.y - $LeakMacro.boundingbox.center.y)" y="292m" z="1375m"/>
              <rotation yaw="90deg" pitch="-90deg"/>
            </create_signal_leak>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18042, $comment = 'Look right below your crosshair.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18043, $comment = 'You can see a few moving bars there.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18044, $comment = 'They indicate that there is some kind of Signal Leak nearby.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18045, $comment = 'Finding those is a lot easier when Scan Mode is active.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18046, $comment = 'Try to do so on your own first.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18047, $comment = 'Ill mark it in a little bit.' ],
                        ],
              $callbackcue = Tutorial_Scan_Leak_SetLeakObjective_Delayed,
              $abortcallbackcue = Tutorial_Scan_Leak_SetLeakObjective_Delayed,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Scan_Leak_SetLeakObjective_Delayed">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="20s"/>
              <actions>
                <signal_cue cue="Tutorial_Scan_Leak_SetLeakObjective"/>
              </actions>
            </cue>

            <cue name="Tutorial_Scan_Leak_SetLeakObjective">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.scan" object="$ScanLeak"/>
              </actions>
            </cue>

            <cue name="Tutorial_Scan_Leak_NearLeak" checkinterval="1ms">
              <conditions>
                <check_value value="$ScanLeak.distanceto.{player.ship} lt 100m"/>
              </conditions>
              <actions>
                <do_if value="Tutorial_Scan_Leak_SetLeakObjective.state == cuestate.waiting">
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    20, $comment = 'Well done.' ],
                              ],
                  ]" />
                  <signal_cue cue="Tutorial_Scan_Leak_SetLeakObjective"/>
                  <cancel_cue cue="Tutorial_Scan_Leak_SetLeakObjective_Delayed"/>
                </do_if>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18048, $comment = 'To scan these you need to get really close and keep them centred in your crosshair for a few seconds.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Scan_Leak_ScanAborted">
              <conditions>
                <event_player_signal_unlock_failed/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18023, $comment = 'Ah, you lost it. Try again.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Scan_Leak_Scanned">
              <conditions>
                <event_player_signal_unlock_finished/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    21, $comment = 'Good.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18049, $comment = 'Your computer was able to extract some information from it.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18050, $comment = 'The type of information can vary a lot, and sometimes its actually someone offering you a mission on the down low.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18061, $comment = 'Most of the time youll find something you can use to negotiate a better deal for a specific resource or product of the station.' ],
                            ],
                  $callbackcue = Tutorial_Scan_Leak_Done,
                  $abortcallbackcue = Tutorial_Scan_Leak_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Scan_Leak_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Scan_Leak"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Scan_Leak_Spacesuit">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_value name="$LeakMacro" exact="macro.dataleak_xs_standard_01_macro"/>
            <create_signal_leak name="$ScanLeak" macro="$LeakMacro" type="signalleaktype.data" object="$ScanStation">
              <position x="146.2m - ($LeakMacro.boundingbox.max.y - $LeakMacro.boundingbox.center.y)" y="292m" z="1195m"/>
              <rotation yaw="90deg" pitch="90deg"/>
            </create_signal_leak>
            <set_objective cue="GameStart_Tutorial" action="objective.scan" object="$ScanLeak"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18062, $comment = 'Try to scan another leak.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Scan_Leak_Spacesuit_ScanImpossible">
              <conditions>
                <event_player_signal_unlock_impossible/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18063, $comment = 'Your ships scanner isnt enough to unlock this one, you need to get really close using your spacesuit.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 15, $comment = 'Do so now.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_Scan_Leak_EnterSpaceSuit"/>
              </actions>
            </cue>

            <cue name="Tutorial_Scan_Leak_EnterSpaceSuit">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <find_player_transporter_slot name="$TransporterSlot" object="$PlayerShip.controlroom"/>
                <set_objective cue="GameStart_Tutorial" action="objective.usespacesuit" slot="$TransporterSlot" comment="Use Spacesuit"/>
                <signal_cue cue="Tutorial_Scan_Leak_EnterSpaceSuit_StartedControl"/>
              </actions>
              <cues>
                <cue name="Tutorial_Scan_Leak_EnterSpaceSuit_StoppedControl" instantiate="true">
                  <conditions>
                    <event_player_stopped_control/>
                  </conditions>
                  <delay exact="1ms"/>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <remove_help_overlay id="'docked_getup'"/>
                    <signal_cue cue="Tutorial_Scan_Leak_EnterSpaceSuit_TransporterMenuHint"/>
                  </actions>
                </cue>

                <cue name="Tutorial_Scan_Leak_EnterSpaceSuit_StartedControl" instantiate="true">
                  <conditions>
                    <check_any>
                      <event_player_started_control/>
                      <event_cue_signalled/>
                    </check_any>
                  </conditions>
                  <actions>
                    <signal_cue cue="ShowHint_GetUp"/>
                    <remove_help_overlay all="true"/>
                    <show_help_overlay id="'docked_getup'" highlightonly="true"/>
                    <set_value name="$GetUpHintActive" exact="true"/>
                  </actions>
                </cue>

                <cue name="Tutorial_Scan_Leak_EnterSpaceSuit_OpenedTransporterMenu" instantiate="true">
                  <conditions>
                    <event_ui_triggered screen="'TransporterMenu'" control="''"/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="SetHintID" param="27304" comment="{1012, 27304}"/>
                  </actions>
                </cue>

                <cue name="Tutorial_Scan_Leak_EnterSpaceSuit_ClosedTransporterMenu" instantiate="true">
                  <conditions>
                    <event_ui_triggered screen="'TransporterMenu'" control="'menu_close'"/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <signal_cue cue="Tutorial_Scan_Leak_EnterSpaceSuit_TransporterMenuHint"/>
                  </actions>
                </cue>

                <cue name="Tutorial_Scan_Leak_EnterSpaceSuit_OpenedUserQuestionMenu" instantiate="true">
                  <conditions>
                    <event_ui_triggered screen="'UserQuestionMenu'" control="''"/>
                  </conditions>
                  <actions>
                    <signal_cue cue="ShowHint_ConfirmInMenu"/>
                  </actions>
                </cue>

                <cue name="Tutorial_Scan_Leak_EnterSpaceSuit_ClosedUserQuestionMenu" instantiate="true">
                  <conditions>
                    <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <signal_cue cue="Tutorial_Scan_Leak_EnterSpaceSuit_TransporterMenuHint"/>
                  </actions>
                </cue>

                <cue name="Tutorial_Scan_Leak_EnterSpaceSuit_TransporterMenuHint" instantiate="true">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <delay exact="0.5s"/>
                  <actions>
                    <remove_value name="$GetUpHintActive"/>
                    <do_if value="not player.ship.isclass.spacesuit">
                      <signal_cue_instantly cue="SetHintID" param="[27303, 27302, 27302]" comment="{1012, 27303} or {1012, 27302}"/>
                    </do_if>
                  </actions>
                  <cues>
                    <cue name="Tutorial_Scan_Leak_EnterSpaceSuit_TransporterMenuHint_Cancel">
                      <conditions>
                        <check_any>
                          <event_ui_triggered screen="'UserQuestionMenu'" control="''"/>
                          <event_ui_triggered screen="'TransporterMenu'" control="''"/>
                          <event_player_started_control/>
                        </check_any>
                      </conditions>
                      <actions>
                        <cancel_cue cue="parent"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>

                <cue name="Tutorial_Scan_Leak_EnterSpaceSuit_Done">
                  <conditions>
                    <event_object_changed_room object="player.entity"/>
                    <check_value value="player.ship.isclass.spacesuit"/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18064, $comment = 'Scanning still works the same way here.' ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16, $comment = 'Try it.' ],
                                ],
                    ]" />
                    <set_objective cue="GameStart_Tutorial" action="objective.scan" object="$ScanLeak"/>
                    <cancel_cue cue="Tutorial_Scan_Leak_EnterSpaceSuit"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_Scan_Leak_Spacesuit_ScanAborted">
              <conditions>
                <event_player_signal_unlock_failed/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18023, $comment = 'Ah, you lost it. Try again.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Scan_Leak_Spacesuit_Scanned">
              <conditions>
                <event_player_signal_unlock_finished/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 21, $comment = 'Good.' ],
                            ],
                  $callbackcue = Tutorial_Scan_Leak_Spacesuit_Done,
                  $abortcallbackcue = Tutorial_Scan_Leak_Spacesuit_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Scan_Leak_Spacesuit_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Scan_Leak_Spacesuit"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Repair_Leak">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18051, $comment = 'You may also be able to find paid work to repair these before anyone can exploit them.',
                                  $speakcallbackcue = Tutorial_Repair_Leak_CreateLeak ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18065, $comment = 'Go and repair the marked one now.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18066, $comment = 'Best turn off scan mode so that you dont accidentally scan it.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Repair_Leak_CreateLeak" instantiate="true">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_value name="$LeakMacro" exact="macro.dataleak_xs_standard_01_macro"/>
                <create_signal_leak name="$RepairLeak" macro="$LeakMacro" type="signalleaktype.data" object="$ScanStation">
                  <position x="146.2m - ($LeakMacro.boundingbox.max.y - $LeakMacro.boundingbox.center.y)" y="272m" z="1375m"/>
                  <rotation yaw="90deg" pitch="90deg"/>
                </create_signal_leak>
                <signal_cue_instantly cue="SetHintID" param="27100" comment="{1012, 27100}"/>
                <set_objective cue="GameStart_Tutorial" action="objective.repair" object="$RepairLeak"/>
              </actions>
            </cue>

            <cue name="Tutorial_Repair_Leak_Scanned" instantiate="true">
              <conditions>
                <event_player_signal_unlock_finished/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $selectspeak = [6, 7, 8], $comment = 'Variations on ’Try again’' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18066, $comment = 'Best turn off scan mode so that you dont accidentally scan it.' ],
                            ],
                ]" />
                <signal_cue_instantly cue="ClearHintID"/>
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1148}"/>
              </actions>
              <cues>
                <cue name="Tutorial_Repair_Leak_Scanned_ModeDeactivated">
                  <conditions>
                    <event_player_changed_activity oldactivity="activity.scan"/>
                  </conditions>
                  <actions>
                    <signal_cue cue="Tutorial_Repair_Leak_CreateLeak"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_Repair_Leak_Repaired">
              <conditions>
                <event_player_repaired_signal_leak/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 33, $comment = 'There we go.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18067, $comment = 'These leaks are usually just a product of wear and tear, but sometimes criminals use hand-crafted EMP bombs to create them.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 18052, $comment = 'Im not going to tell you what to do, but at least try not to get caught doing anything shady, alright?' ],
                            ],
                  $callbackcue = Tutorial_Repair_Leak_Done,
                  $abortcallbackcue = Tutorial_Repair_Leak_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Repair_Leak_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Repair_Leak"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_KeepOpen">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue cue="OpenMap"/>
            <do_if value="player.holomap.isopen">
              <signal_cue cue="Tutorial_Map_KeepOpen_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    23, $comment = 'Open the map.' ],
                          ],
              ]" />
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_Map_KeepOpen_Done">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'MapMenu'" control="''"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <reset_cue cue="Tutorial_Map_KeepOpen"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_CloseMap_UseCase">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.holomap.isopen">
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    24, $comment = 'Take your time looking around.' ],
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    26, $comment = 'Close the map when youre done.' ],
                          ],
                  $callbackcue = Tutorial_Map_CloseMap_UseCase_Done,
                  $abortcallbackcue = Tutorial_Map_CloseMap_UseCase_Done,
              ]" />
            </do_if>
            <do_else>
              <signal_cue cue="Tutorial_Map_CloseMap_UseCase_Done"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_Map_CloseMap_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_CloseMap_UseCase"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_CloseMap">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue cue="OpenMap_Reset"/>
            <do_if value="player.holomap.isopen">
              <show_help_overlay id="'close'" highlightonly="true"/>
              <signal_cue cue="ShowHint_CloseMenus"/>
            </do_if>
            <do_else>
              <signal_cue cue="Tutorial_Map_CloseMap_Done"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_Map_CloseMap_Done">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'MapMenu'" control="'menu_close'"/>
                </check_any>
              </conditions>
              <actions>
                <remove_help_overlay id="'close'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <reset_cue cue="Tutorial_Map_CloseMap"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_InitialUseCaseAndSetup">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23001, $comment = 'It might be your most powerful tool, but it can be overwhelming at first.' ],
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23002, $comment = 'Well cover the basics today.' ],
                          ],
                $callbackcue = Tutorial_Map_InitialUseCaseAndSetup_Done,
                $abortcallbackcue = Tutorial_Map_InitialUseCaseAndSetup_Done,
              ]" />
            <lock_all_holomap_input/>
            <do_if value="player.holomap.isopen">
              <signal_cue cue="Tutorial_Map_InitialUseCaseAndSetup_LimitMapZoom"/>
            </do_if>
            <create_object name="$NavBeacon" macro="macro.env_deco_nav_beacon_t1_macro" sector="player.sector" owner="faction.player">
              <safepos object="$PlayerShip" x="500m" z="500m"/>
            </create_object>
            <create_object name="$Satellite" macro="macro.eq_arg_satellite_01_macro" sector="player.sector" owner="faction.player">
              <safepos x="-250km"/>
            </create_object>
          </actions>
          <cues>
            <cue name="Tutorial_Map_InitialUseCaseAndSetup_LimitMapZoom" instantiate="true">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'MapMenu'" control="''"/>
                </check_any>
              </conditions>
              <actions>
                <set_holomap_max_zoom value="450000"/>
              </actions>
            </cue>

            <cue name="Tutorial_Map_InitialUseCaseAndSetup_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <!--don't cancel this cue so that we can keep reacting to the map opening-->
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_Legend">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23046, $comment = 'Lets begin with the icons.',
                                  $speakcallbackcue = Tutorial_Map_Legend_HighlightOption],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    22, $comment = 'Open the highlighted menu.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Map_Legend_HighlightOption">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_SelectMenuItem"/>
                <show_help_overlay id="'mapst_legend'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_Map_Legend_MenuOpened">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'legend'"/>
                <check_value value="event.param3 != 'off'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'mapst_legend'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23015, $comment = 'The legend shows you the meaning of the different things you see on the map.',
                                      $speakcallbackcue = Tutorial_Map_Legend_FocusOnPlayerShip],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23003, $comment = 'This light green icon in the middle is your small fighter ship, for example.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23050, $comment = 'The green colour means that its owned by you, the slightly lighter hue means that youre currently there personally.',
                                      $speakcallbackcue = Tutorial_Map_Legend_FocusOnWharf],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23004, $comment = 'And the big icon next to you is a station.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23010, $comment = 'A wharf to be specific.',
                                      $speakcallbackcue = Tutorial_Map_Legend_ResetView],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23011, $comment = 'Dont feel like you need to memorize this, you will always have access to it.',
                                      $speakcallbackcue = Tutorial_Map_Legend_CloseMenu],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    28, $comment = 'Close this menu for now.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_Map_Legend_MarkNearbyObjects"/>
              </actions>
            </cue>

            <cue name="Tutorial_Map_Legend_MarkNearbyObjects">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <cues>
                <cue name="Tutorial_Map_Legend_MarkNearbyObjects_Loop">
                  <delay exact="0.5s"/>
                  <actions>
                    <add_holomap_text object="player.ship" text="{30178,1138}"/>
                    <add_holomap_text object="$Wharf" text="{30178,1139}"/>
                  </actions>
                  <delay exact="1s"/>
                  <actions>
                    <remove_holomap_text object="player.ship"/>
                    <remove_holomap_text object="$Wharf"/>
                    <reset_cue cue="this"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_Map_Legend_FocusOnPlayerShip">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_holomap_target object="$PlayerShip"/>
                <set_holomap_zoom value="2000"/>
              </actions>
            </cue>

            <cue name="Tutorial_Map_Legend_FocusOnWharf">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_holomap_target object="$Wharf"/>
                <set_holomap_zoom value="5000"/>
              </actions>
            </cue>

            <cue name="Tutorial_Map_Legend_ResetView">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_holomap_target object="$PlayerShip"/>
                <set_holomap_zoom value="10000"/>
              </actions>
            </cue>

            <cue name="Tutorial_Map_Legend_CloseMenu">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_CloseSubMenu"/>
                <show_help_overlay id="'mapst_legend'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_Map_Legend_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'legend'"/>
                <check_value value="event.param3 == 'off'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'mapst_legend'"/>
                <remove_holomap_text object="player.ship"/>
                <remove_holomap_text object="$Wharf"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_Legend"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_ZoomOut">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_ZoomMap"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23005, $comment = 'Zoom out as far as you can.' ],
                        ],
            ]" />
            <unlock_holomap_zoom_input/>
          </actions>
          <cues>
            <cue name="Tutorial_Map_ZoomOut_Done" checkinterval="1ms">
              <conditions>
                <check_value value="player.holomap.isopen and player.holomap.camera.zoomdistance gt 400000"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23006, $comment = 'The hexagon you see is a sector.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23007, $comment = 'As you explore you will find many more.' ],
                            ],
                  $callbackcue = Tutorial_Map_ZoomOut_UseCase_Done,
                  $abortcallbackcue = Tutorial_Map_ZoomOut_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Map_ZoomOut_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_ZoomOut"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_PanAndRotate">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_PanAndRotateMap"/>
            <set_value name="$MapStartPosition" exact="player.holomap.camera.position"/>
            <set_value name="$MapStartRotation" exact="player.holomap.camera.rotation"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23008, $comment = 'You can also pan and rotate the view.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    15, $comment = 'Do so now.' ],
                        ],
            ]" />
            <unlock_all_holomap_input/>
          </actions>
          <cues>
            <cue name="Tutorial_Map_PanAndRotate_Done" checkinterval="1ms">
              <conditions>
                <check_any>
                  <check_value value="player.holomap.isopen and abs(player.holomap.camera.rotation.yaw - $MapStartRotation.yaw) gt 10deg"/>
                  <check_value value="player.holomap.isopen and abs(player.holomap.camera.rotation.pitch - $MapStartRotation.pitch) gt 10deg"/>
                </check_any>
                <check_value value="player.holomap.isopen and player.holomap.camera.position.distanceto.{$MapStartPosition} gt 50km"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    21, $comment = 'Good.' ],
                            ],
                  $callbackcue = Tutorial_Map_PanAndRotate_UseCase_Done,
                  $abortcallbackcue = Tutorial_Map_PanAndRotate_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Map_PanAndRotate_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_PanAndRotate"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_ResetView">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue cue="ShowHint_ResetViewOnMap"/>
            <show_help_overlay id="'map_resetview'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23009, $comment = 'If you ever get lost you can always return to your current location.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    16, $comment = 'Try it.' ],
                        ],
              $callbackcue = Tutorial_Map_ResetView_UseCase_Done,
              $abortcallbackcue = Tutorial_Map_ResetView_UseCase_Done,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Map_ResetView_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <cues>
                <cue name="Tutorial_Map_ResetView_Done" checkinterval="1ms">
                  <conditions>
                    <check_value value="player.holomap.isopen and player.holomap.focus == player.ship"/>
                  </conditions>
                  <actions>
                    <set_holomap_zoom value="100000"/>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <remove_help_overlay id="'map_resetview'"/>
                    <signal_cue cue="Tutorial_TriggerNext"/>
                    <cancel_cue cue="Tutorial_Map_ResetView"/>
                  </actions>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_SelectObject">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_SelectObjectOnMap"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23016, $comment = 'Select an object.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Map_SelectObject_Done" checkinterval="1ms">
              <conditions>
                <check_value value="player.holomap.targets.count"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23017, $comment = 'This selection is different from the target you select outside of the map.',
                                      $speakcallbackcue = Tutorial_Map_SelectObject_SetHUDTarget],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23018, $comment = 'I have marked the wharf as your HUD target so you can see the difference.' ],
                            ],
                  $callbackcue = Tutorial_Map_SelectObject_UseCase_Done,
                  $abortcallbackcue = Tutorial_Map_SelectObject_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Map_SelectObject_SetHUDTarget">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_player_target object="$Wharf"/>
              </actions>
            </cue>

            <cue name="Tutorial_Map_SelectObject_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_SelectObject"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_ClearSelection">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_ClearSelectionOnMap"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23019, $comment = 'Clear your selected object for now.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Map_ClearSelection_Done" checkinterval="1ms">
              <conditions>
                <check_value value="not player.holomap.targets.count"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23020, $comment = 'As you can see, this does not affect your HUD target.' ],
                            ],
                  $callbackcue = Tutorial_Map_ClearSelection_UseCase_Done,
                  $abortcallbackcue = Tutorial_Map_ClearSelection_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Map_ClearSelection_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_ClearSelection"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_Interact">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23021, $comment = 'Now interact with your ship.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Map_Interact_UpdateHint">
              <delay exact="1ms"/>
              <actions>
                <do_if value="player.holomap.targets.count">
                  <signal_cue cue="ShowHint_ClearSelectionOnMap"/>
                </do_if>
                <do_else>
                  <signal_cue cue="ShowHint_InteractOnMap"/>
                </do_else>
                <reset_cue cue="this"/>
              </actions>
            </cue>

            <cue name="Tutorial_Map_Interacted_WithSelection" instantiate="true">
              <conditions>
                <event_ui_triggered screen="'InteractMenu'" control="'id'"/>
              </conditions>
              <actions>
                <do_if value="player.holomap.targets.count">
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23022, $comment = 'Clear your selection first, then try again.' ],
                              ],
                  ]" />
                </do_if>
                <do_elseif value="component.{event.param3} != player.ship">
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    25, $comment = 'Right action, wrong target.' ],
                              ],
                  ]" />
                </do_elseif>
                <do_else>
                  <signal_cue cue="Tutorial_Map_Interact_Done"/>
                </do_else>
              </actions>
            </cue>

            <cue name="Tutorial_Map_Interact_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_Interact"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_InfoMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_SelectMenuItem"/>
            <show_help_overlay id="'interactmenu_info'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23023, $comment = 'Select information.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Map_InfoMenu_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'infomenu_open'"/>
                <check_value value="component.{event.param3} == player.ship"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'interactmenu_info'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23024, $comment = 'Here you can see some general information, as well as the ships pilot - you in this case - and cargo storage.' ],
                            ],
                  $callbackcue = Tutorial_Map_InfoMenu_UseCase_Done,
                  $abortcallbackcue = Tutorial_Map_InfoMenu_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Map_InfoMenu_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_InfoMenu"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_CrewMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_SelectMenuItem"/>
            <show_help_overlay id="'mapst_ao_info_crew'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23025, $comment = 'Take your time looking around, then open the highlighted menu at the top.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Map_CrewMenu_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'crewinfomenu_open'"/>
                <check_value value="component.{event.param3} == player.ship"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'mapst_ao_info_crew'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23026, $comment = 'Here you can see more details about the pilot, as well as the rest of the crew.' ],
                            ],
                  $callbackcue = Tutorial_Map_CrewMenu_UseCase_Done,
                  $abortcallbackcue = Tutorial_Map_CrewMenu_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Map_CrewMenu_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_CrewMenu"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_ServiceCrewInfo">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_SelectMenuItem"/>
            <show_help_overlay id="'info_crewperson'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23027, $comment = 'Expand the information of one of your service crew.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Map_ServiceCrewInfo_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'info_crewperson'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'info_crewperson'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23028, $comment = 'Now you can see a detailed overview of this persons skills.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23029, $comment = 'Sometimes individuals can have an aptitude outside of their current role and might be worth re-assigning to a different role.' ],
                            ],
                  $callbackcue = Tutorial_Map_ServiceCrewInfo_UseCase_Done,
                  $abortcallbackcue = Tutorial_Map_ServiceCrewInfo_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Map_ServiceCrewInfo_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_ServiceCrewInfo"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_CloseInfoMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_CloseSubMenu"/>
            <show_help_overlay id="'map_sidebar_information'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23030, $comment = 'You can assign roles, and perform other advanced actions, using the various tabs of this menu. Well cover those actions in later lessons.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    27, $comment = 'Close this menu to move on.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Map_CloseInfoMenu_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'info'"/>
                <check_value value="event.param3 == 'off'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'map_sidebar_information'"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_CloseInfoMenu"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_ObjectList">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_SelectMenuItem"/>
            <show_help_overlay id="'map_sidebar_objectlist'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23031, $comment = 'Open the object list.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Map_ObjectList_Opened">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'objectlist'"/>
                <check_value value="event.param3 != 'off'"/>
              </conditions>
              <cues>
                <cue name="Tutorial_Map_ObjectList_OpenedOnWrongTab">
                  <conditions>
                    <event_ui_triggered screen="'MapMenu'" control="'infoTableTab'"/>
                    <check_value value="event.param3 != 'objectall'"/>
                  </conditions>
                  <actions>
                    <remove_help_overlay id="'map_sidebar_objectlist'"/>
                    <show_help_overlay id="'mapst_ol_objectlist'" highlightonly="true"/>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22, $comment = 'Open the highlighted menu.' ],
                                ],
                    ]" />
                  </actions>
                </cue>

                <cue name="Tutorial_Map_ObjectList_Done">
                  <conditions>
                    <check_any>
                      <check_all>
                        <event_ui_triggered screen="'MapMenu'" control="'infoTableTab'" comment="event when opened together with object list"/>
                        <check_value value="event.param3 == 'objectall'"/>
                      </check_all>
                      <event_ui_triggered screen="'MapMenu'" control="'objectall'" comment="event when opened from another tab of the object list"/>
                    </check_any>
                  </conditions>
                  <actions>
                    <cancel_cue cue="Tutorial_Map_ObjectList_OpenedOnWrongTab"/>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <remove_help_overlay id="'map_sidebar_objectlist'"/>
                    <remove_help_overlay id="'mapst_ol_objectlist'"/>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23012, $comment = 'It lists all currently visible objects, with some sorting and filtering options.' ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23032, $comment = 'By default it shows you all ships and stations.' ],
                                ],
                      $callbackcue = Tutorial_Map_ObjectList_UseCase_Done,
                      $abortcallbackcue = Tutorial_Map_ObjectList_UseCase_Done,
                    ]" />
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_Map_ObjectList_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_ObjectList"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_DeployablesTab">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_SelectMenuItem"/>
            <show_help_overlay id="'mapst_ol_deployables'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23033, $comment = 'Open the menu that shows deployables.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Map_DeployablesTab_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'deployables'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'mapst_ol_deployables'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23034, $comment = 'It only lists a navigation beacon, not the satellite that is also nearby.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23035, $comment = 'Thats because the satellite is currently off screen.' ],
                            ],
                  $callbackcue = Tutorial_Map_DeployablesTab_UseCase_Done,
                  $abortcallbackcue = Tutorial_Map_DeployablesTab_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Map_DeployablesTab_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_DeployablesTab"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_ZoomOut_2">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_ZoomMap"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23036, $comment = 'Zoom out until the satellites icon is visible.' ],
                        ],
            ]" />
            <unlock_holomap_zoom_input/>
          </actions>
          <cues>
            <cue name="Tutorial_Map_ZoomOut_2_Done" checkinterval="1ms">
              <conditions>
                <check_value value="player.holomap.isopen and player.holomap.visibleobjects.indexof.{$Satellite}"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23037, $comment = 'Now that the satellites icon is visible, it is also listed in the menu.' ],
                            ],
                  $callbackcue = Tutorial_Map_ZoomOut_2_UseCase_Done,
                  $abortcallbackcue = Tutorial_Map_ZoomOut_2_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Map_ZoomOut_2_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_ZoomOut_2"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_InteractFromMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_InteractFromMapMenu"/>
            <show_help_overlay id="'interactmenu_deactivatesatellite'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23038, $comment = 'You can also select and interact with objects from the menu.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23039, $comment = 'Interact with the satellite and disable it.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Map_InteractFromMenu_Done" checkinterval="1ms">
              <conditions>
                <check_value value="not $Satellite.isactive"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'interactmenu_deactivatesatellite'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    21, $comment = 'Good.' ],
                            ],
                  $callbackcue = Tutorial_Map_InteractFromMenu_UseCase_Done,
                  $abortcallbackcue = Tutorial_Map_InteractFromMenu_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Map_InteractFromMenu_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_InteractFromMenu"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_PropertyOwned">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_SelectMenuItem"/>
            <show_help_overlay id="'map_sidebar_propertyowned'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23013, $comment = 'Open the property owned menu.' ],
                        ],
            ]" />
            <lock_all_holomap_input/>
            <set_holomap_target object="$Wharf"/>
            <set_holomap_zoom value="100000"/>
            <create_ship name="$FocusShip" macro="macro.ship_arg_s_scout_01_a_macro" sector="player.sector" capturable="false">
              <owner exact="faction.player" overridenpc="true"/>
              <pilot group="argon.pilot"/>
              <loadout ref="flightschool_s_scout"/>
              <safepos x="-240km"/>
            </create_ship>
            <create_order object="$FocusShip" id="'Wait'" default="true">
              <param name="fidget" value="true"/>
            </create_order>
          </actions>
          <cues>
            <cue name="Tutorial_Map_PropertyOwned_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'propertyowned'"/>
                <check_value value="event.param3 == 'on'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'map_sidebar_propertyowned'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23014, $comment = 'This menu list everything you own, even if the icon not currently on screen.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23040, $comment = 'That is why you can see another ship here, but not in the object list.' ],
                            ],
                  $callbackcue = Tutorial_Map_PropertyOwned_UseCase_Done,
                  $abortcallbackcue = Tutorial_Map_PropertyOwned_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Map_PropertyOwned_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_PropertyOwned"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_FocusCameraOnShip">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <substitute_text text="$FocusHintText" source="if player.input.controller then {1012, 100106} else {1012,100105}">
              <replace string="'$NAME$'" with="$FocusShip.name"/>
            </substitute_text>
            <signal_cue_instantly cue="SetHintText" param="$FocusHintText"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23041, $comment = 'Focus the camera on the other ship.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Map_FocusCameraOnShip_Done" checkinterval="1ms">
              <conditions>
                <check_value value="player.holomap.focus == $FocusShip"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23042, $comment = 'The camera will now follow your ship until you manually move it again.' ],
                            ],
                  $callbackcue = Tutorial_Map_FocusCameraOnShip_UseCase_Done,
                  $abortcallbackcue = Tutorial_Map_FocusCameraOnShip_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Map_FocusCameraOnShip_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_FocusCameraOnShip"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_ZoomWhileFocusedOnShip">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_ZoomAndRotateMap"/>
            <unlock_holomap_zoom_input/>
            <unlock_holomap_rotation_input/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23043, $comment = 'Zooming also keeps the camera focused on the ship now, and not on the cursor position.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    16, $comment = 'Try it.' ],
                        ],
            ]" />
            <set_value name="$ZoomStart" exact="player.holomap.camera.zoomdistance"/>
          </actions>
          <cues>
            <cue name="Tutorial_Map_ZoomWhileFocusedOnShip_Done" checkinterval="1ms">
              <conditions>
                <check_value value="abs(player.holomap.camera.zoomdistance - $ZoomStart) gt 1000"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_ZoomWhileFocusedOnShip"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_BreakFocusOnShip">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_PanMap"/>
            <unlock_all_holomap_input/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23044, $comment = 'To stop the camera from following the ship simply pan in any direction.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    15, $comment = 'Do so now.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Map_BreakFocusOnShip_Done" checkinterval="1ms">
              <conditions>
                <check_value value="not player.holomap.focus.exists"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23045, $comment = 'And those are the basics of using the map.' ],
                            ],
                  $callbackcue = Tutorial_Map_BreakFocusOnShip_UseCase_Done,
                  $abortcallbackcue = Tutorial_Map_BreakFocusOnShip_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Map_BreakFocusOnShip_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_BreakFocusOnShip"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Map_HelpOverlay">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_SelectMenuItem"/>
            <show_help_overlay id="'map_standardbutton_help'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23047, $comment = 'If you want a refresher on what certain menus do you can activate a help overlay with the highlighted button.' ],
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    15, $comment = 'Do so now.' ],
                          ],
              ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Map_HelpOverlay_Opened">
              <conditions>
                <event_ui_triggered screen="'helpoverlay'" control="'shown'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'map_standardbutton_help'"/>
                <signal_cue cue="ShowHint_HelpOverlay"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23048, $comment = 'Each highlighted button will now show you what its about.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23049, $comment = 'Use the button again to turn it off.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Map_HelpOverlay_Done">
              <conditions>
                <event_ui_triggered screen="'helpoverlay'" control="'hidden'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Map_HelpOverlay"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <library name="Tutorial_Missions_CreateShipHelper" purpose="run_actions">
          <params>
            <param name="macro"/>
            <param name="position"/>
            <param name="resultgroup"/>
          </params>
          <actions>
            <create_ship name="$ship" macro="$macro" sector="player.sector" capturable="false">
              <owner exact="faction.ownerless" overridenpc="true" />
              <pilot>
                <select race="race.drone" tags="tag.aipilot"/>
              </pilot>
              <safepos object="player.ship" value="$position"/>
            </create_ship>
            <create_order object="$ship" id="'Wait'" immediate="true">
              <param name="noattackresponse" value="true"/>
            </create_order>
            <add_to_group groupname="$resultgroup" object="$ship"/>
            <return value="$ship"/>
          </actions>
        </library>

        <cue name="Tutorial_Missions_InitialUseCaseAndSetup">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1130}"/>
            <lock_flight_throttle_input/>
            <lock_flight_strafe_input/>
            <set_value name="$MissionTargetMacro" exact="macro.ship_gen_xs_cargodrone_empty_01_a_macro"/>
            <create_group groupname="$Targets"/>
            <do_all exact="2" counter="$i">
              <run_actions ref="Tutorial_Missions_CreateShipHelper" result="$Target">
                <param name="macro" value="$MissionTargetMacro"/>
                <param name="position" value="position.[225m - 150m * $i, 50m, 500m]"/>
                <param name="resultgroup" value="$Targets"/>
              </run_actions>
            </do_all>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29001, $comment = 'Today well cover another important topic: missions.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29002, $comment = 'As a reminder, the current objective of the active mission is always shown in the message ticker.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29003, $comment = 'Right now the objective does not have a specific target.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29004, $comment = 'Lets change that.' ],
                        ],
              $callbackcue = Tutorial_Missions_InitialUseCaseAndSetup_Done,
              $abortcallbackcue = Tutorial_Missions_InitialUseCaseAndSetup_Done,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Missions_InitialUseCaseAndSetup_LimitMapZoom" instantiate="true">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'MapMenu'" control="''"/>
                </check_any>
              </conditions>
              <actions>
                <set_holomap_max_zoom value="500000"/>
              </actions>
            </cue>

            <cue name="Tutorial_Missions_InitialUseCaseAndSetup_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <!--not cancelling this cue on purpose-->
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Missions_SelectMissionTarget">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1136}" object="$Target"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29005, $comment = 'Ive now set one of the ships in front of you as the mission target.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29006, $comment = 'The yellow markings let you know which one it is.',
                                  $speakcallbackcue = ShowHint_SelectObject],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29007, $comment = 'Please select the mission target.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Missions_SelectMissionTarget_Done" checkinterval="1ms">
              <conditions>
                <check_value value="player.target == $Target"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    21, $comment = 'Good.' ],
                            ],
                  $callbackcue = Tutorial_Missions_SelectMissionTarget_UseCase_Done,
                  $abortcallbackcue = Tutorial_Missions_SelectMissionTarget_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Missions_SelectMissionTarget_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Missions_SelectMissionTarget"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Missions_TurnToOffScreenMissionTarget">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <run_actions ref="Tutorial_Missions_CreateShipHelper" result="$Target">
              <param name="macro" value="$MissionTargetMacro"/>
              <param name="position" value="position.[50m, 0m, -500m]"/>
              <param name="resultgroup" value="$Targets"/>
            </run_actions>
            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1012}" object="$Target"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29008, $comment = 'Ive now changed the mission target to a different ship.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29009, $comment = 'A yellow arrow near your crosshair points in its direction.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29010, $comment = 'It should be on the right side.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29011, $comment = 'Turn your ship until you see the mission target in front of you.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Missions_TurnToOffScreenMissionTarget_Done" checkinterval="1ms">
              <conditions>
                <set_value name="$targetpos" exact="$Target.relativeposition.{player.ship}"/>
                <check_value value="$targetpos.z gt 0m and abs($targetpos.x / $targetpos.z) lt 0.5 and abs($targetpos.y / $targetpos.z) lt 0.5"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    20, $comment = 'Well done.' ],
                            ],
                  $callbackcue = Tutorial_Missions_TurnToOffScreenMissionTarget_UseCase_Done,
                  $abortcallbackcue = Tutorial_Missions_TurnToOffScreenMissionTarget_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Missions_TurnToOffScreenMissionTarget_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Missions_TurnToOffScreenMissionTarget"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Missions_MissionTargetsOnMap">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29012, $comment = 'Mission targets are highlighted in the same yellow on the map.',
                                  $speakcallbackcue = Tutorial_Missions_SeveralMissionTargetsOnMap],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29013, $comment = 'And as you can see there can be more than one at a time.',
                                  $speakcallbackcue = Tutorial_Missions_ManyMissionTargetsOnMap],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29014, $comment = 'A lot more!' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29015, $comment = 'Targets dont always need to be objects, either.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29016, $comment = 'Some missions give you position or an area in space, like this.',
                                  $speakcallbackcue = Tutorial_Missions_SetFlyToObjective],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29017, $comment = 'What the radius means really depends on the mission.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29018, $comment = 'Maybe you need to find something somewhere in there, you need to cover the entire area with satellites.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29019, $comment = 'For now I just need to you to fly anywhere into that area.' ],
                        ],
              $callbackcue = Tutorial_Missions_MissionTargetsOnMap_Done,
              $abortcallbackcue = Tutorial_Missions_MissionTargetsOnMap_Done,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Missions_SeveralMissionTargetsOnMap">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1130}" group="$Targets"/>
              </actions>
            </cue>

            <cue name="Tutorial_Missions_ManyMissionTargetsOnMap">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <do_all exact="20" counter="$i">
                  <run_actions ref="Tutorial_Missions_CreateShipHelper" result="$Target">
                    <param name="macro" value="$MissionTargetMacro"/>
                    <param name="position" value="position.[-5km, 0m, 5km - 500m * $i]"/>
                    <param name="resultgroup" value="$Targets"/>
                  </run_actions>
                </do_all>
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1130}" group="$Targets"/>
              </actions>
            </cue>

            <cue name="Tutorial_Missions_SetFlyToObjective">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <destroy_group group="$Targets" explosion="false"/>
                <create_position name="$FlyToPos" z="-20km"/>
                <set_value name="$FlyToRadius" exact="5km"/>
                <set_objective cue="GameStart_Tutorial" action="objective.flyto" object="player.sector" offset="$FlyToPos" radius="$FlyToRadius"/>
                <set_holomap_zoom value="100000"/>
              </actions>
            </cue>

            <cue name="Tutorial_Missions_MissionTargetsOnMap_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Missions_MissionTargetsOnMap"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Missions_FlyToTargetArea">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <unlock_all_flight_input/>
          </actions>
          <cues>
            <cue name="Tutorial_Missions_FlyToTargetArea_Done" checkinterval="1ms">
              <conditions>
                <check_value value="player.ship.distanceto.[player.sector, $FlyToPos] lt $FlyToRadius"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    29, $comment = 'Alright.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Missions_FlyToTargetArea"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Missions_MissionOffer_1">
          <cues>
            <cue name="Tutorial_Missions_MissionOffer_1_Accepted">
              <conditions>
                <event_object_signalled object="$FlightInstructor" param="'accept'" param2="Tutorial_Missions_MissionOffer_1"/>
              </conditions>
              <actions>
                <create_mission cue="Tutorial_Missions_MissionOffer_1" offercue="Tutorial_Missions_MissionOffer_1" abortable="false"/>
                <set_objective_from_briefing cue="Tutorial_Missions_MissionOffer_1" step="1"/>
                <remove_offer cue="Tutorial_Missions_MissionOffer_1"/>
              </actions>
            </cue>

            <cue name="Tutorial_Missions_MissionOffer_1_Aborted">
              <conditions>
                <event_mission_aborted cue="Tutorial_Missions_MissionOffer_1"/>
              </conditions>
              <actions>
                <remove_mission cue="Tutorial_Missions_MissionOffer_1" type="tutorialcompleted"/>
              </actions>
            </cue>
          </cues>
        </cue>
        <cue name="Tutorial_Missions_MissionOffer_2">
          <cues>
            <cue name="Tutorial_Missions_MissionOffer_2_Accepted">
              <conditions>
                <event_object_signalled object="$FlightInstructor" param="'accept'" param2="Tutorial_Missions_MissionOffer_2"/>
              </conditions>
              <actions>
                <create_mission cue="Tutorial_Missions_MissionOffer_2" offercue="Tutorial_Missions_MissionOffer_2" abortable="false"/>
                <set_objective_from_briefing cue="Tutorial_Missions_MissionOffer_2" step="1"/>
                <remove_offer cue="Tutorial_Missions_MissionOffer_2"/>
              </actions>
            </cue>

            <cue name="Tutorial_Missions_MissionOffer_2_Aborted">
              <conditions>
                <event_mission_aborted cue="Tutorial_Missions_MissionOffer_2"/>
              </conditions>
              <actions>
                <remove_mission cue="Tutorial_Missions_MissionOffer_2" type="tutorialcompleted"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Missions_MissionOffers">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <force_player_speed speed="0"/>
            <create_offer cue="Tutorial_Missions_MissionOffer_1" type="missiontype.think" name="{30178,1133}" description="{30178,1134}" actor="$FlightInstructor" faction="$AlliedFaction" difficulty="level.easy">
              <briefing>
                <objective step="1" action="objective.custom" customaction="{30178,1130}" object="player.sector" offset="position.[-100km, 0m, 0m]"/>
              </briefing>
            </create_offer>
            <create_offer cue="Tutorial_Missions_MissionOffer_2" type="missiontype.think" name="{30178,1133}" description="{30178,1134}" actor="$FlightInstructor" faction="$AlliedFaction" difficulty="level.easy">
              <briefing>
                <objective step="1" action="objective.custom" customaction="{30178,1130}" object="player.sector" offset="position.[100km, 0m, 0m]"/>
              </briefing>
            </create_offer>
            <signal_cue cue="ShowHint_SelectMenuItem"/>
            <show_help_overlay id="'map_sidebar_mission_offers'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    22, $comment = 'Open the highlighted menu.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Missions_MissionOffers_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'missionoffer'"/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'map_sidebar_mission_offers'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29020, $comment = 'This menu shows you any mission offers you know of.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29021, $comment = 'Some are broadcast widely, most are more local.' ],
                            ],
                  $callbackcue = Tutorial_Missions_MissionOffers_UseCase_Done,
                  $abortcallbackcue = Tutorial_Missions_MissionOffers_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Missions_MissionOffers_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Missions_MissionOffers"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Missions_MissionOffers_SelectOffer">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="Tutorial_Missions_MissionOffer_1.hasmission and Tutorial_Missions_MissionOffer_2.hasmission">
              <signal_cue cue="Tutorial_Missions_MissionOffers_Select_UseCase_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="SetHintID" param="[100222, 100223]" comment="{1012, 100222} or {1012, 100223}"/>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29022, $comment = 'Select one of the mission offers.' ],
                          ],
              ]" />
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_Missions_MissionOffers_Select_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'mission_context'"/>
                <check_value value="event.param3 == Tutorial_Missions_MissionOffer_1 or event.param3 == Tutorial_Missions_MissionOffer_2"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29023, $comment = 'You can now see its title, description, and objectives.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29024, $comment = 'The map also temporarily shows you guidance for the mission youve selected.' ],
                            ],
                  $callbackcue = Tutorial_Missions_MissionOffers_Select_UseCase_Done,
                  $abortcallbackcue = Tutorial_Missions_MissionOffers_Select_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Missions_MissionOffers_Select_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Missions_MissionOffers_SelectOffer"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Missions_MissionOffers_Accept">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="Tutorial_Missions_MissionOffer_1.hasmission and Tutorial_Missions_MissionOffer_2.hasmission">
              <signal_cue cue="PlayerAlreadyKnewUseCase"/>
              <signal_cue cue="Tutorial_Missions_MissionOffers_Accept_UseCase_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="SetHintID" param="[100225, 100226]" comment="{1012, 100225} or {1012, 100226}"/>
              <show_help_overlay id="'map_acceptmission'" highlightonly="true"/>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29025, $comment = 'Accept both missions.' ],
                          ],
              ]" />
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_Missions_MissionOffers_Accept_Done" checkinterval="1ms">
              <conditions>
                <check_value value="Tutorial_Missions_MissionOffer_1.hasmission and Tutorial_Missions_MissionOffer_2.hasmission"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'map_acceptmission'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    21, $comment = 'Good.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29026, $comment = 'You may have noticed that you no longer see the mission area being marked.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29027, $comment = 'Thats because you can only see guidance for one mission at a time, and accepting a mission automatically activates it.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29028, $comment = 'This doesnt mean that inactive missions are paused.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29029, $comment = 'You can still progress and even complete them while theyre inactive.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29030, $comment = 'And of course you can choose which mission should be active at any time.' ],
                            ],
                  $callbackcue = Tutorial_Missions_MissionOffers_Accept_UseCase_Done,
                  $abortcallbackcue = Tutorial_Missions_MissionOffers_Accept_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Missions_MissionOffers_Accept_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'map_acceptmission'"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Missions_MissionOffers_Accept"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Missions_MissionManager">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_SelectMenuItem"/>
            <show_help_overlay id="'map_sidebar_mission_accepted'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    22, $comment = 'Open the highlighted menu.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Missions_MissionManager_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'mission'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'map_sidebar_mission_accepted'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29031, $comment = 'Here you can see all of your accepted missions.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29032, $comment = 'The active mission is shown in yellow.' ],
                            ],
                  $callbackcue = Tutorial_Missions_MissionManager_UseCase_Done,
                  $abortcallbackcue = Tutorial_Missions_MissionManager_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Missions_MissionManager_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Missions_MissionManager"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Missions_ActivateTrainingMission">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100228, 100229]" comment="{1012, 100228} or {1012, 100229}"/>
            <show_help_overlay id="'map_activatemission'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29033, $comment = 'Select the inactive training mission and activate it.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Missions_ActivateTrainingMission_WrongMission">
              <conditions>
                <check_any>
                  <event_guidance_enabled cue="GameStart_Tutorial"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    25, $comment = 'Right action, wrong target.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Missions_ActivateTrainingMission_Done">
              <conditions>
                <check_any>
                  <event_guidance_enabled cue="Tutorial_Missions_MissionOffer_1"/>
                  <event_guidance_enabled cue="Tutorial_Missions_MissionOffer_2"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'map_activatemission'"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Missions_ActivateTrainingMission"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Missions_AbortMissions">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <update_mission cue="Tutorial_Missions_MissionOffer_1" abortable="true"/>
            <update_mission cue="Tutorial_Missions_MissionOffer_2" abortable="true"/>
            <signal_cue_instantly cue="SetHintID" param="[100231, 100232]" comment="{1012, 100231} or {1012, 100232}"/>
            <show_help_overlay id="'map_abortmission'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    21, $comment = 'Good.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29034, $comment = 'Now abort both training missions.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Missions_AbortMissions_Done" checkinterval="1ms">
              <conditions>
                <check_value value="not Tutorial_Missions_MissionOffer_1.hasmission and not Tutorial_Missions_MissionOffer_2.hasmission"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'map_abortmission'"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Missions_AbortMissions"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Missions_ActivateMainMission">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <show_help_overlay id="'map_activatemission'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintID" param="[100234, 100235]" comment="{1012, 100234} or {1012, 100235}"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29035, $comment = 'You have no guidance now!' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29036, $comment = 'This is because a mission ending does not automatically activate another mission.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29037, $comment = 'Activate the remaining mission yourself, please.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Missions_ActivateMainMission_Done">
              <conditions>
                <event_guidance_enabled cue="GameStart_Tutorial"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'map_activatemission'"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Missions_ActivateMainMission"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Missions_SetGuidance">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100237, 100238]" comment="{1012, 100237} or {1012, 100238}"/>
            <find_sector name="$sector" macro="macro.basegame_map_tutorial_default_two_clusters_cluster_001_sector_001_macro"/>
            <create_station name="$GuidanceStation" macro="macro.station_gen_factory_base_01_macro" owner="$AlliedFaction" sector="$sector" state="componentstate.operational" constructionplan="'arg_defence'">
              <safepos z="50km"/>
              <rotation yaw="45deg"/>
            </create_station>
            <set_known object="$sector" known="true"/>
            <set_known object="$sector.cluster" known="true"/>
            <set_known object="$GuidanceStation" known="true" updatesnapshot="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    21, $comment = 'Good.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29038, $comment = 'Now please zoom out, find the station in the other sector, and interact with it.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Missions_SetGuidance_Interacted">
              <conditions>
                <event_ui_triggered screen="'InteractMenu'" control="'id'"/>
              </conditions>
              <actions>
                <do_if value="component.{event.param3} == $GuidanceStation">
                  <signal_cue_instantly cue="ClearHintID"/>
                  <show_help_overlay id="'interactmenu_guidance'" highlightonly="true"/>
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29039, $comment = 'Select Start Guidance To Object.' ],
                              ],
                  ]" />
                </do_if>
                <do_else>
                  <remove_help_overlay id="'interactmenu_guidance'"/>
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    25, $comment = 'Right action, wrong target.' ],
                              ],
                  ]" />
                  <reset_cue cue="this"/>
                </do_else>
              </actions>
            </cue>

            <cue name="Tutorial_Missions_SetGuidance_Done">
              <conditions>
                <event_object_signalled object="player.entity" param="'set guidance'"/>
                <check_value value="event.param2.{1} == $GuidanceStation"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'interactmenu_guidance'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29040, $comment = 'This isnt really a mission, but guidance is now temporarily switched to lead you to this station.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29041, $comment = 'Or rather, it would do that if you knew the way!' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29042, $comment = 'Your computer doesnt have the necessary jumpgate in its database, so its showing you that you need to find it to proceed.',
                                      $speakcallbackcue = Tutorial_Missions_SetGuidance_MarkGate],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29043, $comment = 'Im marking the gates location on the map.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29044, $comment = 'Look for a question mark.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29045, $comment = 'Close the map and fly to it.' ],
                            ],
                  $callbackcue = Tutorial_Missions_SetGuidance_UseCase_Done,
                  $abortcallbackcue = Tutorial_Missions_SetGuidance_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Missions_SetGuidance_MarkGate">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <find_gate name="$GuidanceIntermediateGate" space="player.sector"/>
                <set_object_long_range_scanned object="$GuidanceIntermediateGate" scanned="true"/>
                <set_holomap_target object="$GuidanceIntermediateGate"/>
                <set_holomap_zoom value="500000" instant="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_Missions_SetGuidance_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Missions_SetGuidance"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Missions_FlyToGuidanceTarget">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="$GuidanceIntermediateGate.isknown">
              <signal_cue cue="Tutorial_Missions_FlyToGuidanceTarget_GateKnown"/>
            </do_if>
          </actions>
          <cues>
            <cue name="Tutorial_Missions_FlyToGuidanceTarget_GateKnown">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_object_known_to_player object="$GuidanceIntermediateGate"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29046, $comment = 'Now that the gate is in range, the computer has automatically added it to the database and updated guidance to lead you through it.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29047, $comment = 'Follow guidance until youre at the destination.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Missions_FlyToGuidanceTarget_Done">
              <conditions>
                <event_object_signalled object="player.computer" param="'guidance_ended'" />
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.flyto" object="player.sector" offset="$FlyToPos" radius="$FlyToRadius"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    20, $comment = 'Well done.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29048, $comment = 'Unlike actual missions, this one has automatically switched back to giving you guidance for the previously active mission.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29049, $comment = 'You can also get this kind of guidance by asking people for directions to certian locations or people.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    30, $comment = 'And thats it for this lesson.' ],
                            ],
                  $callbackcue = Tutorial_Missions_FlyToGuidanceTarget_UseCase_Done,
                  $abortcallbackcue = Tutorial_Missions_FlyToGuidanceTarget_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Missions_FlyToGuidanceTarget_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Missions_FlyToGuidanceTarget"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Orders_InitialUseCaseAndSetup">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <create_ship name="$ScoutShip" macro="macro.ship_arg_s_scout_01_a_macro" sector="player.sector" capturable="false">
              <owner exact="faction.player" overridenpc="true"/>
              <pilot group="argon.pilot"/>
              <loadout ref="flightschool_s_scout"/>
              <safepos z="2km" object="player.ship" space="player.sector" allowyaxis="false"/>
            </create_ship>
            <set_skill entity="$ScoutShip.pilot" type="skilltype.piloting" exact="3"/>
            <set_skill entity="$ScoutShip.pilot" type="skilltype.morale" exact="15"/>
            <set_object_sellable object="$ScoutShip" sellable="false"/>
            <disable_travel_mode ship="$ScoutShip" duration="100h"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20001, $comment = 'Today well go over how to properly set up orders.' ],
                            ],
                  $callbackcue = Tutorial_Orders_InitialUseCaseAndSetup_Done,
                  $abortcallbackcue = Tutorial_Orders_InitialUseCaseAndSetup_Done,
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Orders_InitialUseCaseAndSetup_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Orders_InitialUseCaseAndSetup"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Orders_SelectScout">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_SelectScoutOnMap"/>
            <signal_cue cue="Tutorial_Orders_KeepScoutSelected"/>
          </actions>
          <cues>
            <cue name="Tutorial_Orders_SelectScout_Done" checkinterval="1ms">
              <conditions>
                <check_value value="player.holomap.isopen and player.holomap.targets.indexof.{$ScoutShip}"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <cancel_cue cue="Tutorial_Orders_SelectScout"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Orders_KeepScoutSelected">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <cues>
            <cue name="Tutorial_Orders_CheckScoutSelected" checkinterval="1ms">
              <conditions>
                <check_value value="player.holomap.isopen and not player.holomap.targets.indexof.{$ScoutShip} and (not $LastSelectScoutShipUseCaseTime? or player.age gt $LastSelectScoutShipUseCaseTime + 10s)"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20002, $comment = 'Select the scout ship.' ],
                            ],
                  $callbackcue = Tutorial_Orders_InitialUseCaseAndSetup_Done,
                  $abortcallbackcue = Tutorial_Orders_InitialUseCaseAndSetup_Done,
                ]" />
                <set_holomap_target object="$ScoutShip"/>
                <set_value name="$LastSelectScoutShipUseCaseTime" exact="player.age"/>
                <reset_cue cue="this"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Orders_GiveFirstOrder">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_value name="$OrderDestinationPos" exact="position.[-100km, 0m, -100km]"/>
            <set_value name="$OrderDestinationRadius" exact="50km"/>
            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1132}" object="player.sector" offset="$OrderDestinationPos" radius="$OrderDestinationRadius"/>
            <signal_cue cue="ShowHint_GiveFlyToAreaOrderOnMap"/>
            <show_help_overlay id="'interactmenu_flyto'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20003, $comment = 'Now interact with the marked position inside the sector and select fly and wait.' ],
                            ],
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Orders_GiveFirstOrder_InteractMenu" instantiate="true">
              <conditions>
                <event_ui_triggered screen="'InteractMenu'"/>
                <check_value value="event.param2 != ''"/>
              </conditions>
              <actions>
                <do_if value="event.param2 == 'id'">
                  <do_if value="not component.{event.param3}.isclass.sector">
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    25, $comment = 'Right action, wrong target.' ],
                                ],
                    ]" />
                  </do_if>
                </do_if>
                <do_elseif value="event.param2 == 'flyto'">
                  <do_if value="$ScoutShip.order.$destination.{2}.distanceto.{$OrderDestinationPos} lt $OrderDestinationRadius">
                    <signal_cue cue="Tutorial_Orders_GiveFirstOrder_Done"/>
                    <cancel_cue cue="this"/>
                  </do_if>
                  <do_else>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    25, $comment = 'Right action, wrong target.' ],
                                ],
                    ]" />
                  </do_else>
                </do_elseif>
                <do_else>
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    25, $comment = 'Right action, wrong target.' ],
                              ],
                  ]" />
                </do_else>
              </actions>
            </cue>

            <cue name="Tutorial_Orders_GiveFirstOrder_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'interactmenu_flyto'"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20004, $comment = 'Your scout ship will fly to this position.' ],
                            ],
                  $callbackcue = Tutorial_Orders_GiveFirstOrder_UseCase_Done,
                  $abortcallbackcue = Tutorial_Orders_GiveFirstOrder_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Orders_GiveFirstOrder_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_Orders_GiveFirstOrder"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Orders_GiveSecondOrder">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20005, $comment = 'You can give several orders in a row, which will be executed in the order theyre given.',
                                      $speakcallbackcue = Tutorial_Orders_GiveSecondOrder_Hint],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20006, $comment = 'Add a second fly and wait order anywhere youd like.' ],
                            ],
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Orders_GiveSecondOrder_Hint">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_GiveOrderOnMap"/>
                <show_help_overlay id="'interactmenu_flyto'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_Orders_GiveSecondOrder_Done">
              <conditions>
                <event_ui_triggered screen="'InteractMenu'" control="'flyto'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'interactmenu_flyto'"/>
                <cancel_cue cue="Tutorial_Orders_GiveSecondOrder"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Orders_DragOrder">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_value name="$OrderDestinationPos" exact="position.[-100km, 0m, 0m]"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20007, $comment = 'You can move some orders around by dragging the order icon.',
                                      $speakcallbackcue = Tutorial_Orders_DragOrder_HintAndObjective],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    16, $comment = 'Try it.' ],
                            ],
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Orders_DragOrder_HintAndObjective">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_DragActiveOrder"/>
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1127}" object="player.sector" offset="$OrderDestinationPos" radius="$OrderDestinationRadius"/>
              </actions>
            </cue>

            <cue name="Tutorial_Orders_DragOrder_Done" checkinterval="1ms">
              <conditions>
                <check_value value="$ScoutShip.order.$destination.{2}.distanceto.{$OrderDestinationPos} lt $OrderDestinationRadius"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <cancel_cue cue="Tutorial_Orders_DragOrder"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Orders_DragOrderLine">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_DragOrderLine"/>
            <set_value name="$NumOrders" exact="$ScoutShip.orders.count"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20022, $comment = 'You can also quickly insert waypoints between orders.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20023, $comment = 'Useful for navigating around hazards, for example.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    15, $comment = 'Do so now.' ],
                            ],
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Orders_DragOrderLine_Done" checkinterval="1ms">
              <conditions>
                <check_value value="$ScoutShip.orders.count gt $NumOrders"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <cancel_cue cue="Tutorial_Orders_DragOrderLine"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Orders_DragOrderVertically">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_DragOrderVertically"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20024, $comment = 'Its also possible to change the elevation of an order location.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    16, $comment = 'Try it.' ],
                            ],
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Orders_DragOrderVertically_Done" checkinterval="1ms">
              <conditions>
                <check_value value="abs($ScoutShip.order.$destination.{2}.y) gt 10m"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    29, $comment = 'Alright.' ],
                                ],
                      $callbackcue = Tutorial_Orders_DragOrderVertically_UseCase_Done,
                      $abortcallbackcue = Tutorial_Orders_DragOrderVertically_UseCase_Done,
                    ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Orders_DragOrderVertically_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_Orders_DragOrderVertically"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Orders_RemoveOrder">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20009, $comment = 'You can interact with an order, or the line leading to it, and remove it from the context menu.',
                                  $speakcallbackcue = Tutorial_Orders_RemoveOrder_Hint],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    15, $comment = 'Do so now.' ],
                        ],
            ]" />
            <set_value name="$Tutorial_Orders_RemoveOrder_InitialOrderCount" exact="$ScoutShip.orders.count"/>
          </actions>
          <cues>
            <cue name="Tutorial_Orders_RemoveOrder_Hint">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_InteractWithOrder"/>
                <show_help_overlay id="'interactmenu_removethisorder'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_Orders_RemoveOrder_Done" checkinterval="1ms">
              <conditions>
                <check_value value="$Tutorial_Orders_RemoveOrder_InitialOrderCount == 0 or $ScoutShip.orders.count lt $Tutorial_Orders_RemoveOrder_InitialOrderCount"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'interactmenu_removethisorder'"/>
                <cancel_cue cue="Tutorial_Orders_RemoveOrder"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Orders_RemoveLastOrder">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20010, $comment = 'If you remove the active order then the next one in the queue will be executed right away.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20011, $comment = 'If you remove the last queued order then the ship goes to its default behaviour.',
                                      $speakcallbackcue = Tutorial_Orders_RemoveLastOrder_Hint],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    15, $comment = 'Do so now.' ],
                            ],
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Orders_RemoveLastOrder_Hint">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_InteractWithOrder"/>
                <show_help_overlay id="'interactmenu_removeallorders'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_Orders_RemoveLastOrder_Done">
              <conditions>
                <event_object_order_cancelled object="$ScoutShip"/>
                <check_value value="$ScoutShip.orders.count == 0"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'interactmenu_removeallorders'"/>
                <cancel_cue cue="Tutorial_Orders_RemoveLastOrder"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Orders_OpenInfoMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <show_help_overlay id="'map_sidebar_information'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20012, $comment = 'Lets change that default behaviour.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20013, $comment = 'Open the scout ships info menu.' ],
                            ],
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Orders_OpenInfoMenu_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'info'"/>
                <check_value value="event.param3 != 'layer_other'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'map_sidebar_information'"/>
                <cancel_cue cue="Tutorial_Orders_OpenInfoMenu"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Orders_OpenBehaviourTab">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <show_help_overlay id="'mapst_ao_orderqueue'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20014, $comment = 'Select the behaviour tab.' ],
                            ],
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Orders_UseCase_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'orderqueue'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'mapst_ao_orderqueue'"/>
                <cancel_cue cue="Tutorial_Orders_OpenBehaviourTab"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Orders_SelectDefaultBehaviour">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <show_help_overlay id="'map_behaviourassignement'" highlightonly="true"/>
            <show_help_overlay id="'map_order_ExploreUpdate'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20015, $comment = 'At the bottom you can see its current default behaviour.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20016, $comment = 'Click on it and select Revisit known stations.' ],
                            ],
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Orders_SelectDefaultBehaviour_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'ExploreUpdate'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'map_behaviourassignement'"/>
                <remove_help_overlay id="'map_order_ExploreUpdate'"/>
                <cancel_cue cue="Tutorial_Orders_SelectDefaultBehaviour"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Orders_SelectBehaviourSpace">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <show_help_overlay id="'orderparam_destination'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20017, $comment = 'Next you need to tell it the space to work in.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20018, $comment = 'Select the empty field and then click anywhere in the current sector.' ],
                            ],
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Orders_SelectBehaviourSpace_ButtonPressed">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'orderparam_destination'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'orderparam_destination'"/>
              </actions>
            </cue>

            <cue name="Tutorial_Orders_SelectBehaviourSpace_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'orderparam_position'"/>
                <check_value value="event.param3 != null"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'orderparam_destination'"/>
                <cancel_cue cue="Tutorial_Orders_SelectBehaviourSpace"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Orders_ConfirmDefaultBehaviour">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <show_help_overlay id="'map_confirmdefaultorder'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20019, $comment = 'You can leave the radius at the default value, or reduce it for a narrower operating area.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20020, $comment = 'Now the most important part: select confirm to actually set this as the default behaviour.' ],
                            ],
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Orders_ConfirmDefaultBehaviour_Done" checkinterval="1ms">
              <conditions>
                <check_value value="$ScoutShip.defaultorder.id == 'ExploreUpdate'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'map_confirmdefaultorder'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20021, $comment = 'You can still give this ship any other order youd like; once those are completed it will return here and revisit all known stations.' ],
                            ],
                  $callbackcue = Tutorial_Orders_ConfirmDefaultBehaviour_UseCase_Done,
                  $abortcallbackcue = Tutorial_Orders_ConfirmDefaultBehaviour_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Orders_ConfirmDefaultBehaviour_UseCase_Done" checkinterval="1ms">
              <conditions>
                <check_value value="$ScoutShip.defaultorder.id == 'ExploreUpdate'"/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_Orders_KeepScoutSelected"/>
                <cancel_cue cue="Tutorial_Orders_ConfirmDefaultBehaviour"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradePersonal_Init">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <find_station name="$PowerPlant" space="player.sector">
              <match_products wares="ware.energycells"/>
            </find_station>
            <add_cargo object="$PowerPlant" ware="ware.energycells" exact="900000"/>
            <find_station name="$Factory" space="player.sector">
              <match_resources wares="ware.energycells"/>
            </find_station>
            <add_cargo object="$Factory" ware="ware.foodrations" exact="50000"/>
            <add_cargo object="$Factory" ware="ware.meat" exact="37000"/>
            <add_cargo object="$Factory" ware="ware.wheat" exact="37000"/>
            <add_cargo object="$Factory" ware="ware.spices" exact="37000"/>
            <add_cargo object="$Factory" ware="ware.dronecomponents" exact="8" comment="for drone supply"/>
            <add_cargo object="$Factory" ware="ware.energycells" exact="1000" comment="for drone supply"/>
            <add_cargo object="$Factory" ware="ware.smartchips" exact="80" comment="for drone supply"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24001, $comment = 'Lets trade!' ],
                            ],
                  $callbackcue = Tutorial_TradePersonal_Init_Done,
                  $abortcallbackcue = Tutorial_TradePersonal_Init_Done,
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_TradePersonal_Init_Done">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_TradePersonal_Init"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradePersonal_ActivateTradeFilter">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <set_holomap_zoom value="150000" instant="true"/>
            <do_if value="player.holomap.isopen and player.holomap.tradefilter.active">
              <signal_cue cue="Tutorial_TradePersonal_ActivateTradeFilter_Done"/>
            </do_if>
            <do_else>
              <show_help_overlay id="'toggle_trade'" highlightonly="true"/>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24002, $comment = 'Now activate the Trade filter.' ],
                              ],
                  ]" />
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_TradePersonal_ActivateTradeFilter_Done">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'MapMenu'" control="'layer_trade_toggle'"/>
                </check_any>
              </conditions>
              <actions>
                <remove_help_overlay id="'toggle_trade'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24003, $comment = 'You can see several trade offers for wares bought and sold by this station.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24004, $comment = 'Between the name and the current price you can see a rough indication of the amount.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24005, $comment = 'One means itll be enough for a small courier, two will fill a medium transporter, and three will fill a large freighter.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24006, $comment = 'If you hover over the line you can see the exact amount.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24007, $comment = 'Now you could just go and buy what this station is offering, but who knows where youd be able to sell it?' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24008, $comment = 'Lets check out the other station.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    37, $comment = 'Close the map.' ],
                            ],
                  $callbackcue = Tutorial_TradePersonal_ActivateTradeFilter_UseCaseDone,
                  $abortcallbackcue = Tutorial_TradePersonal_ActivateTradeFilter_UseCaseDone,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_TradePersonal_ActivateTradeFilter_UseCaseDone">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_TradePersonal_ActivateTradeFilter"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradePersonal_FlyToOtherStation">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_objective cue="GameStart_Tutorial" action="objective.flyto" object="$PowerPlant"/>
            <do_if value="player.activity != activity.travel">
              <signal_cue cue="ShowHint_ActivateTravelMode"/>
            </do_if>
          </actions>
          <cues>
            <cue name="Tutorial_TradePersonal_FlyToOtherStation_TravelModeActivated">
              <conditions>
                <check_any>
                  <event_player_travelmode_charge_started/>
                  <event_player_travelmode_started/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
              </actions>
            </cue>

            <cue name="Tutorial_TradePersonal_FlyToOtherStation_Done" checkinterval="1ms">
              <conditions>
                <check_value value="$PowerPlant.isinliveview"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <cancel_cue cue="Tutorial_TradePersonal_FlyToOtherStation"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradePersonal_ExplainTradeOffers">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <disable_travel_mode ship="$PlayerShip" duration="1s"/>
            <set_playership_throttle value="0"/>
            <set_holomap_target object="$PowerPlant"/>
            <set_holomap_zoom value="150000"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24009, $comment = 'Now that youre in range, you can see this stations trade offers as well.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24010, $comment = 'You can also still see the previous ones.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24011, $comment = 'They do expire eventually, though.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24012, $comment = 'There are several ways to keep them up-to-date.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24013, $comment = 'You can place satellites near them, for example.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24014, $comment = 'You can also order your ships to update trade offers in a sector.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24015, $comment = 'But we dont need to worry about that today.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24016, $comment = 'Lets see if we can make a lucrative trade run.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24017, $comment = 'Looks like the energy cells being produced here are in high demand at the other station.',
                                      $speakcallbackcue = Tutorial_TradePersonal_DockAtPowerPlant_Objective ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    37, $comment = 'Close the map.' ],
                            ],
                  $callbackcue = Tutorial_TradePersonal_ExplainTradeOffers_Done,
                  $abortcallbackcue = Tutorial_TradePersonal_ExplainTradeOffers_Done,
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_TradePersonal_ExplainTradeOffers_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_TradePersonal_ExplainTradeOffers"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradePersonal_DockAtPowerPlant">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_if value="player.ship.container == $PowerPlant">
              <signal_cue cue="Tutorial_TradePersonal_DockAtPowerPlant_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24018, $comment = 'Dock at the power plant.' ],
                              ],
                  ]" />
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_TradePersonal_DockAtPowerPlant_Objective">
              <conditions>
                <event_cue_signalled/>
                <check_value value="player.ship.container != $PowerPlant"/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.dockat" object="$PowerPlant"/>
              </actions>
            </cue>

            <cue name="Tutorial_TradePersonal_DockAtPowerPlant_Done">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_object_docked_at container="$PowerPlant"/>
                </check_any>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <cancel_cue cue="Tutorial_TradePersonal_DockAtPowerPlant"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradePersonal_OpenTradeMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <show_help_overlay id="'docked_trade'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24019, $comment = 'Now select trade.' ],
                            ],
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_TradePersonal_OpenTradeMenu_Done">
              <conditions>
                <event_ui_triggered screen="'DockedMenu'" control="'docked_trade'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'docked_trade'"/>
                <cancel_cue cue="Tutorial_TradePersonal_OpenTradeMenu"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradePersonal_Buy">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="ShowHint_BuyWare"/>
            <show_help_overlay id="'map_confirmtrade'" highlightonly="true"/>
            <set_objective cue="GameStart_Tutorial" action="objective.buy" text="ware.energycells.name" object="$PowerPlant"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24020, $comment = 'Select the energy cells and move the slider to the left to buy them.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24021, $comment = 'Confirm the trade when youre done.' ],
                            ],
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_TradePersonal_Buy_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'confirmtrade'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="SetHintPosition" param="1"/>
                <remove_help_overlay id="'map_confirmtrade'"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <cancel_cue cue="Tutorial_TradePersonal_Buy"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradePersonal_WaitForWares">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24022, $comment = 'The wares are now being transferred.' ],
                            ],
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_TradePersonal_WaitForWares_Done">
              <conditions>
                <event_trade_completed buyer="$PlayerShip" seller="$PowerPlant"/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_TradePersonal_WaitForWares"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradePersonal_DockAtFactory">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_objective cue="GameStart_Tutorial" action="objective.dockat" object="$Factory"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24023, $comment = 'Now undock and fly to dock at the other station.' ],
                            ],
                ]" />
            <do_if value="player.ship.container == $Factory">
              <signal_cue cue="Tutorial_TradePersonal_DockAtFactory_Done"/>
            </do_if>
          </actions>
          <cues>
            <cue name="Tutorial_TradePersonal_DockAtFactory_Done">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_object_docked_at container="$Factory"/>
                </check_any>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <cancel_cue cue="Tutorial_TradePersonal_DockAtFactory"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradePersonal_Sell">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_objective cue="GameStart_Tutorial" action="objective.sell" text="ware.energycells.name" object="$Factory"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24024, $comment = 'Open the trade menu again, but this time drag the slider to the right to sell the wares.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24025, $comment = 'Confirm the trade when youre done.' ],
                            ],
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_TradePersonal_Sell_Done">
              <conditions>
                <event_trade_completed seller="$PlayerShip" buyer="$Factory"/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <cancel_cue cue="Tutorial_TradePersonal_Sell"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradePersonal_FinalUseCase">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24026, $comment = 'There we go, a successful and quite profitable trade run!' ],
                            ],
                  $callbackcue = Tutorial_TradePersonal_FinalUseCase_Done,
                  $abortcallbackcue = Tutorial_TradePersonal_FinalUseCase_Done,
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_TradePersonal_FinalUseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_TradePersonal_FinalUseCase"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradeOrder_InitialUseCaseAndSetup">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <find_object_component name="$StartCorridor" object="player.room.dynamicinterior" macro="macro.room_arg_corridor_01_macro"/>
            <set_triggers_locked object="$StartCorridor" group="tag.door_01" locked="true"/>
            <create_ship name="$TransportShip" macro="macro.ship_arg_m_trans_container_01_a_macro" sector="player.sector" capturable="false">
              <owner exact="faction.argon" overridenpc="true" />
              <pilot group="argon.pilot"/>
              <loadout ref="flightschool_m_transporter" />
              <safepos allowyaxis="false"/>
            </create_ship>
            <set_skill entity="$TransportShip.pilot" type="skilltype.piloting" exact="0"/>
            <set_skill entity="$TransportShip.pilot" type="skilltype.morale" exact="15"/>
            <create_order object="$TransportShip" id="'Wait'" default="true"/>
            <find_station groupname="$stations" multiple="true" space="player.sector"/>
            <do_for_each name="$station" in="$stations">
              <do_for_each name="$ware" in="$station.products.list">
                <do_if value="$ware == ware.energycells">
                  <set_value name="$PowerPlant" exact="$station"/>
                </do_if>
                <do_else>
                  <add_to_group groupname="$Factories" object="$station"/>
                </do_else>
                <add_cargo object="$station" ware="$ware" exact="$station.cargo.{$ware}.target"/>
              </do_for_each>
              <do_for_each name="$ware" in="$station.resources.list">
                <do_if value="$ware != ware.energycells">
                  <add_cargo object="$station" ware="$ware" exact="$station.cargo.{$ware}.target"/>
                </do_if>
              </do_for_each>
            </do_for_each>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24027, $comment = 'Lets scale up our trading.' ],
                        ],
              $callbackcue = Tutorial_TradeOrder_InitialUseCaseAndSetup_Done,
              $abortcallbackcue = Tutorial_TradeOrder_InitialUseCaseAndSetup_Done,
            ]" />
          </actions>
          <cues>
            <!--disabled because some menu stuff isn't possible - also, this might actually make much more sense in the advanced orders tutorial!-->
            <!--<cue name="Tutorial_TradeOrder_SelectTransporterAgain">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24051, $comment = 'Once youve identified a lucrative trade route youll want to take advantage of it as much as you can.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24052, $comment = 'But it can get really tedious to manually give dozens of trade orders.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24053, $comment = 'So lets set up a trade loop!' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24054, $comment = 'Select your trade ship.',
                                      $speakcallbackcue = Tutorial_TradeOrder_SelectTransporterAgain_Objective],
                            ],
                ]" />
              </actions>
              <cues>
                <cue name="Tutorial_TradeOrder_SelectTransporterAgain_Objective">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1126}" object="$TransportShip"/>
                  </actions>
                </cue>

                <cue name="Tutorial_TradeOrder_TransporterSelectedAgain" checkinterval="1ms">
                  <conditions>
                    <check_value value="player.holomap.isopen and player.holomap.targets.indexof.{$TransportShip}"/>
                  </conditions>
                  <actions>
                    <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                    <cancel_cue cue="Tutorial_TradeOrder_SelectTransporterAgain"/>
                    <signal_cue cue="Tutorial_TradeOrder_OpenBehaviourTab"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_TradeOrder_OpenBehaviourTab">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <show_help_overlay id="'map_sidebar_information'" highlightonly="true"/>
                <show_help_overlay id="'mapst_ao_orderqueue'" highlightonly="true"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24055, $comment = 'Open its behaviour menu.' ],
                            ],
                ]" />
              </actions>
              <cues>
                <cue name="Tutorial_TradeOrder_OpenBehaviourTab_Done">
                  <conditions>
                    <check_any>
                      <event_cue_signalled/>
                      <event_ui_triggered screen="'MapMenu'" control="'orderqueue'"/>
                    </check_any>
                  </conditions>
                  <actions>
                    <remove_help_overlay id="'map_sidebar_information'"/>
                    <remove_help_overlay id="'mapst_ao_orderqueue'"/>
                    <cancel_cue cue="Tutorial_TradeOrder_OpenBehaviourTab"/>
                    <signal_cue cue="Tutorial_TradeOrder_SetRepeatOrdersBehaviour"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_TradeOrder_SetRepeatOrdersBehaviour">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24056, $comment = 'Now change its default behaviour to repeat orders and confirm.' ],
                            ],
                ]" />
              </actions>
              <cues>
                <cue name="Tutorial_TradeOrder_SetRepeatOrdersBehaviour_Done" checkinterval="1ms">
                  <conditions>
                    <check_value value="$TransportShip.hasorderloop"/>
                  </conditions>
                  <actions>
                    <cancel_cue cue="Tutorial_TradeOrder_SetRepeatOrdersBehaviour"/>
                    <signal_cue cue="Tutorial_TradeOrder_GiveTradeOrdersAgain"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_TradeOrder_GiveTradeOrdersAgain">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24064, $comment = 'The current orders have been automatically cleared.' ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24065, $comment = 'Give it orders to buy and sell again, like you did earlier.' ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24067, $comment = 'Youll notice that the trade menus look different now.' ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24068, $comment = 'Instead of seeing the live prices you now set price limits that the trader will stick to.' ],
                                ],
                    ]" />
              </actions>
              <cues>
                <cue name="Tutorial_TradeOrder_GiveTradeOrdersAgain_Done">
                  <delay exact="1ms"/>
                  <actions>
                    <do_for_each name="$order" in="$TransportShip.orders">
                      <do_if value="$order.id == 'TradePerform'">
                        <do_if value="$order.$tradedeal.isbuyoffer">
                          <set_value name="$hasbuyoffer" exact="true"/>
                        </do_if>
                        <do_elseif value="$order.$tradedeal.isselloffer">
                          <set_value name="$hasselloffer" exact="true"/>
                        </do_elseif>
                      </do_if>
                    </do_for_each>
                    <do_if value="$hasbuyoffer? and $hasselloffer">
                      <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                        $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                        $script = [
                                    table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24057, $comment = 'Its going to repeat buying Energy Cells at the power plant, and selling them at the station you selected, until the price gets worse than what you set as the limit.' ],
                                    table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24062, $comment = 'You can put several kinds of orders into a loop like this.',
                                            $speakcallbackcue = Tutorial_TradeOrder_SetRepeatOrdersBehaviour_Highlight],
                                  ],
                        $callbackcue = Tutorial_TradeOrder_GiveTradeOrdersAgain_UseCaseDone,
                        $abortcallbackcue = Tutorial_TradeOrder_GiveTradeOrdersAgain_UseCaseDone,
                      ]" />
                    </do_if>
                    <do_else>
                      <reset_cue cue="this"/>
                    </do_else>
                  </actions>
                </cue>

                <cue name="Tutorial_TradeOrder_GiveTradeOrdersAgain_UseCaseDone">
                  <delay exact="1ms"/>
                  <actions>
                    <cancel_cue cue="Tutorial_TradeOrder_GiveTradeOrdersAgain"/>
                    <signal_cue cue="Tutorial_TradeOrder_OpenBehaviourTabAgain"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_TradeOrder_OpenBehaviourTabAgain">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1ms"/>
              <actions>
                <show_help_overlay id="'map_sidebar_information'" highlightonly="true"/>
                <show_help_overlay id="'mapst_ao_orderqueue'" highlightonly="true"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24055, $comment = 'Open its behaviour menu.' ],
                            ],
                ]" />
              </actions>
              <cues>
                <cue name="Tutorial_TradeOrder_OpenBehaviourTabAgain_Done">
                  <conditions>
                    <check_any>
                      <event_cue_signalled/>
                      <event_ui_triggered screen="'MapMenu'" control="'orderqueue'"/>
                    </check_any>
                  </conditions>
                  <actions>
                    <remove_help_overlay id="'map_sidebar_information'"/>
                    <remove_help_overlay id="'mapst_ao_orderqueue'"/>
                    <show_help_overlay id="'moveorderup'" highlightonly="true"/>
                    <show_help_overlay id="'moveorderdown'" highlightonly="true"/>
                    <show_help_overlay id="'deleteorder'" highlightonly="true"/>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24063, $comment = 'These controls here can be used to fine-tune the loop, or adjust it if conditions change.' ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24066, $comment = 'You can re-order or remove them, as well as change certain order parameters.' ],
                                ],
                      $callbackcue = Tutorial_TradeOrder_OpenBehaviourTabAgain_UseCaseDone,
                      $abortcallbackcue = Tutorial_TradeOrder_OpenBehaviourTabAgain_UseCaseDone,
                    ]" />
                  </actions>
                </cue>

                <cue name="Tutorial_TradeOrder_OpenBehaviourTabAgain_UseCaseDone">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <cancel_cue cue="Tutorial_TradeOrder_OpenBehaviourTabAgain"/>
                    <signal_cue cue="Tutorial_TradeOrder_FinalUseCase"/>
                  </actions>
                </cue>
              </cues>
            </cue>-->

            <cue name="Tutorial_TradeOrder_InitialUseCaseAndSetup_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_TradeOrder_InitialUseCaseAndSetup"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradeOrder_SetMapTargetAndZoom">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_holomap_target object="$TransportShip"/>
            <set_holomap_zoom value="250000" instant="true"/>
            <cancel_cue cue="Tutorial_TradeOrder_SetMapTargetAndZoom"/>
            <signal_cue cue="Tutorial_TriggerNext"/>
          </actions>
        </cue>

        <cue name="Tutorial_TradeOrder_ActivateTradeFilter">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.holomap.isopen and player.holomap.tradefilter.active">
              <signal_cue cue="Tutorial_TradeOrder_TradeFilterActivated"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="ShowHint_SelectMenuItem"/>
              <show_help_overlay id="'toggle_trade'" highlightonly="true"/>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24002, $comment = 'Now activate the Trade filter.' ],
                          ],
              ]" />
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_TradeOrder_TradeFilterActivated">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'MapMenu'" control="'layer_trade_toggle'"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'toggle_trade'"/>
                <cancel_cue cue="Tutorial_TradeOrder_ActivateTradeFilter"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradeOrder_TradeFilterSettings">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_owner object="$TransportShip" faction="faction.player"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24028, $comment = 'Ive given you access to another trade ship, and several more stations.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24029, $comment = 'Its getting difficult to match sell offers with buy offers with this much going on...' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24030, $comment = 'Luckily you have several options to filter trades.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24031, $comment = 'The simplest one is to only look at specific wares.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24032, $comment = 'You can select a ware youre interested in in several ways.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24033, $comment = 'By clicking on a trade offer...',
                                  $speakcallbackcue = Tutorial_TradeOrder_TradeFilterSettings_Highlight_1],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24034, $comment = 'By typing its name in the text bar in the top right corner...',
                                  $speakcallbackcue = Tutorial_TradeOrder_TradeFilterSettings_Highlight_2],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24035, $comment = 'Or by manually selecting it in the trade filter settings menu.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24036, $comment = 'Lets open that one.' ],
                        ],
              $callbackcue = Tutorial_TradeOrder_TradeFilterSettings_Hint,
              $abortcallbackcue = Tutorial_TradeOrder_TradeFilterSettings_Hint,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_TradeOrder_TradeFilterSettings_Highlight_1">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <show_help_overlay id="'map_searchbar'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_TradeOrder_TradeFilterSettings_Highlight_2">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'map_searchbar'"/>
                <show_help_overlay id="'mapst_filter'" highlightonly="true"/>
                <show_help_overlay id="'layer_trade'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_TradeOrder_TradeFilterSettings_Hint">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ShowHint_SelectMenuItem"/>
              </actions>
            </cue>

            <cue name="Tutorial_TradeOrder_TradeFilterSettings_Opened">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'filter'"/>
                <check_value value="event.param3 == 'layer_trade'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'mapst_filter'"/>
                <remove_help_overlay id="'layer_trade'"/>
                <cancel_cue cue="Tutorial_TradeOrder_TradeFilterSettings"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradeOrder_TransportType">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24037, $comment = 'Not only can you add or remove wares here, there are other useful filter options as well.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24038, $comment = 'For example, were only interested in container wares as thats what your ships can carry.',
                                  $speakcallbackcue = Tutorial_TradeOrder_TransportType_Highlight],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24039, $comment = 'So disable the other transport types.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_TradeOrder_TransportType_Highlight">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ShowHint_SelectMenuItem"/>
                <show_help_overlay id="'tradefilters_storage'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_TradeOrder_TradeFilterSettings_Changed" checkinterval="1ms">
              <conditions>
                <check_value value="player.holomap.isopen and player.holomap.tradefilter.transport.{waretransport.container} and not player.holomap.tradefilter.transport.{waretransport.solid} and not player.holomap.tradefilter.transport.{waretransport.liquid} and not player.holomap.tradefilter.transport.{waretransport.condensate}"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'tradefilters_storage'"/>
                <cancel_cue cue="Tutorial_TradeOrder_TransportType"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradeOrder_FilterWare">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24040, $comment = 'I also like to set a minimum volume and increase the displayed trade offers to 5, but thats just personal preference.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24041, $comment = 'It looks like energy cells are short everywhere.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24042, $comment = 'That means the buying price is very high.',
                                  $speakcallbackcue = Tutorial_TradeOrder_FilterWare_Objective],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24069, $comment = 'Set a filter for this ware.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24070, $comment = 'I prefer to click on the trade offer directly, but you can do it however you want.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_TradeOrder_FilterWare_Objective">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ShowHint_SelectMenuItem"/>
                <show_help_overlay id="'tradefilters_wares'" highlightonly="true"/>
                <show_help_overlay id="'map_searchbar'" highlightonly="true"/>
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1135}" text="ware.energycells.name"/>
              </actions>
            </cue>

            <cue name="Tutorial_TradeOrder_FilterWare_Done" checkinterval="1ms">
              <conditions>
                <check_value value="player.holomap.isopen and not player.holomap.tradefilter.wares.all and player.holomap.tradefilter.wares.{ware.energycells}"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'tradefilters_wares'"/>
                <remove_help_overlay id="'map_searchbar'"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <cancel_cue cue="Tutorial_TradeOrder_FilterWare"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradeOrder_SelectTransporter">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24043, $comment = 'Lets have your transport ship start trading those.',
                                  $speakcallbackcue = Tutorial_TradeOrder_SelectTransporter_Objective],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24044, $comment = 'Select it.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_TradeOrder_SelectTransporter_Objective">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_SelectObjectOnMap"/>
                <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1126}" object="$TransportShip"/>
              </actions>
            </cue>

            <cue name="Tutorial_TradeOrder_TransporterSelected" checkinterval="1ms">
              <conditions>
                <check_value value="player.holomap.isopen and player.holomap.targets.indexof.{$TransportShip}"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <cancel_cue cue="Tutorial_TradeOrder_SelectTransporter"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradeOrder_GiveBuyOrder">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <set_objective cue="GameStart_Tutorial" action="objective.buy" text="ware.energycells.name" object="$PowerPlant"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24045, $comment = 'Now give it an order to trade with the power plant.' ],
                        ],
            ]" />
            <show_help_overlay id="'interactmenu_trade'" highlightonly="true"/>
            <signal_cue_instantly cue="ShowHint_GiveOrderOnMap"/>
          </actions>
          <cues>
            <cue name="Tutorial_TradeOrder_GiveBuyOrder_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'trade_context'"/>
              </conditions>
              <actions>
                <do_if value="event.param3 == $PowerPlant">
                  <remove_help_overlay id="'interactmenu_trade'"/>
                  <signal_cue_instantly cue="ClearHintID"/>
                  <cancel_cue cue="Tutorial_TradeOrder_GiveBuyOrder"/>
                  <signal_cue cue="Tutorial_TriggerNext"/>
                </do_if>
                <do_else>
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    25, $comment = 'Right action, wrong target.' ],
                              ],
                  ]" />
                  <reset_cue cue="this"/>
                </do_else>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradeOrder_ConfirmBuyOrder">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="ShowHint_BuyWare"/>
            <show_help_overlay id="'map_confirmtrade'" highlightonly="true"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24046, $comment = 'Select the energy cells to buy, just like you did for your own ship.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24047, $comment = 'Dont forget to confirm.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_TradeOrder_ConfirmBuyOrder_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'confirmtrade'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="SetHintPosition" param="1"/>
                <remove_help_overlay id="'map_confirmtrade'"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <cancel_cue cue="Tutorial_TradeOrder_ConfirmBuyOrder"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradeOrder_GiveSellOrder">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="ShowHint_SellWare"/>
            <show_help_overlay id="'interactmenu_trade'" highlightonly="true"/>
            <show_help_overlay id="'map_confirmtrade'" highlightonly="true"/>
            <set_objective cue="GameStart_Tutorial" action="objective.sell" text="ware.energycells.name" group="$Factories"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24048, $comment = 'Now select any station that wants to buy energy cells and repeat this process.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_TradeOrder_GiveSellOrder_Done" checkinterval="1ms">
              <conditions>
                <set_value name="$lastorder" exact="$TransportShip.orders.{$TransportShip.orders.count}"/>
                <check_value value="$lastorder.id == 'TradePerform' and $lastorder.$tradedeal.isbuyoffer and $lastorder.$tradedeal.ware == ware.energycells"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="SetHintPosition" param="1"/>
                <remove_help_overlay id="'interactmenu_trade'"/>
                <remove_help_overlay id="'map_confirmtrade'"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24049, $comment = 'There, your transporter is on its way.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24050, $comment = 'Youll get paid once the sell order has been completed.' ],
                            ],
                  $callbackcue = Tutorial_TradeOrder_GiveSellOrder_UseCaseDone,
                  $abortcallbackcue = Tutorial_TradeOrder_GiveSellOrder_UseCaseDone,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_TradeOrder_GiveSellOrder_UseCaseDone">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_TradeOrder_GiveSellOrder"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradeOrder_TradeOfferTypes">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24051, $comment = 'Lets take a closer look at one specific station.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24052, $comment = 'Select the one thats highlighted.' ],
                        ],
            ]" />
            <create_station name="$ConstructionStation" macro="macro.station_gen_factory_base_01_macro" owner="faction.argon" sector="player.sector" state="componentstate.construction">
              <position z="-30km"/>
            </create_station>
            <add_build_to_expand_station object="$ConstructionStation.buildstorage" buildobject="$ConstructionStation" constructionplan="'tutorial_powerplant'"/>
            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1126}" object="$ConstructionStation"/>
          </actions>
          <cues>
            <cue name="Tutorial_TradeOrder_TradeOfferTypes_Done" checkinterval="1ms">
              <conditions>
                <check_value value="player.holomap.targets.count == 1 and player.holomap.targets.{1} == $ConstructionStation"/>
              </conditions>
              <actions>
                <set_holomap_target object="$ConstructionStation"/>
                <set_holomap_zoom value="5000"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24053, $comment = 'You can see that some of its trade offers have an icon next to them.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24054, $comment = 'This one means that they are construction trade offers.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24055, $comment = 'The station is going to use these wares to build modules, not to produce something.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24056, $comment = 'This might be useful to know if you dont just want to make money, but accelerate the build process, for example.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24057, $comment = 'There are also supply trade offers, which are for wares needed to restock things like drones.' ],
                            ],
                  $callbackcue = Tutorial_TradeOrder_TradeOfferTypes_UseCaseDone,
                  $abortcallbackcue = Tutorial_TradeOrder_TradeOfferTypes_UseCaseDone,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_TradeOrder_TradeOfferTypes_UseCaseDone">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_TradeOrder_TradeOfferTypes"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradeOrder_AutoTrade_OpenBehaviourMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24058, $comment = 'Lets move on to Auto-Trade orders.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24059, $comment = 'They make a ship find and execute trade runs on its own.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24062, $comment = 'Open the marked trade ships behaviour menu.' ],
                        ],
            ]" />
            <set_holomap_zoom value="250000" instant="true"/>
            <signal_cue cue="ShowHint_SelectObjectOnMap"/>
            <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1126}" object="$TransportShip"/>
          </actions>
          <cues>
            <cue name="Tutorial_TradeOrder_AutoTrade_OpenBehaviourMenu_ShipSelected" checkinterval="1ms">
              <conditions>
                <check_value value="player.holomap.targets.count == 1 and player.holomap.targets.{1} == $TransportShip"/>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_SelectMenuItem"/>
                <show_help_overlay id="'map_sidebar_information'" highlightonly="true"/>
                <show_help_overlay id="'mapst_ao_orderqueue'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_TradeOrder_AutoTrade_OpenBehaviourMenu_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'orderqueue'"/>
                <check_value value="player.holomap.targets.count == 1 and player.holomap.targets.{1} == $TransportShip"/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <remove_help_overlay id="'map_sidebar_information'"/>
                <remove_help_overlay id="'mapst_ao_orderqueue'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <cancel_cue cue="Tutorial_TradeOrder_AutoTrade_OpenBehaviourMenu"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <!--TODO fix this structure - may need new events from Florian?-->
        <cue name="Tutorial_TradeOrder_AutoTrade_GiveOrder">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24063, $comment = 'Now change its default behaviour to Local AutoTrade.' ],
                        ],
            ]" />
            <show_help_overlay id="'map_behaviourassignement'" highlightonly="true"/>
            <show_help_overlay id="'map_order_TradeRoutine_Basic'" highlightonly="true"/>
            <signal_cue cue="ShowHint_SelectMenuItem"/>
          </actions>
          <cues>
            <cue name="Tutorial_TradeOrder_AutoTrade_GiveOrder_OrderSelected">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'TradeRoutine_Basic'"/>
              </conditions>
              <actions>
                <show_help_overlay id="'orderparam_warebasket'" highlightonly="true"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22, $comment = 'Open the highlighted menu.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_TradeOrder_AutoTrade_GiveOrder_Warebasket_Opened">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'orderparam_warebasket'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27033, $comment = 'Select any of the wares.' ],
                            ],
                ]" />
              </actions>
              <cues>
                <cue name="Tutorial_TradeOrder_AutoTrade_GiveOrder_Ware_Selected">
                  <conditions>
                    <event_ui_triggered screen="'MapMenu'" control="'orderparam_warebasket'"/>
                    <check_value value="event.param3 != null"/>
                  </conditions>
                  <actions>
                    <remove_help_overlay id="'orderparam_warebasket'"/>
                    <show_help_overlay id="'orderparam_range'" highlightonly="true"/>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20017, $comment = 'Next you need to tell it the space to work in.' ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20018, $comment = 'Select the empty field and then click anywhere in the current sector.' ],
                                ],
                    ]" />
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_TradeOrder_AutoTrade_GiveOrder_SpaceSelected">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'set_orderparam_sector'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'orderparam_range'"/>
                <show_help_overlay id="'map_confirmdefaultorder'" highlightonly="true"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24047, $comment = 'Dont forget to confirm.' ],
                            ],
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_TradeOrder_AutoTrade_GiveOrder_Done" checkinterval="1ms">
              <conditions>
                <check_value value="$TransportShip.defaultorder.id == 'TradeRoutine_Basic'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'map_confirmdefaultorder'"/>
                <remove_help_overlay id="'map_behaviourassignement'"/>
                <remove_help_overlay id="'map_order_TradeRoutine_Basic'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24064, $comment = 'The pilot will now look for trade runs within the sector, without needing any more input from you.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24060, $comment = 'Youll make much more, though, if you manage them at least a bit, or give them more specific assignments.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 24061, $comment = 'In my experience.' ],
                            ],
                  $callbackcue = Tutorial_TradeOrder_AutoTrade_GiveOrder_UseCase_Done,
                  $abortcallbackcue = Tutorial_TradeOrder_AutoTrade_GiveOrder_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_TradeOrder_AutoTrade_GiveOrder_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_TradeOrder_AutoTrade_GiveOrder"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_TradeOrder_CloseMap">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    24, $comment = 'Take your time looking around.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25034, $comment = 'Close the map when youre done.' ],
                            ],
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_TradeOrder_MapClosed">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'menu_close'"/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_TradeOrder_CloseMap"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_MiningPersonal_Intro">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25001, $comment = 'Todays lesson is about mining.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25002, $comment = 'To properly do it you need a specialized mining ship, like the one youre flying right now.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25003, $comment = 'Theyre the only ones with the right cargo bay for storing raw chunks.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25004, $comment = 'Youll also want a mining laser.' ],
                        ],
              $callbackcue = Tutorial_MiningPersonal_Intro_Done,
              $abortcallbackcue = Tutorial_MiningPersonal_Intro_Done,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_MiningPersonal_Intro_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_MiningPersonal_Intro"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_MiningPersonal_ScanMode">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25005, $comment = 'Okay, to start: turn on your ships scan mode.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_MiningPersonal_ActivateScanMode_ref" ref="LIB_ActivateMode">
              <param name="Mode" value="activity.scan"/>
              <param name="CallbackCue" value="Tutorial_MiningPersonal_ScanMode_Activated"/>
            </cue>

            <cue name="Tutorial_MiningPersonal_ScanMode_Activated">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25006, $comment = 'The asteroids around you are now coloured based on whats inside them.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25007, $comment = 'If theyre not empty they usually contain iron ore, silicon, or ice.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25008, $comment = 'Rarely youll find some nividium, but good luck finding a buyer.' ],
                            ],
                  $callbackcue = Tutorial_MiningPersonal_ActivateScanMode_UseCase_Done,
                  $abortcallbackcue = Tutorial_MiningPersonal_ActivateScanMode_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_MiningPersonal_ActivateScanMode_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_MiningPersonal_ScanMode"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_MiningPersonal_TargetAsteroid">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25009, $comment = 'Select an asteroid thats not empty to see its mineral yield.' ],
                        ],
            ]" />
            <do_if value="@player.target.isclass.asteroid and @player.target.wares.count">
              <signal_cue cue="Tutorial_MiningPersonal_TargetAsteroid_Selected"/>
            </do_if>
            <do_else>
              <set_objective cue="GameStart_Tutorial" action="objective.custom" customaction="{30178,1129}"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_MiningPersonal_TargetAsteroid_Selected">
              <conditions>
                <event_player_changed_target/>
                <check_value value="event.param.isclass.asteroid and event.param.wares.count"/>
              </conditions>
              <actions>
                <set_value name="$TargetAsteroid" exact="player.target"/>
                <set_object_min_hull object="$TargetAsteroid" exact="100"/>
                <set_value name="$TargetNearDistance" exact="$TargetAsteroid.size + 1km"/>
                <do_if value="player.ship.distanceto.{$TargetAsteroid} ge $TargetNearDistance">
                  <set_objective cue="GameStart_Tutorial" action="objective.flyto" object="$TargetAsteroid"/>
                  <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                    $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                    $script = [
                                table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25010, $comment = 'Now approach it.' ],
                              ],
                  ]" />
                </do_if>
              </actions>
              <cues>
                <cue name="Tutorial_MiningPersonal_TargetAsteroid_Near" checkinterval="1ms">
                  <conditions>
                    <check_value value="player.ship.distanceto.{$TargetAsteroid} lt $TargetNearDistance"/>
                  </conditions>
                  <actions>
                    <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                    <signal_cue cue="Tutorial_TriggerNext"/>
                    <cancel_cue cue="Tutorial_MiningPersonal_TargetAsteroid"/>
                  </actions>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_MiningPersonal_MiningNode">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25011, $comment = 'There are basically two ways to get at the minerals.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25012, $comment = 'Either you just keep blasting the asteroid until it completely breaks apart.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25013, $comment = 'Or you do what I prefer, look for rich veins and target them directly.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25014, $comment = 'Ill mark one for you now.',
                                  $speakcallbackcue = Tutorial_MiningPersonal_MiningNode_Objective],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25015, $comment = 'Shoot it.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_MiningPersonal_MiningNode_Objective">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <find_object_component name="$MiningNode" object="$TargetAsteroid" class="class.miningnode"/>
                <set_objective cue="GameStart_Tutorial" action="objective.destroy" object="$MiningNode"/>
              </actions>
            </cue>

            <cue name="Tutorial_MiningPersonal_MiningNode_Destroyed">
              <conditions>
                <event_player_killed_object/>
                <check_value value="event.param.isclass.miningnode"/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <cancel_cue cue="Tutorial_MiningPersonal_MiningNode_Objective"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25016, $comment = 'See how quickly it released the minerals?' ],
                            ],
                  $callbackcue = Tutorial_MiningPersonal_MiningNode_UseCaseDone,
                  $abortcallbackcue = Tutorial_MiningPersonal_MiningNode_UseCaseDone,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_MiningPersonal_MiningNode_UseCaseDone">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_MiningPersonal_MiningNode"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_MiningPersonal_Chunk">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25017, $comment = 'Fly over them to collect them.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25018, $comment = 'You can also use the container magnet to pull them in.' ],
                        ],
            ]" />
            <do_if value="player.ship.cargo.count">
              <signal_cue cue="Tutorial_MiningPersonal_Chunk_Collected"/>
            </do_if>
            <do_else>
              <find_object name="$AsteroidChunk" space="player.sector" class="class.asteroid" canbepickedup="true"/>
              <set_objective cue="GameStart_Tutorial" action="objective.collect" object="$AsteroidChunk"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_MiningPersonal_Chunk_Collected">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_player_collected_ware/>
                </check_any>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25019, $comment = 'Not only does this go a whole lot faster, you also actually get more out of each asteroid!' ],
                            ],
                  $callbackcue = Tutorial_MiningPersonal_Chunk_UseCaseDone,
                  $abortcallbackcue = Tutorial_MiningPersonal_Chunk_UseCaseDone,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_MiningPersonal_Chunk_UseCaseDone">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_MiningPersonal_Chunk"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_MiningOrder_InitialUseCaseAndSetup">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <create_ship name="$MiningShip" macro="macro.ship_arg_l_miner_liquid_01_b_macro" sector="player.sector" capturable="false">
              <owner exact="faction.argon" overridenpc="true" />
              <pilot group="argon.pilot"/>
              <loadout ref="flightschool_l_miner" />
              <safepos x="-2km" z="5km" object="player.ship" space="player.sector" allowyaxis="false"/>
            </create_ship>
            <set_skill entity="$MiningShip.pilot" type="skilltype.piloting" exact="0"/>
            <set_skill entity="$MiningShip.pilot" type="skilltype.morale" exact="15"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25020, $comment = 'Now lets scale up this mining operation.' ],
                        ],
              $callbackcue = Tutorial_MiningOrder_InitialUseCaseAndSetup_Done,
              $abortcallbackcue = Tutorial_MiningOrder_InitialUseCaseAndSetup_Done,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_MiningOrder_InitialUseCaseAndSetup_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_MiningOrder_InitialUseCaseAndSetup"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_MiningOrder_ResourceAreasOnMap">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <clear_fog_of_war sector="player.sector" range="100km">
              <position x="0" y="0" z="0"/>
            </clear_fog_of_war>
            <set_holomap_zoom value="250000"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25035, $comment = 'The differently coloured areas indicate the presence of resources.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25036, $comment = 'Red areas contain solid resources, blue areas contain gases.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25037, $comment = 'Purple areas contain both.' ],
                        ],
              $callbackcue = Tutorial_MiningOrder_ResourceAreasOnMap_Done,
              $abortcallbackcue = Tutorial_MiningOrder_ResourceAreasOnMap_Done,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_MiningOrder_ResourceAreasOnMap_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_MiningOrder_ResourceAreasOnMap"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_MiningOrder_GiveOrder">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25021, $comment = 'Im passing control of another mining ship to you.',
                                  $speakcallbackcue = Tutorial_MiningOrder_GiveMinerToPlayer],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25022, $comment = 'Its a gas miner; it harvests from gas regions, not asteroids.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25023, $comment = 'Select it, then order it to mine any resource in the blue-coloured area.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_MiningOrder_GiveMinerToPlayer">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <set_owner object="$MiningShip" faction="faction.player"/>
                <signal_cue cue="ShowHint_GiveOrderOnMap"/>
                <show_help_overlay id="'interactmenu_mining'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_MiningOrder_MiningShipOrdered">
              <conditions>
                <event_ui_triggered screen="'InteractMenu'" control="'mining'"/>
                <!--<check_value value="$MiningShip.order.$destination.{2}.distanceto.{$OrderDestinationPos} lt $OrderDestinationRadius"/>-->
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'interactmenu_mining'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25024, $comment = 'It will now mine that resource until its hold is full.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25025, $comment = 'You can also change its default behaviour to local auto mine.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25026, $comment = 'The pilots skill isnt high enough yet for the more advanced orders.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25027, $comment = 'This one will make it mine and try to sell its cargo in the specified sector.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25042, $comment = 'The more advanced ones require a more experienced pilot, but allow it to operate within a range of sectors.' ],
                            ],
                  $callbackcue = Tutorial_MiningOrder_GiveOrder_UseCaseDone,
                  $abortcallbackcue = Tutorial_MiningOrder_GiveOrder_UseCaseDone,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_MiningOrder_GiveOrder_UseCaseDone">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_MiningOrder_GiveOrder"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_MiningOrder_ResourceProbe_UseCase">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <add_ammo object="player.ship" macro="macro.eq_arg_resourceprobe_01_macro" amount="1"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25028, $comment = 'The last thing you need to know is how to use resource probes.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25029, $comment = 'When deployed, they show you the density of nearby resources on the map.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25030, $comment = 'They also provide information to your miners that makes then work faster.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25031, $comment = 'Place one near where your gas miner is working.' ],
                        ],
              $callbackcue = Tutorial_MiningOrder_ResourceProbe_UseCase_Done,
              $abortcallbackcue = Tutorial_MiningOrder_ResourceProbe_UseCase_Done,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_MiningOrder_ResourceProbe_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_MiningOrder_ResourceProbe_UseCase"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_MiningOrder_ResourceProbe_Deploy">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <find_object name="$resourceprobe" class="class.resourceprobe" space="player.sector" owner="faction.player"/>
            <do_if value="$resourceprobe.exists">
              <signal_cue cue="Tutorial_MiningOrder_ResourceProbeDeployed"/>
            </do_if>
            <do_else>
              <show_help_overlay id="'docked_deploy_civ'" highlightonly="true"/>
              <show_help_overlay id="'docked_deploy_civ_dropdown_resourceprobe'" highlightonly="true"/>
              <set_objective cue="GameStart_Tutorial" action="objective.deploy" text="{20201,20701}"/>
              <do_if value="$ShipMenuOpen?">
                <signal_cue cue="Tutorial_MiningOrder_ResourceProbe_Deploy_ShipMenuOpened"/>
              </do_if>
              <do_else>
                <signal_cue cue="ShowHint_OpenShipMenu"/>
              </do_else>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_MiningOrder_ResourceProbe_Deploy_ShipMenuOpened">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'DockedMenu'" control="''"/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue_instantly cue="SetHintID" param="100219" comment="{1012,100219}"/>
              </actions>
            </cue>

            <cue name="Tutorial_MiningOrder_ResourceProbeDeployed">
              <conditions>
                <check_any>
                  <event_object_launched_resourceprobe group="$PlayerShipGroup"/>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'docked_deploy_civ'"/>
                <remove_help_overlay id="'docked_deploy_civ_dropdown_resourceprobe'"/>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <cancel_cue cue="Tutorial_MiningOrder_ResourceProbe_Deploy"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_MiningOrder_ActivateMiningFilter">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.holomap.isopen and player.holomap.miningfilter.active">
              <signal_cue cue="Tutorial_MiningOrder_MiningProbeInfo_MiningFilterActivated"/>
            </do_if>
            <do_else>
              <show_help_overlay id="'toggle_mining'" highlightonly="true"/>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25032, $comment = 'Make sure you have the mining filter active.' ],
                          ],
              ]" />
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_MiningOrder_MiningProbeInfo_MiningFilterActivated">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'MapMenu'" control="'layer_mining_toggle'"/>
                </check_any>
              </conditions>
              <actions>
                <remove_help_overlay id="'toggle_mining'"/>
                <cancel_cue cue="Tutorial_MiningOrder_ActivateMiningFilter"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_MiningOrder_MiningProbeInfo">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25038, $comment = 'You can now see an overview of the resources within the probes range.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25039, $comment = 'Each resource shows a rating - the higher it is the faster it can be gathered.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25040, $comment = 'The bar to the right shows how depleted it is.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25041, $comment = 'Resources replenish over time, but when a field is just about empty youre probably better off finding an alternative in the meantime.' ],
                        ],
              $callbackcue = Tutorial_MiningOrder_MiningProbeInfo_UseCaseDone,
              $abortcallbackcue = Tutorial_MiningOrder_MiningProbeInfo_UseCaseDone,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_MiningOrder_MiningProbeInfo_UseCaseDone">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_MiningOrder_MiningProbeInfo"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_MiningOrder_CloseMap">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="OpenMap_Reset"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25033, $comment = 'And thats basically it.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 25034, $comment = 'Close the map when youre done.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_MiningOrder_MapClosed">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'menu_close'"/>
              </conditions>
              <actions>
                <cancel_cue cue="Tutorial_MiningOrder_CloseMap"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_InventoryAndCrafting_SetupAndInitialUsecase">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <set_value name="$CraftingWare" exact="ware.inv_finemeal"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17001, $comment = 'Today well learn about items you carry on your person.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17002, $comment = 'Open the inventory menu.' ],
                        ],
            ]" />
            <signal_cue cue="OpenInventoryMenu"/>
          </actions>
          <cues>
            <cue name="Tutorial_InventoryAndCrafting_SetupAndInitialUsecase_Done">
              <conditions>
                <event_ui_triggered screen="'PlayerInfoMenu'" control="'inventory'"/>
              </conditions>
              <actions>
                <signal_cue cue="OpenInventoryMenu_Reset"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_InventoryAndCrafting_SetupAndInitialUsecase"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_InventoryAndCrafting_WareCategories">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17003, $comment = 'Here you can see every item youre carrying around personally, and their value.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17004, $comment = 'Inventory wares are sorted into several categories.',
                                  $speakcallbackcue = Tutorial_InventoryAndCrafting_WareCategories_HighlightCraftingWares],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17005, $comment = 'Crafting wares can be made into something, usually either something useful or valuable.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    36, $comment = 'Well do that later.',
                                  $speakcallbackcue = Tutorial_InventoryAndCrafting_WareCategories_HighlightPaintMods],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17006, $comment = 'Paint modifications can be applied to your ships.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17007, $comment = 'Youll learn how to do that in another lesson.',
                                  $speakcallbackcue = Tutorial_InventoryAndCrafting_WareCategories_HighlightGeneralWares],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17008, $comment = 'General wares are usually useful in some way.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17009, $comment = 'This seminar, for example, can be given to an employee to increase their management skill.',
                                  $speakcallbackcue = Tutorial_InventoryAndCrafting_WareCategories_HighlightTradeWares],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17010, $comment = 'Trade wares are rarely useful to you and can usually just be sold off.' ],
                        ],
              $callbackcue = Tutorial_InventoryAndCrafting_WareCategories_Done,
              $abortcallbackcue = Tutorial_InventoryAndCrafting_WareCategories_Done,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_InventoryAndCrafting_WareCategories_HighlightCraftingWares">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <show_help_overlay id="'playerinfo_inventory_crafting'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_InventoryAndCrafting_WareCategories_HighlightPaintMods">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'playerinfo_inventory_crafting'"/>
                <show_help_overlay id="'playerinfo_inventory_paintmod'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_InventoryAndCrafting_WareCategories_HighlightGeneralWares">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'playerinfo_inventory_paintmod'"/>
                <show_help_overlay id="'playerinfo_inventory_useful'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_InventoryAndCrafting_WareCategories_HighlightTradeWares">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'playerinfo_inventory_useful'"/>
                <show_help_overlay id="'playerinfo_inventory_tradeonly'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_InventoryAndCrafting_WareCategories_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'playerinfo_inventory_tradeonly'"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_InventoryAndCrafting_WareCategories"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_InventoryAndCrafting_DropAllIllegalWares">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17011, $comment = 'Youve probably noticed that some wares are shown in orange.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17012, $comment = 'These are illegal, at least somewhere.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17013, $comment = 'If you accidentally pick one up you can drop them from here.' ],
                        ],
              $callbackcue = Tutorial_InventoryAndCrafting_DropAllIllegalWares_HighlightButton,
              $abortcallbackcue = Tutorial_InventoryAndCrafting_DropAllIllegalWares_HighlightButton,
            ]" />
            <debug_text text="'illegal inventory? ' + player.entity.inventory.illegalto.{$AlliedFaction}"/>
            <do_if value="player.entity.inventory.illegalto.{$AlliedFaction}">
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17014, $comment = 'Use the highlighted button to drop all illegal items now.' ],
                          ],
              ]" />
            </do_if>
            <do_else>
              <signal_cue cue="Tutorial_InventoryAndCrafting_DropAllIllegalWares_Done"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_InventoryAndCrafting_DropAllIllegalWares_HighlightButton">
              <conditions>
                <event_cue_signalled/>
                <check_value value="player.entity.inventory.illegalto.{$AlliedFaction}"/>
              </conditions>
              <actions>
                <show_help_overlay id="'playerinfo_inventory_dropallillegal'" highlightonly="true"/>
                <signal_cue cue="ShowHint_SelectMenuItem"/>
              </actions>
            </cue>

            <cue name="Tutorial_InventoryAndCrafting_DropAllIllegalWares_Done">
              <conditions>
                <check_any>
                  <event_player_owned_dropped_objects/>
                  <event_cue_signalled/>
                </check_any>
                <check_value value="not player.entity.inventory.illegalto.{$AlliedFaction}"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'playerinfo_inventory_dropallillegal'"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_InventoryAndCrafting_DropAllIllegalWares"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_InventoryAndCrafting_DropTradeWare">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17015, $comment = 'You can do this for any other ware, too.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17016, $comment = 'Please drop any amount of a trade ware now.' ],
                        ],
            ]" />
            <show_help_overlay id="'playerinfo_inventory_tradeonly'" highlightonly="true"/>
            <show_help_overlay id="'playerinfo_inventory_drop'" highlightonly="true"/>
            <signal_cue cue="ShowHint_SelectMenuItem"/>
          </actions>
          <cues>
            <cue name="Tutorial_InventoryAndCrafting_DropTradeWare_Done">
              <conditions>
                <event_player_owned_dropped_objects/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 21, $comment = 'Good.' ],
                            ],
                  $callbackcue = Tutorial_InventoryAndCrafting_DropTradeWare_UseCase_Done,
                  $abortcallbackcue = Tutorial_InventoryAndCrafting_DropTradeWare_UseCase_Done,
                ]" />
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'playerinfo_inventory_drop'"/>
                <remove_help_overlay id="'playerinfo_inventory_tradeonly'"/>
              </actions>
            </cue>

            <cue name="Tutorial_InventoryAndCrafting_DropTradeWare_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_InventoryAndCrafting_DropTradeWare"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_InventoryAndCrafting_DockAtStation">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <find_station name="$Station" space="player.sector"/>
            <do_if value="$PlayerShip.dock">
              <signal_cue cue="Tutorial_InventoryAndCrafting_DockAtStation_Done"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17017, $comment = 'Please dock at the nearby station for the next part.' ],
                          ],
              ]" />
              <set_objective cue="GameStart_Tutorial" action="objective.dockat" object="$Station"/>
              <do_if value="$TopLevelMenuOpen?">
                <signal_cue cue="ShowHint_CloseMenus"/>
              </do_if>
              <do_else>
                <signal_cue cue="Tutorial_InventoryAndCrafting_DockAtStation_MenuClosed"/>
              </do_else>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_InventoryAndCrafting_DockAtStation_MenuClosed">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <check_all>
                    <event_ui_triggered screen="'MenuTabScroll'"/>
                    <check_value value="event.param3 == 'disabled'"/>
                  </check_all>
                </check_any>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_RequestDocking"/>
              </actions>
            </cue>

            <cue name="Tutorial_InventoryAndCrafting_DockAtStation_DockingGranted">
              <conditions>
                <event_object_dock_assigned object="$PlayerShip"/>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_DockingLights"/>
              </actions>
            </cue>

            <cue name="Tutorial_InventoryAndCrafting_DockAtStation_Done">
              <conditions>
                <check_any>
                  <event_object_docked object="$PlayerShip" dock="$Station"/>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_InventoryAndCrafting_DockAtStation"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_InventoryAndCrafting_GoToTradersCorner">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <find_room name="$TradersCorner" object="$Station" macro="macro.corner_arg_standard_inventorytrader_01_macro"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17018, $comment = 'Go to the traders corner.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17019, $comment = 'You can walk there directly, or take the elevator.' ],
                        ],
            ]" />
            <set_objective cue="GameStart_Tutorial" action="objective.goto" object="$TradersCorner"/>
          </actions>
          <cues>
            <cue name="Tutorial_InventoryAndCrafting_GoToTradersCorner_Done">
              <conditions>
                <event_object_changed_room object="player.entity"/>
                <check_value value="event.param == $TradersCorner"/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_InventoryAndCrafting_GoToTradersCorner"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_InventoryAndCrafting_WaitForTraderSpawn" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <cues>
            <cue name="Tutorial_InventoryAndCrafting_WaitForTraderSpawn_Done" checkinterval="1ms">
              <conditions>
                <count_object_components object="$TradersCorner" entitytype="entitytype.trader" min="1"/>
              </conditions>
              <actions>
                <find_object_component name="$Trader" object="$TradersCorner" entitytype="entitytype.trader"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_InventoryAndCrafting_WaitForTraderSpawn"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_InventoryAndCrafting_TalkToTrader">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <!--fallback handling in case player dropped this ware in the previous step-->
            <do_if value="player.entity.inventory.{ware.inv_mixedfruit}.count lt 3">
              <add_inventory ware="ware.inv_mixedfruit" exact="3 - player.entity.inventory.{ware.inv_mixedfruit}.count"/>
            </do_if>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17020, $comment = 'You can find these on practically every station.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17021, $comment = 'Talk to the trader and choose Show me your wares.' ],
                        ],
            ]" />
            <set_objective cue="GameStart_Tutorial" action="objective.talkto" object="$Trader"/>
            <signal_cue cue="ShowHint_InteractFirstPerson"/>
          </actions>
          <cues>
            <cue name="Tutorial_InventoryAndCrafting_TalkToTrader_Done">
              <conditions>
                <event_ui_triggered screen="'InventoryTraderMenu'" control="''"/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_InventoryAndCrafting_TalkToTrader"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_InventoryAndCrafting_WaitForTraderSpeak" instantiate="true">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <cues>
            <cue name="Tutorial_InventoryAndCrafting_WaitForTraderSpeak_Done">
              <conditions>
                <event_speak_finished actor="$Trader"/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_InventoryAndCrafting_WaitForTraderSpeak"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_InventoryAndCrafting_BuyCraftingWares">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17022, $comment = 'In addition to general, crafting and trade wares you can also buy spacesuit upgrades here.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17023, $comment = 'I got better thrusters as soon as I could afford them, and I havent regretted it!' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17024, $comment = 'For now, buy the entire stock of Argnu steak and rare spices.' ],
                        ],
              $callbackcue = Tutorial_InventoryAndCrafting_BuyCraftingWares_Hint,
              $abortcallbackcue = Tutorial_InventoryAndCrafting_BuyCraftingWares_Hint,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_InventoryAndCrafting_BuyCraftingWares_Hint">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <show_help_overlay id="'map_confirmtrade'" highlightonly="true"/>
                <signal_cue_instantly cue="SetHintID" param="100177" comment="{1012, 100177}"/>
                <signal_cue_instantly cue="SetHintPosition" param="0"/>
              </actions>
            </cue>

            <cue name="Tutorial_InventoryAndCrafting_BuyCraftingWares_Done">
              <conditions>
                <event_ui_triggered screen="'InventoryTraderMenu'" control="'menu_close'"/>
                <check_value value="player.entity.cancraft.{$CraftingWare}"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="SetHintPosition" param="1"/>
                <remove_help_overlay id="'map_confirmtrade'"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_InventoryAndCrafting_BuyCraftingWares"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_InventoryAndCrafting_CloseTradeMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27, $comment = 'Close this menu to move on.' ],
                        ],
            ]" />
            <signal_cue cue="ShowHint_CloseMenus"/>
          </actions>
          <cues>
            <cue name="Tutorial_InventoryAndCrafting_CloseTradeMenu_Done">
              <conditions>
                <event_conversation_finished actor="$Trader"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_InventoryAndCrafting_CloseTradeMenu"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_InventoryAndCrafting_InteractWithCraftingBench">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17025, $comment = 'Now interact with the nearby crafting bench.' ],
                        ],
            ]" />
            <find_inventoryworkbench_slot name="$CraftingBench" object="$TradersCorner"/>
            <debug_text text="$CraftingBench"/>
            <set_objective cue="GameStart_Tutorial" action="objective.craft" slot="$CraftingBench"/>
            <signal_cue cue="ShowHint_InteractFirstPerson"/>
          </actions>
          <cues>
            <cue name="Tutorial_InventoryAndCrafting_InteractWithCraftingBench_Done">
              <conditions>
                <event_ui_triggered screen="'CraftingMenu'" control="''"/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_InventoryAndCrafting_InteractWithCraftingBench"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_InventoryAndCrafting_CraftItem">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17026, $comment = 'You have enough to create a fine meal!' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 15, $comment = 'Do so now.' ],
                        ],
            ]" />
            <show_help_overlay id="'crafting_craftitem'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintPosition" param="0"/>
            <signal_cue cue="ShowHint_SelectMenuItem"/>
          </actions>
          <cues>
            <cue name="Tutorial_InventoryAndCrafting_CraftItem_Done">
              <conditions>
                <event_inventory_added object="player.entity"/>
                <check_value value="player.entity.inventory.{$CraftingWare}.count ge 1"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="SetHintPosition" param="1"/>
                <remove_help_overlay id="'crafting_craftitem'"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_InventoryAndCrafting_CraftItem"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_InventoryAndCrafting_SellCraftedItem">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17027, $comment = 'Its worth significantly more than the sum of its ingredients.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17028, $comment = 'Go ahead and sell the fine meal to the trader.' ],
                        ],
            ]" />
            <signal_cue cue="ShowHint_CloseMenus"/>
          </actions>
          <cues>
            <cue name="Tutorial_InventoryAndCrafting_SellCraftedItem_CraftingMenuClosed">
              <conditions>
                <event_ui_triggered screen="'CraftingMenu'" control="'menu_close'"/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.talkto" object="$Trader"/>
                <signal_cue cue="ShowHint_InteractFirstPerson"/>
              </actions>
            </cue>

            <cue name="Tutorial_InventoryAndCrafting_SellCraftedItem_TradeMenuOpened">
              <conditions>
                <event_ui_triggered screen="'InventoryTraderMenu'" control="''"/>
              </conditions>
              <actions>
                <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                <show_help_overlay id="'map_confirmtrade'" highlightonly="true"/>
                <signal_cue_instantly cue="SetHintID" param="100178" comment="{1012, 100178}"/>
                <signal_cue_instantly cue="SetHintPosition" param="0"/>
              </actions>
            </cue>

            <cue name="Tutorial_InventoryAndCrafting_SellCraftedItem_Done">
              <conditions>
                <event_inventory_removed object="player.entity"/>
                <check_value value="player.entity.inventory.{$CraftingWare}.count == 0"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 20, $comment = 'Well done.' ],
                            ],
                  $callbackcue = Tutorial_InventoryAndCrafting_SellCraftedItem_UseCase_Done,
                  $abortcallbackcue = Tutorial_InventoryAndCrafting_SellCraftedItem_UseCase_Done,
                ]" />
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="SetHintPosition" param="1"/>
                <remove_help_overlay id="'map_confirmtrade'"/>
              </actions>
            </cue>

            <cue name="Tutorial_InventoryAndCrafting_SellCraftedItem_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_InventoryAndCrafting_SellCraftedItem"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_InventoryAndCrafting_FinalUseCase">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue cue="ShowHint_CloseMenus"/>
          </actions>
          <cues>
            <cue name="Tutorial_InventoryAndCrafting_FinalUseCase_MenuClosed">
              <conditions>
                <event_conversation_finished actor="$Trader"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17029, $comment = 'Some crafted items have a specific use and may not be bought by traders.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17030, $comment = 'This includes devices used to overcome security measures, as well as bombs you can deploy from your spacesuit.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 17031, $comment = 'All of which are highly illegal, of course, so be careful.' ],
                            ],
                  $callbackcue = Tutorial_InventoryAndCrafting_FinalUseCase_Done,
                  $abortcallbackcue = Tutorial_InventoryAndCrafting_FinalUseCase_Done,
                ]" />
                <signal_cue_instantly cue="ClearHintID"/>
              </actions>
            </cue>

            <cue name="Tutorial_InventoryAndCrafting_FinalUseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_InventoryAndCrafting_FinalUseCase"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Factions_OpenMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <set_faction_known faction="faction.argon" known="true"/>
            <set_faction_known faction="faction.hatikvah" known="true"/>
            <set_faction_relation_locked faction="faction.argon" locked="false" />
            <set_faction_relation_locked faction="faction.hatikvah" locked="false" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22, $comment = 'Open the highlighted menu.' ],
                        ],
            ]" />
            <signal_cue cue="OpenDiplomacyMenu"/>
          </actions>
          <cues>
            <cue name="Tutorial_Factions_OpenMenu_Done">
              <conditions>
                <event_ui_triggered screen="'DiplomacyMenu'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16010, $comment = 'This is a list of all factions youve encountered, and their relations to you.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16011, $comment = 'When you select a faction you can see which licences of theirs you own, and what the current relation actually means.' ],
                            ],
                  $callbackcue = Tutorial_Factions_OpenMenu_UseCase_Done,
                  $abortcallbackcue = Tutorial_Factions_OpenMenu_UseCase_Done,
                ]" />
                <signal_cue cue="OpenDiplomacyMenu_Reset"/>
              </actions>
            </cue>

            <cue name="Tutorial_Factions_OpenMenu_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Factions_OpenMenu"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Factions_SelectFaction">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <!--because the factions are sorted alphabetically by localized name we can't rely on whether or not this faction is already selected-->
            <do_if value="@$FactionsMenuParam == 'argon'">
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16031, $comment = 'The Argon Federation faction is selected by default.' ],
                          ],
                $callbackcue = Tutorial_Factions_SelectFaction_Done,
                $abortcallbackcue = Tutorial_Factions_SelectFaction_Done,
              ]" />
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16012, $comment = 'Select Argon Federation.' ],
                          ],
              ]" />
              <show_help_overlay id="'diplomacy_faction_argon'" highlightonly="true"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_Factions_SelectFaction_Done">
              <conditions>
                <check_any>
                  <check_all>
                    <event_ui_triggered screen="'DiplomacyMenu'" control="'factions'"/>
                    <check_value value="event.param3 == 'argon'"/>
                  </check_all>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <remove_help_overlay id="'diplomacy_faction_argon'"/>
                <show_help_overlay id="'diplomacy_factionlicense_argon.generaluseequipment'" highlightonly="true"/>
                <show_help_overlay id="'diplomacy_factionlicense_argon.station_gen_basic'" highlightonly="true"/>
                <show_help_overlay id="'diplomacy_factionlicense_argon.generaluseship'" highlightonly="true"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16013, $comment = 'Your current rank with them allows you to purchase basic equipment, station modules and ships.',
                                      $speakcallbackcue = Tutorial_Factions_SelectFaction_HighlightPermissions],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16014, $comment = 'Youre also allowed to dock and, by extension, trade with them.',
                                      $speakcallbackcue = Tutorial_Factions_SelectFaction_HighlightMilitaryAssets ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16015, $comment = 'To get access to military assets you need a higher rank.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16016, $comment = 'Doing missions for a faction is one of the easiest ways to increase your reputation.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16017, $comment = 'Destroying their enemies near their stations also helps a lot, and even trading can get them to trust you if you do enough of it.',
                                      $speakcallbackcue = Tutorial_Factions_SelectFaction_HighlightRanks ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16018, $comment = 'Once youve earned a new rank youll get an invitation to see a representative personally.',
                                      $speakcallbackcue = Tutorial_Factions_SelectFaction_HighlightBuyableLicences ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16019, $comment = 'There youll get access to the licences listed here, and the option to buy the ones that have a price.',
                                      $speakcallbackcue = Tutorial_Factions_SelectFaction_HighlightPoliceLicence ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16020, $comment = 'The police licence, for example, is useful if you plan to keep this factions space safe.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16021, $comment = 'Itll pay out a bounty for each enemy you destroy near one of their stations.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16022, $comment = 'Youll also be legally allowed to scan ships in their space.',
                                      $speakcallbackcue = Tutorial_Factions_SelectFaction_HighlightTradeOfferSubscription ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16023, $comment = 'The trade offer subscription will give you permanent access to all of this factions trade offers.',
                                      $speakcallbackcue = Tutorial_Factions_SelectFaction_RemoveTradeOfferSubscriptionHighlight ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16024, $comment = 'That representative is also the one who will sell you blueprints for station modules, ships and equipment.' ],
                            ],
                  $callbackcue = Tutorial_Factions_SelectFaction_UseCase_Done,
                  $abortcallbackcue = Tutorial_Factions_SelectFaction_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Factions_SelectFaction_HighlightPermissions">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'diplomacy_factionlicense_argon.generaluseequipment'"/>
                <remove_help_overlay id="'diplomacy_factionlicense_argon.station_gen_basic'"/>
                <remove_help_overlay id="'diplomacy_factionlicense_argon.generaluseship'"/>
                <show_help_overlay id="'diplomacy_faction_relation'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_Factions_SelectFaction_HighlightMilitaryAssets">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'diplomacy_faction_relation'"/>
                <show_help_overlay id="'diplomacy_factionlicense_argon.militaryequipment'" highlightonly="true"/>
                <show_help_overlay id="'diplomacy_factionlicense_argon.militaryship'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_Factions_SelectFaction_HighlightRanks">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'diplomacy_factionlicense_argon.militaryequipment'"/>
                <remove_help_overlay id="'diplomacy_factionlicense_argon.militaryship'"/>
                <show_help_overlay id="'diplomacy_factionlicense_argon.ceremonyfriend'" highlightonly="true"/>
                <show_help_overlay id="'diplomacy_factionlicense_argon.ceremonyally'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_Factions_SelectFaction_HighlightBuyableLicences">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'diplomacy_factionlicense_argon.ceremonyfriend'"/>
                <remove_help_overlay id="'diplomacy_factionlicense_argon.ceremonyally'"/>
                <show_help_overlay id="'diplomacy_factionlicense_argon.police'" highlightonly="true"/>
                <show_help_overlay id="'diplomacy_factionlicense_argon.tradesubscription'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_Factions_SelectFaction_HighlightPoliceLicence">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'diplomacy_factionlicense_argon.tradesubscription'"/>
              </actions>
            </cue>

            <cue name="Tutorial_Factions_SelectFaction_HighlightTradeOfferSubscription">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'diplomacy_factionlicense_argon.police'"/>
                <show_help_overlay id="'diplomacy_factionlicense_argon.tradesubscription'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_Factions_SelectFaction_RemoveTradeOfferSubscriptionHighlight">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'diplomacy_factionlicense_argon.tradesubscription'"/>
              </actions>
            </cue>

            <cue name="Tutorial_Factions_SelectFaction_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <remove_help_overlay id="'diplomacy_factionlicense_argon.militaryequipment'"/>
                <remove_help_overlay id="'diplomacy_factionlicense_argon.militaryship'"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Factions_SelectFaction"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Factions_SelectOtherFaction">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <!--because the factions are sorted alphabetically by localized name we can't rely on whether or not this faction is already selected-->
            <do_if value="@$FactionsMenuParam == 'hatikvah'">
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16032, $comment = 'I see youve already selected the Hatikvah Free League.' ],
                          ],
                $callbackcue = Tutorial_Factions_SelectOtherFaction_Done,
                $abortcallbackcue = Tutorial_Factions_SelectOtherFaction_Done,
              ]" />
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16025, $comment = 'Now select the other faction, the Hatikvah Free League.', ],
                          ],
              ]" />
              <show_help_overlay id="'diplomacy_faction_hatikvah'" highlightonly="true"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_Factions_SelectOtherFaction_Done">
              <conditions>
                <check_any>
                  <check_all>
                    <event_ui_triggered screen="'DiplomacyMenu'" control="'factions'"/>
                    <check_value value="event.param3 == 'hatikvah'"/>
                  </check_all>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <remove_help_overlay id="'diplomacy_faction_hatikvah'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16026, $comment = 'Theyre a much smaller concern than the Argon Federation.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16027, $comment = 'Theres no police licence, for example, and their trade offer subscription is significantly cheaper.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16028, $comment = 'Theyre also a bit on the unscrupulous side and may plunder you and your ships unless they really like you.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16029, $comment = 'If you want to operate near them it could be worth getting on their good side.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 16030, $comment = 'Myself, I choose to stay out of their way instead.' ],
                            ],
                  $callbackcue = Tutorial_Factions_SelectOtherFaction_UseCase_Done,
                  $abortcallbackcue = Tutorial_Factions_SelectOtherFaction_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Factions_SelectOtherFaction_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Factions_SelectOtherFaction"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_CommandStructures">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22001, $comment = 'Lets learn about organising your assets.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 23, $comment = 'Open the map.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22003, $comment = 'Thats a lot of ships!' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22004, $comment = 'Disorganised, too.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22005, $comment = 'Lets do something about that.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22006, $comment = 'Select any of the small fighters.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22007, $comment = 'Now interact with the capital ship.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22008, $comment = 'Select the Intercept for commander role.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22009, $comment = 'Alpha group is fine but you can choose any one you want.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22010, $comment = 'Its now a subordinate of the capital ship.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22022, $comment = 'This role means that the ship will pre-emptively attack hostile fighters it detects.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22011, $comment = 'You can also assign more than one ship at a time.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22012, $comment = 'Select all of your remaining fighters.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22013, $comment = 'Now assign them to the capital ship in the same way.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22014, $comment = 'All of these ships are now getting orders from their commander.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22015, $comment = 'You can still give your own orders to any of them.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22016, $comment = 'They will simply resume their assignment once your orders have been completed.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22023, $comment = 'Hierarchies can also go deeper.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22024, $comment = 'Take these bombers.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22025, $comment = 'Assign two fighters to each bomber, using the Defend commander role.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22026, $comment = 'This role means that they will retaliate against anyone who attacks their commander.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22027, $comment = 'Now assign the bombers to the capital ship using the Attack with commander role.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22028, $comment = 'The bombers will now attack whatever their commander is attacking, defended by their fighter escort.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22017, $comment = 'Lets change the formation that the capital ships subordinates are flying in.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22018, $comment = 'Select the capital ship.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22019, $comment = 'Open its Behaviour menu.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22020, $comment = 'Select a different formation.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 22021, $comment = 'Beautiful!' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_CommandStructures_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_CommandStructures"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_InitialUsecaseAndSetup">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <find_gate name="$gates" space="player.sector" multiple="true"/>
            <do_for_each name="$gate" in="$gates">
              <create_object macro="macro.eq_arg_satellite_02_macro" sector="$gate.sector" owner="faction.player">
                <safepos object="$gate" allowyaxis="false" radius="10km"/>
              </create_object>
            </do_for_each>
            <create_object macro="macro.eq_arg_satellite_02_macro" sector="$Wharf.sector" owner="faction.player">
              <safepos object="$Wharf" allowyaxis="false" radius="10km"/>
            </create_object>
            <add_build_to_expand_station object="$Wharf.buildstorage" buildobject="$Wharf" constructionplan="'tutorial_station_building_arg_wharf_extended'"/>

            <create_ship name="$FreeConstructionVessel" sector="player.sector" commandeerable="true">
              <select faction="faction.argon" tags="tag.builder" size="class.ship_xl"/>
              <loadout>
                <level exact="1.0"/>
              </loadout>
              <owner exact="faction.argon" overridenpc="true"/>
              <safepos object="$Wharf" allowyaxis="false" radius="20km"/>
            </create_ship>
            <create_order object="$FreeConstructionVessel" id="'FindBuildTasks'">
              <param name="maxjumps" value="1"/>
              <param name="playeronly" value="true"/>
            </create_order>

            <create_ship name="$BusyConstructionVessel" sector="player.sector" commandeerable="true">
              <select faction="faction.argon" tags="tag.builder" size="class.ship_xl"/>
              <loadout>
                <level exact="1.0"/>
              </loadout>
              <owner exact="faction.argon" overridenpc="true"/>
              <safepos object="$Wharf" allowyaxis="false" radius="5km"/>
            </create_ship>
            <create_order object="$BusyConstructionVessel" id="'FindBuildTasks'">
              <param name="maxjumps" value="1"/>
              <param name="ownfactiononly" value="true"/>
            </create_order>

            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26001, $comment = 'Today well cover one of my most advanced lessons: designing and building stations.' ],
                        ],
              $callbackcue = Tutorial_BuildStation_UseCase_Done,
              $abortcallbackcue = Tutorial_BuildStation_UseCase_Done,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="1ms" comment="Make sure there is a delay between the ship getting its order and the signal below, even if the usecase fails to start"/>
              <actions>
                <signal_objects object="$BusyConstructionVessel" param="'request construction vessel'" param2="$Wharf.buildstorage.buildmodule" />
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_InitialUsecaseAndSetup"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_OpenPlotMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <set_holomap_zoom value="500000"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26002, $comment = 'To begin with you need a plot of space.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    22, $comment = 'Open the highlighted menu.' ],
                        ],
            ]" />
            <show_help_overlay id="'map_sidebar_plotmanagement'" highlightonly="true"/>
            <signal_cue cue="ShowHint_OpenHighlightedMenu"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_OpenPlotMenu_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'plots'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'map_sidebar_plotmanagement'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26003, $comment = 'Here you can manage your plots.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_OpenPlotMenu"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_CreateNewPlot">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26004, $comment = 'Or buy new ones, as we will do now.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26005, $comment = 'Create a new plot now.' ],
                        ],
            ]" />
            <show_help_overlay id="'create_plot_new'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintID" param="100251" comment="{1012, 100251}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_CreateNewPlot_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'createnewplot'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'create_plot_new'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26006, $comment = 'You can leave the size as it is.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26007, $comment = 'The two boxes you see are your actual plot, and the buffer distance it needs to have to other stations, gates and highways.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26008, $comment = 'You will also notice a price being displayed.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26009, $comment = 'It changes as you move the plot around.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26010, $comment = 'Not only are certain sectors more expensive than others, the price also goes up if gates, highways or stations are nearby.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_CreateNewPlot"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_PlacePlot">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26011, $comment = 'Place the plot in a remote, but cheap location for now.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="SetHintID" param="100252" comment="{1012, 100252}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_PlacePlot_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'plotplaced'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_PlacePlot"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_BuyPlotLicence">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26012, $comment = 'Now buy the licence for this plot.' ],
                        ],
            ]" />
            <show_help_overlay id="'create_plot_purchase'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintID" param="100254" comment="{1012, 100254}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_BuyPlotLicence_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'buyplot'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'create_plot_purchase'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26013, $comment = 'You can build a station without paying for the plot, but that is sure to anger the faction owning the sector.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_BuyPlotLicence"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_PlanBuild">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue cue="OpenMap_Reset"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26014, $comment = 'Now select continue to get to the next step.' ],
                        ],
            ]" />
            <show_help_overlay id="'create_plot_continue'" highlightonly="true"/>
            <signal_cue cue="ShowHint_HighlightedButton_Continue"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_PlanBuild_Done">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="''"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'create_plot_continue'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26015, $comment = 'The left side lists all the types of station modules.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26016, $comment = 'Production modules are open by default.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_PlanBuild"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_DockModules">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26017, $comment = 'Lets start with a dock, though.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    22, $comment = 'Open the highlighted menu.' ],
                        ],
            ]" />
            <show_help_overlay id="'stationbuildst_dock'" highlightonly="true"/>
            <show_help_overlay id="'stationbuildst_dock_pier1'" highlightonly="true" />
            <signal_cue cue="ShowHint_OpenHighlightedMenu"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_DockModules_Done">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduletypes_dock'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26018, $comment = 'You have access to two modules right now: a pier for capital ships, and a docking bay for smaller ships.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26019, $comment = 'There are many more options, but you need to acquire their blueprints first.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_DockModules"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_SelectPier">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26020, $comment = 'Select the pier.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="SetHintID" param="100255" comment="{1012, 100255}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_SelectPier_Done">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduleadded'"/>
                <check_value value="event.param3 == 'pier_arg_harbor_02_macro'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'stationbuildst_dock_pier1'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_SelectPier"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_PlacePier">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26021, $comment = 'Youll notice its colour sometimes changing between green and red.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26022, $comment = 'If its red then its not in a valid location.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26023, $comment = 'It may be outside of the plot, intersect with another module, or be in an exclusion zone.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26024, $comment = 'We will learn about those in a moment.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26025, $comment = 'Place this module anywhere inside the plot.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="SetHintID" param="100256" comment="{1012, 100256}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_PlacePier_Done">
              <conditions>
                <event_ui_triggered screen="'AddFloatingItemsToConstructionPlan'" control="''"/>
                <check_value value="event.param3 == macro.pier_arg_harbor_02_macro"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_PlacePier"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_SelectPlacedModule">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26026, $comment = 'You can still change its position.' ],
                        ],
            ]" />
            <do_if value="not player.holomap.stationeditor.transformgizmo.active">
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26027, $comment = 'Select it first.' ],
                          ],
              ]" />
              <signal_cue_instantly cue="SetHintID" param="100253" comment="{1012, 100253}"/>
            </do_if>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_SelectPlacedModule_Done" checkinterval="1ms">
              <conditions>
                <check_value value="player.holomap.stationeditor.transformgizmo.active"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_SelectPlacedModule"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_UseTransformGizmo_Translate">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26028, $comment = 'A so-called transform gizmo has appeared.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26029, $comment = 'You can grab and drag any of the arrows to move the module along that axis.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    15, $comment = 'Do so now.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="SetHintID" param="100257" comment="{1012, 100257}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_UseTransformGizmo_Translate_Done" checkinterval="1ms">
              <conditions>
                <check_value value="player.holomap.stationeditor.transformgizmo.position.length gt 10m"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_UseTransformGizmo_Translate"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_UseTransformGizmo_Rotate">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26030, $comment = 'Doing the same to one of the circles will rotate the module.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    15, $comment = 'Do so now.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="SetHintID" param="100258" comment="{1012, 100258}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_UseTransformGizmo_Rotate_Done" checkinterval="1ms">
              <conditions>
                <check_value value="abs(player.holomap.stationeditor.transformgizmo.rotation.yaw) gt 1deg or abs(player.holomap.stationeditor.transformgizmo.rotation.pitch) gt 1deg or abs(player.holomap.stationeditor.transformgizmo.rotation.roll) gt 1deg"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_UseTransformGizmo_Rotate"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_ResetRotation">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26031, $comment = 'You can reset a modules rotation by interacting with it.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    15, $comment = 'Do so now.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="SetHintID" param="100259" comment="{1012, 100259}"/>
            <show_help_overlay id="'stationconfig_resetrotation'" highlightonly="true"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_ResetRotation_Done">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'resetrotation'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'stationconfig_resetrotation'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_ResetRotation"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_SelectDockArea">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26032, $comment = 'Okay, now select the other dock module.' ],
                        ],
            ]" />
            <show_help_overlay id="'stationbuildst_dock_dockarea1'" highlightonly="true" />
            <signal_cue_instantly cue="SetHintID" param="100255" comment="{1012, 100255}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_SelectDockArea_Done">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduleadded'"/>
                <check_value value="event.param3 == 'dockarea_arg_m_station_01_macro'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_SelectDockArea"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_PlaceDockArea">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26033, $comment = 'As you move it around you will notice that it can snap to the already placed pier.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26034, $comment = 'You may also notice that you cant place it in the marked area in front of the pier.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26035, $comment = 'That is the so-called exclusion zone.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26036, $comment = 'It needs to be free of other modules so that ships can dock.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26037, $comment = 'Place the dock module now.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="SetHintID" param="100255" comment="{1012, 100255}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_PlaceDockArea_ModuleSelected">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduleadded'"/>
                <check_value value="event.param3 == 'defence_arg_disc_01_macro'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="SetHintID" param="100256" comment="{1012, 100256}"/>
              </actions>
            </cue>

            <cue name="Tutorial_BuildStation_PlaceDockArea_Done">
              <conditions>
                <event_ui_triggered screen="'AddFloatingItemsToConstructionPlan'" control="''"/>
                <check_value value="event.param3 == macro.dockarea_arg_m_station_01_macro"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'stationbuildst_dock'"/>
                <remove_help_overlay id="'stationbuildst_dock_dockarea1'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_PlaceDockArea"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_OtherModules">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26038, $comment = 'Lets place a few more modules to make this a fully operational station.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26039, $comment = 'First take a look at the other modules section.' ],
                        ],
            ]" />
            <show_help_overlay id="'stationbuildst_other'" highlightonly="true"/>
            <signal_cue cue="ShowHint_OpenHighlightedMenu"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_OtherModules_Done">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduletypes_other'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'stationbuildst_other'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26040, $comment = 'There are a number of cheap connection modules that you can use to make your station look nice.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26041, $comment = 'You dont have to use them, but feel free to do so during this lesson.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_OtherModules"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_PlaceProductionModule">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26042, $comment = 'Now select a production module and place it.' ],
                        ],
            ]" />
            <show_help_overlay id="'stationbuildst_production'" highlightonly="true"/>
            <show_help_overlay id="'stationbuildst_production_energycells'" highlightonly="true" />
            <signal_cue cue="ShowHint_OpenHighlightedMenu"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_PlaceProductionModule_MenuOpened">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduletypes_production'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="SetHintID" param="100255" comment="{1012, 100255}"/>
              </actions>
            </cue>

            <cue name="Tutorial_BuildStation_PlaceProductionModule_ModuleSelected">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduleadded'"/>
                <check_value value="event.param3 == 'prod_gen_energycells_macro'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="SetHintID" param="100256" comment="{1012, 100256}"/>
              </actions>
            </cue>

            <cue name="Tutorial_BuildStation_PlaceProductionModule_Done">
              <conditions>
                <event_ui_triggered screen="'AddFloatingItemsToConstructionPlan'" control="''"/>
                <check_value value="event.param3 == macro.prod_gen_energycells_macro"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'stationbuildst_production'"/>
                <remove_help_overlay id="'stationbuildst_production_energycells'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26043, $comment = 'All production modules turn certain resources into a product.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26044, $comment = 'Except for this one, which stores solar power in energy cells.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26045, $comment = 'Its output depends on the sector, your encyclopedia has the info you need.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26046, $comment = 'There are also build modules, which work very similarly, but their products are ships and equipment.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_PlaceProductionModule"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_StorageModules">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26047, $comment = 'Next well absolutely need a storage module.' ],
                        ],
            ]" />
            <show_help_overlay id="'stationbuildst_storage'" highlightonly="true"/>
            <signal_cue cue="ShowHint_OpenHighlightedMenu"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_StorageModules_Done">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduletypes_storage'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_StorageModules"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_PlaceStorageModule">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26049, $comment = 'There are modules for the different types of storage.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26050, $comment = 'We only need container storage here, so place one of these.' ],
                        ],
            ]" />
            <show_help_overlay id="'stationbuildst_storage_container1'" highlightonly="true" />
            <signal_cue_instantly cue="SetHintID" param="100255" comment="{1012, 100255}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_PlaceStorageModule_ModuleSelected">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduleadded'"/>
                <check_value value="event.param3 == 'storage_arg_s_container_01_macro'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="SetHintID" param="100256" comment="{1012, 100256}"/>
              </actions>
            </cue>

            <cue name="Tutorial_BuildStation_PlaceStorageModule_Done">
              <conditions>
                <event_ui_triggered screen="'AddFloatingItemsToConstructionPlan'" control="''"/>
                <check_value value="event.param3 == macro.storage_arg_s_container_01_macro"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'stationbuildst_storage'"/>
                <remove_help_overlay id="'stationbuildst_storage_container1'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_PlaceStorageModule"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_PlaceHabitationModule">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26051, $comment = 'Now place a habitation module.' ],
                        ],
            ]" />
            <show_help_overlay id="'stationbuildst_habitation'" highlightonly="true"/>
            <show_help_overlay id="'stationbuildst_hab_arg_s_01_macro'" highlightonly="true" />
            <signal_cue cue="ShowHint_OpenHighlightedMenu"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_PlaceHabitationModule_MenuOpened">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduletypes_habitation'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="SetHintID" param="100255" comment="{1012, 100255}"/>
              </actions>
            </cue>

            <cue name="Tutorial_BuildStation_PlaceHabitationModule_ModuleSelected">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduleadded'"/>
                <check_value value="event.param3 == 'hab_arg_s_01_macro'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="SetHintID" param="100256" comment="{1012, 100256}"/>
              </actions>
            </cue>

            <cue name="Tutorial_BuildStation_PlaceHabitationModule_Done">
              <conditions>
                <event_ui_triggered screen="'AddFloatingItemsToConstructionPlan'" control="''"/>
                <check_value value="event.param3 == macro.hab_arg_s_01_macro"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'stationbuildst_habitation'"/>
                <remove_help_overlay id="'stationbuildst_hab_arg_s_01_macro'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26052, $comment = 'Without it you wont have room for a workforce.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26053, $comment = 'While productions can run automatically, actual workers increase their efficiency a lot.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26054, $comment = 'You do need to keep them supplied with food and medicine, though.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26055, $comment = 'By the way, if youre struggling to attract people to your station a welfare module can go a long way.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_PlaceHabitationModule"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_PlaceDefenceModule">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26056, $comment = 'Finally place a defence module.' ],
                        ],
            ]" />
            <show_help_overlay id="'stationbuildst_defense'" highlightonly="true"/>
            <show_help_overlay id="'stationbuildst_defence_arg_disc_01_macro'" highlightonly="true" />
            <signal_cue cue="ShowHint_OpenHighlightedMenu"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_PlaceDefenceModule_MenuOpened">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduletypes_defense'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="SetHintID" param="100255" comment="{1012, 100255}"/>
              </actions>
            </cue>

            <cue name="Tutorial_BuildStation_PlaceDefenceModule_ModuleSelected">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'moduleadded'"/>
                <check_value value="event.param3 == 'defence_arg_disc_01_macro'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="SetHintID" param="100256" comment="{1012, 100256}"/>
              </actions>
            </cue>

            <cue name="Tutorial_BuildStation_PlaceDefenceModule_Done">
              <conditions>
                <event_ui_triggered screen="'AddFloatingItemsToConstructionPlan'" control="''"/>
                <check_value value="event.param3 == macro.defence_arg_disc_01_macro"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'stationbuildst_defense'"/>
                <remove_help_overlay id="'stationbuildst_defence_arg_disc_01_macro'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_PlaceDefenceModule"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_EditDefenceModuleLoadout">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26057, $comment = 'It doesnt automatically come with any turrets, so lets add some now.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26058, $comment = 'Interact with the defence module and select edit loadout.' ],
                        ],
            ]" />
            <show_help_overlay id="'stationconfig_editloadout'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintID" param="100260" comment="{1012, 100260}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_EditDefenceModuleLoadout_Done">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'editloadout'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'stationconfig_editloadout'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_EditDefenceModuleLoadout"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_AddTurretToDefenceModule">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26059, $comment = 'This works exactly like loadouts for ships.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26060, $comment = 'Add at least one turret and confirm the changes.' ],
                        ],
            ]" />
            <show_help_overlay id="'groupedslot_turret_arg_l_laser_01_mk1_macro'" highlightonly="true"/>
            <show_help_overlay id="'groupedslot_turret_arg_m_laser_01_mk1_macro'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintID" param="100261" comment="{1012, 100261}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_AddTurretToDefenceModule_TurretSelected">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'StationConfigurationMenu'" control="'groupedslot_turret_arg_l_laser_01_mk1_macro'"/>
                  <event_ui_triggered screen="'StationConfigurationMenu'" control="'groupedslot_turret_arg_m_laser_01_mk1_macro'"/>
                </check_any>
              </conditions>
              <actions>
                <remove_help_overlay id="'groupedslot_turret_arg_l_laser_01_mk1_macro'"/>
                <remove_help_overlay id="'groupedslot_turret_arg_m_laser_01_mk1_macro'"/>
                <show_help_overlay id="'stationconfig_confirmloadout'" highlightonly="true"/>
                <signal_cue_instantly cue="SetHintID" param="100262" comment="{1012, 100262}"/>
              </actions>
            </cue>

            <cue name="Tutorial_BuildStation_AddTurretToDefenceModule_Done">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'confirmloadout'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'stationconfig_confirmloadout'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_AddTurretToDefenceModule"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_ConfirmChanges">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26061, $comment = 'When youre satisfied you can confirm your changes with the highlighted button.' ],
                        ],
            ]" />
            <show_help_overlay id="'confirm_modulechanges'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintID" param="100263" comment="{1012, 100263}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_ConfirmChanges_Done">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'confirmmodulechanges'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'confirm_modulechanges'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_ConfirmChanges"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_HireBuilder">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26062, $comment = 'Now we need to hire a builder ship.' ],
                        ],
            ]" />
            <show_help_overlay id="'assign_hire_builder'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintID" param="100264" comment="{1012, 100264}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_HireBuilder_Done">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'assignhirebuilder'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'assign_hire_builder'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_HireBuilder"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_ConfirmHireBuilder">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <set_holomap_zoom value="500000"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26063, $comment = 'The map is now in a special mode that focuses on these builder ships.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26064, $comment = 'The one next to the other station is currently busy, but you can select the other one by interacting with it.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    15, $comment = 'Do so now.' ],
                        ],
            ]" />
            <show_help_overlay id="'selectactive'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintID" param="100265" comment="{1012, 100265}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_ConfirmHireBuilder_Done">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'selectactive'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'selectactive'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_ConfirmHireBuilder"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_RequiredResources">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26065, $comment = 'Next you need to make sure the required resources will be delivered to this stations build storage.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26066, $comment = 'If you expand this item you can see exactly what is needed.' ],
                        ],
            ]" />
            <show_help_overlay id="'plot_resources_available'" highlightonly="true"/>
            <signal_cue cue="ShowHint_HighlightedButton_Expand"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_RequiredResources_Done">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'extendavailableresourcesentry'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'plot_resources_available'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_RequiredResources"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_AllocateFunds">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26067, $comment = 'And if you expand this one you can allocate funds for trade offers.' ],
                        ],
            ]" />
            <show_help_overlay id="'plot_resources_buyoffers'" highlightonly="true"/>
            <signal_cue cue="ShowHint_HighlightedButton_Expand"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_AllocateFunds_Done">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'extendresourceentry'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'plot_resources_buyoffers'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_AllocateFunds"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_BuildStation_AcceptEstimate">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26068, $comment = 'These will be seen by traders, who will then sell them to your station.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26069, $comment = 'Of course, you can also deliver everything by yourself.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26070, $comment = 'But for now, simply accept the estimate and close this menu.' ],
                        ],
            ]" />
            <show_help_overlay id="'acceptestimate'" highlightonly="true"/>
            <signal_cue_instantly cue="SetHintID" param="100266" comment="{1012, 100266}"/>
          </actions>
          <cues>
            <cue name="Tutorial_BuildStation_AcceptEstimate_Done">
              <conditions>
                <event_ui_triggered screen="'StationConfigurationMenu'" control="'acceptestimate'"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'acceptestimate'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26071, $comment = 'The builder ship will now move to your station and use the delivered resources and its welder drones to construct it according to your plan.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26072, $comment = 'You can move or remove fully built modules as well.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 26073, $comment = 'The builder ship will then deconstruct the module, placing the recovered resourced back in the build storage.' ],
                            ],
                ]" />
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_BuildStation_AcceptEstimate"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Build_Station_CloseMap">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="player.holomap.isopen">
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                $script = [
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    24, $comment = 'Take your time looking around.' ],
                            table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    26, $comment = 'Close the map when youre done.' ],
                          ],
              ]" />
              <show_help_overlay id="'menu_close'" highlightonly="true"/>
              <signal_cue_instantly cue="SetHintID" param="100267" comment="{1012, 100267}"/>
            </do_if>
            <do_else>
              <signal_cue cue="Tutorial_Build_Station_CloseMap_Done"/>
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_Build_Station_CloseMap_Done">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'StationConfigurationMenu'" control="'menu_close'"/>
                  <event_cue_signalled/>
                </check_any>
              </conditions>
              <actions>
                <remove_help_overlay id="'menu_close'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Build_Station_CloseMap"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ManageStation">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <unlock_getup/>
            <!-- Spawning this in here, rather than using the map etc, as it means that we can move when it's spawned, if we don't want it immediately -->
            <find_station name="$TutorialPlayerStation" space="player.sector" wharf="false"/>
            <remove_object_account object="$TutorialPlayerStation"/>
            <set_object_account object="$TutorialPlayerStation"/>

            <create_station name="$GuidanceStation" macro="macro.station_gen_factory_base_01_macro" owner="faction.argon" sector="player.sector" state="componentstate.operational" constructionplan="'tutorial_powerplant'">
              <position z="8km" x="7km"/>
              <rotation yaw="206deg"/>
            </create_station>

            <!-- Setup starting wars for the power station, so that the cost of the cells are low enough for the player station to buy -->
            <add_wares object="$GuidanceStation" ware="ware.energycells"     exact="754234"/>
            <add_wares object="$GuidanceStation" ware="ware.medicalsupplies" exact="365"/>
            <add_wares object="$GuidanceStation" ware="ware.foodrations"     exact="571"/>

            <find_dockingbay name="$GuidanceDockingBay"  object="$GuidanceStation" checkoperational="true" multiple="false">
              <match_dock size="tag.dock_s" storage="false"/>
            </find_dockingbay>
            <find_room name="$GuidanceDock" object="$GuidanceDockingBay.parent" macro="macro.room_arg_m_station_02_macro"/>

            <!-- Disable conversation handlers, as we need to be able to talk to - and hire, crew -->
            <signal_cue cue="DisableCustomConversationHandlers"/>

            <!-- Spawn a character that the player can definitely hire - They are not limited to just this one if they pick someone else -->
            <create_cue_actor name="$GuidanceCharacter" cue="namespace" macro="character_argon_female_cau_base_01_macro">
              <owner exact="faction.argon"/>
              <skills>
                <skill type="management"  exact="8"/>
                <skill type="morale"      exact="6"/>
                <skill type="piloting"    exact="1"/>
                <skill type="engineering" exact="5"/>
                <skill type="boarding"    exact="2"/>
              </skills>
            </create_cue_actor>
            <set_value name="$GuidanceCharacter.$Stay" exact="true"/>

            <set_value name="$GuidanceCharacter.$HiringFee" exact="45827Cr"/>

            <set_entity_role entity="$GuidanceCharacter" role="entityrole.service"/>
            <set_entity_role_object entity="$GuidanceCharacter" object="$GuidanceStation"/>

            <create_position name="$GuidancePos" x="109.63" y="64.62" z="-18.8"/>
            <create_rotation name="$GuidanceRot" yaw="47deg"/>
            <signal_cue_instantly cue="md.NPC_Instantiation.NPC_Placement_Manager" param="['add_definition', $GuidanceCharacter,
                                                                                                  table[
                                                                                                  $requestercue = namespace,
                                                                                                  $location = $GuidanceDock,
                                                                                                  $rotation = $GuidanceRot,
                                                                                                  $position = $GuidancePos,
                                                                                                  $priority = 100]
                                                                                                  ]"/>

            <signal_objects object="player.galaxy" param="'init station'" param2="$GuidanceStation" param3="false"/>

            <signal_cue cue="Tutorial_ManageStation_HireManager"/>

          </actions>
          <cues>
            <!-- Fly to the NPC station and hire a manager -->
            <cue name="Tutorial_ManageStation_HireManager">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27001, $comment = 'So youve successfully built a station, now lets make it operate properly.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27002, $comment = 'First off, you need a manager.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27003, $comment = 'Dock at the nearby station and hire someone.' ],
                              ],
                  $callbackcue = Tutorial_ManageStation_HireManager_UseCase_Done,
                ]" />
              </actions>

              <cues>
                <!-- When the instructor has finished talking, set guidance to the NPC station -->
                <cue name="Tutorial_ManageStation_HireManager_UseCase_Done">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <set_objective cue="GameStart_Tutorial" action="objective.flyto" object="$GuidanceStation" />
                  </actions>
                </cue>

                <!-- When the player has docked at the NPC station, then set guidance to the recommended NPC to hire, and spawn a miner in the background -->
                <cue name="Tutorial_ManageStation_HireManager_Docked">
                  <conditions>
                    <event_object_docked_at container="$GuidanceStation"/>
                  </conditions>
                  <actions>
                    <set_objective cue="GameStart_Tutorial" action="objective.acquire_crew" text="{20208,30301}" object="$GuidanceCharacter"/>

                    <create_ship name="$TutorialMiner" macro="ship_arg_s_miner_solid_01_a_macro" sector="player.sector">
                      <owner exact="faction.player"/>
                      <pilot>
                        <select race="race.argon"/>
                      </pilot>
                    </create_ship>
                  </actions>
                </cue>

                <!-- When the player has agreed to hire someone, then tell them how to assign the manager of the station -->
                <cue name="Tutorial_ManageStation_HireManager_AssignManager">
                  <conditions>
                    <event_conversation_next_section section="g_hireworksomewhere"/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="SetHintID" param="[100182, 100183]" comment="{1012, 100182} or {1012, 100183}"/>
                    <signal_cue_instantly cue="SetHintPosition" param="1"/>
                    <!-- Note - if the player clicks hire too fast, then the NPC greeting won't have finished playing when it gets to this point, and the instructor line will be missed
                         however this isn't a major problem as they get an on screen hint, and this line is just duplicating that anyway -->
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27004, $comment = 'Now interact with your new station and select the manager role.' ],
                                ]
                    ]" />
                  </actions>
                  <cues>
                    <!-- The player has assigned their chosen manager to the station -->
                    <cue name="Tutorial_ManageStation_HireManager_AssignManager_Assigned">
                      <conditions>
                        <event_player_assigned_hired_actor/>
                      </conditions>

                      <actions>
                        <set_value name="$HiredManager" exact="event.param"/>
                        <signal_cue_instantly cue="ClearHintID"/>
                      </actions>

                      <!-- Delay starting the next use case, as the NPC will be thanking the player for hiring them, and this won't play -->
                      <cues>
                        <cue name="Tutorial_ManageStation_HireManager_Assign_Delayed">
                          <conditions>
                            <event_speak_finished actor="$HiredManager"/>
                          </conditions>
                          <actions>
                            <signal_cue_instantly cue="md.NPC_Instantiation.NPC_Placement_Manager" param="['remove_request', $HiredManager, namespace]"/>
                            <signal_cue cue="EnableCustomConversationHandlers"/>
                            <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                               $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                               $script = [
                                           table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27005, $comment = 'Your new hire will now travel to the station and start working.' ],
                                           table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27006, $comment = 'Almost every production module turns one or more resources into a product.' ],
                                           table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27007, $comment = 'Solar power being one exception.' ],
                                           table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27008, $comment = 'This one requires silicon ore and energy cells and produces silicon wafers.' ],
                                           ],
                                           $callbackcue = Tutorial_ManageStation_HireManager_Done,
                                           $abortcallbackcue = Tutorial_ManageStation_HireManager_Done,
                             ]" />
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>

                <!-- Hire Manager section complete -->
                <cue name="Tutorial_ManageStation_HireManager_Done">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <set_objective cue="GameStart_Tutorial" action="objective.assign_subordinate"/>
                    <signal_cue cue="Tutorial_TriggerNext"/>
                    <cancel_cue cue="Tutorial_ManageStation"/>
                  </actions>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>

        <!-- Assign subordinates to station -->
        <cue name="Tutorial_ManageStation_AssignMiningShip">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="SetHintID" param="[100185, 100186]" comment="{1012, 100185} or {1012, 100186}"/>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27009, $comment = 'Select the mining ship and assign it to mine for the station.' ],
                        ]
            ]" />
          </actions>
          <cues>
            <!-- When the player has assigned the mining ship to the station, spawn some trading ships and ask them to assign those too -->
            <cue name="Tutorial_ManageStation_AssignMiningShip_Assigned">
              <conditions>
                <check_all>
                  <event_object_subordinate_added object="$TutorialPlayerStation"/>
                  <check_value value="event.param2 == assignment.mining"/>
                </check_all>
              </conditions>
              <actions>
                <signal_cue_instantly cue="SetHintID" param="[100188, 100189]" comment="{1012, 100188} or {1012, 100189}"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                   $script = [
                               table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27010, $comment = 'Itll also want to buy certain resources, like energy cell, as well as sell its products.' ],
                               table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27011, $comment = 'So assign the two transport ships to trade for the station.' ],
                             ]
                ]" />

                <!-- Create two trading ships - We need to store these for lookup later, to ensure that both are assigned -->
                <create_list name="$TutorialTraders"/>
                <do_all exact="2" counter="$i">
                  <create_ship name="$TutorialTrader" macro="ship_arg_s_trans_container_02_b_macro" sector="player.sector" dock="$TutorialPlayerStation">
                    <owner exact="faction.player"/>
                    <pilot>
                      <select race="race.argon"/>
                    </pilot>
                  </create_ship>
                  <create_position name="$FlyToPos" value="$TutorialPlayerStation.position" x="-800m" y="70m" z="-100m"/>
                  <create_order object="$TutorialTrader" immediate="true" id="'MoveWait'">
                    <param name="destination" value="[player.sector, $FlyToPos]"/>
                  </create_order>
                  <append_to_list name="$TutorialTraders" exact="$TutorialTrader"/>
                </do_all>
              </actions>
              <cues>

                <!-- When the player assigns a ship, check if it's a ship that we're waiting for, and then remove it from the list of whips we're waiting to be assigned -->
                <cue name="Tutorial_ManageStation_AssignTraders" instantiate="true">
                  <conditions>
                    <check_all>
                      <event_object_subordinate_added object="$TutorialPlayerStation"/>
                      <check_value value="event.param2 == assignment.trade"/>
                    </check_all>
                  </conditions>
                  <actions>
                    <do_all exact="$TutorialTraders.count" counter="$i">
                      <do_if value="$TutorialTraders.{$i} == event.param">
                        <remove_from_list name="$TutorialTraders" exact="event.param"/>

                        <!-- When we are waiting for no more ships, then we trigger the Done cue -->
                        <do_if value="$TutorialTraders.count == 0">
                          <signal_cue cue="Tutorial_ManageStation_AssignTraders_Done"/>
                        </do_if>
                        <do_else>
                          <reset_cue cue="Tutorial_ManageStation_AssignTraders"/>
                        </do_else>
                        <break/>
                      </do_if>
                    </do_all>
                  </actions>
                </cue>

                <!-- Player has assigned all the ships, move onto the next tutorial section -->
                <cue name="Tutorial_ManageStation_AssignTraders_Done">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="ClearHintID"/>
                    <set_objective cue="GameStart_Tutorial" action="objective.none"/>
                    <signal_cue cue="Tutorial_TriggerNext"/>
                    <cancel_cue cue="Tutorial_ManageStation_AssignMiningShip"/>
                  </actions>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>

        <!-- Prompt the player to assigna a budge to the station -->
        <cue name="Tutorial_ManageStation_Budget">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27012, $comment = 'The station manager is now taking care of orders for these ships.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27013, $comment = 'How well they do depends on the skill of the manager or the ships pilot, whichever one is better.' ],
                        ]
            ]" />

            <!-- give the player a little more money than they actually need for this particular station -->
            <reward_player money="2953454Cr"/>

            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27014, $comment = 'The miner will start to work right away, but the traders cant.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27015, $comment = 'Your station has no budget to buy resources with.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27016, $comment = 'Open its info menu.' ],
                          ],
              $callbackcue = Tutorial_ManageStation_Budget_UseCase_Done,
              $abortcallbackcue = Tutorial_ManageStation_Budget_UseCase_Done,
            ]" />
          </actions>

          <cues>
            <!-- When the instructor finishes talking, put a hint on screen so the user is reminded what to do -->
            <cue name="Tutorial_ManageStation_Budget_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>

              <actions>
                <signal_cue_instantly cue="SetHintID" param="[100191, 100192]" comment="{1012, 100191} or {1012, 100192}"/>
              </actions>
            </cue>

            <!-- when the information menu is open tell the player to assign credits -->
            <cue name="Tutorial_ManageStation_Budget_InfoOpen">
              <conditions>
                <event_ui_triggered screen="'MapMenu'" control="'infomenu_open'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27017, $comment = 'Now put some money into the station account by moving the slider.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27018, $comment = 'You can also simply accept the managers estimate.' ],
                              ],
                  $callbackcue = Tutorial_ManageStation_Budget_InfoOpen_UseCase_Done,
                  $abortcallbackcue = Tutorial_ManageStation_Budget_InfoOpen_UseCase_Done,
                  ]" />
              </actions>

              <!-- When the instructor finishes talking, put a hint on screen so the user is reminded what to do -->
              <cues>
                <cue name="Tutorial_ManageStation_Budget_InfoOpen_UseCase_Done">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>

                  <actions>
                    <show_help_overlay id="'info_station_account_slider'" highlightonly="true"/>
                    <show_help_overlay id="'info_station_account_accept_estimate'" highlightonly="true"/>
                    <signal_cue_instantly cue="SetHintID" param="100193" comment="{1012, 100193}"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <!-- Once the player has updated the station, tell them what will happen with their money  -->
            <cue name="Tutorial_ManageStation_BudgetUpdated">
              <conditions>
                <event_player_owned_money_updated/>
              </conditions>

              <actions>
                <signal_cue_instantly cue="ClearHintID"/>
                <remove_help_overlay id="'info_station_account_slider'"/>
                <remove_help_overlay id="'info_station_account_accept_estimate'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27019, $comment = 'The manager is now going to use that budget to buy resources.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27020, $comment = 'Profits from selling the products are also going to this account.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27021, $comment = 'As soon as the manager exceeds the budget by a certain margin the excess funds will be automatically transferred to your account.' ],
                            ],
                            $callbackcue = Tutorial_ManageStation_Budget_Done,
                            $abortcallbackcue = Tutorial_ManageStation_Budget_Done,
                ]" />
              </actions>

              <cues>
                <!-- Once the instructor is done talking, move onto the next tutorial section -->
                <cue name="Tutorial_ManageStation_Budget_Done">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>
                  <actions>
                    <signal_cue cue="Tutorial_TriggerNext"/>
                    <cancel_cue cue="Tutorial_ManageStation_Budget"/>
                  </actions>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>

        <!-- Teach the player about the station's logical overview -->
        <cue name="Tutorial_ManageStation_LogicalOverview">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27026, $comment = 'Now interact with the station and open the logical overview.' ],
                        ],
              $callbackcue = Tutorial_ManageStation_LogicalOverview_UseCase_Done,
              $abortcallbackcue = Tutorial_ManageStation_LogicalOverview_UseCase_Done,
              ]" />
            <show_help_overlay id="'interactmenu_logicalstationoverview'" highlightonly="true"/>
            <!-- unlock the tutorial from requiring the map to be open -->
            <signal_cue cue="OpenMap_Reset"/>
          </actions>

          <cues>
            <!-- When the instructor finishes talking, put a hint on screen so the user is reminded what to do -->
            <cue name="Tutorial_ManageStation_LogicalOverview_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>

              <actions>
                <signal_cue_instantly cue="SetHintID" param="[100195, 100196]" comment="{1012, 100195} or {1012, 100196}"/>
              </actions>
            </cue>

            <!-- once the logical overview is open, let the instructor describe the menus to the player -->
            <cue name="Tutorial_ManageStation_LogicalOverview_Opened">
              <conditions>
                <event_ui_triggered screen="'StationOverviewMenu'"/>
              </conditions>

              <actions>
                <signal_cue_instantly cue="ClearHintID"/>

                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27027, $comment = 'Here you can see a diagram of the stations production line, among other things.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27028, $comment = 'To the left you see the various resource wares in the stations storage.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27029, $comment = 'Next to that are the productions.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27030, $comment = 'This station only has one, but you can add many different ones.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27031, $comment = 'The rightmost column shows the end products currently in storage.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27032, $comment = 'There are many things you can control from this menu.' ],
                            ],
                  $callbackcue = Tutorial_ManageStation_LogicalOverview_Ware,
                  $abortcallbackcue = Tutorial_ManageStation_LogicalOverview_Ware,
                ]" />
              </actions>
            </cue>

            <!-- Get the player to interact with one of the Ware panels -->
            <cue name="Tutorial_ManageStation_LogicalOverview_Ware">
              <conditions>
                <event_cue_signalled/>
              </conditions>

              <actions>
                <show_help_overlay id="'station_overview_storage_siliconwafers'" highlightonly="true"/>
                <show_help_overlay id="'station_overview_storage_energycells'" highlightonly="true"/>
                <show_help_overlay id="'station_overview_storage_silicon'" highlightonly="true"/>
                <show_help_overlay id="'station_overview_storage_foodrations'" highlightonly="true"/>
                <show_help_overlay id="'station_overview_storage_medicalsupplies'" highlightonly="true"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27033, $comment = 'Select any of the wares.' ],
                            ],
                  $callbackcue = Tutorial_ManageStation_LogicalOverview_Ware_UseCase_Done,
                  $abortcallbackcue = Tutorial_ManageStation_LogicalOverview_Ware_UseCase_Done,
                ]" />
              </actions>

              <cues>
                <!-- When the instructor finishes talking, put a hint on screen so the user is reminded what to do -->
                <cue name="Tutorial_ManageStation_LogicalOverview_Ware_UseCase_Done">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>

                  <actions>
                    <signal_cue_instantly cue="SetHintID" param="100197" comment="{1012, 100197}"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <!-- NOTE: This is currently not waiting for the Ware panel to be opened - there is no event we can listen to for this, so it just keeps talking -->
            <!-- When the player clicks on a ware panel, then tell them what they can do here -->
            <cue name="Tutorial_ManageStation_LogicalOverview_WareSelected">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'StationOverviewMenu'" control="'storage_silicon'"/>
                  <event_ui_triggered screen="'StationOverviewMenu'" control="'storage_energycells'"/>
                  <event_ui_triggered screen="'StationOverviewMenu'" control="'storage_siliconwafers'"/>
                  <event_ui_triggered screen="'StationOverviewMenu'" control="'storage_foodrations'"/>
                  <event_ui_triggered screen="'StationOverviewMenu'" control="'storage_medicalsupplies'"/>
                </check_any>
              </conditions>

              <actions>
                <remove_help_overlay id="'station_overview_storage_silicon'"/>
                <remove_help_overlay id="'station_overview_storage_energycells'"/>
                <remove_help_overlay id="'station_overview_storage_siliconwafers'"/>
                <remove_help_overlay id="'station_overview_storage_foodrations'"/>
                <remove_help_overlay id="'station_overview_storage_medicalsupplies'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27034, $comment = 'You can override several automatic settings or assign a trade rules specific to this ware.' ],
                            ],
                  $callbackcue = Tutorial_ManageStation_LogicalOverview_Production,
                  $abortcallbackcue = Tutorial_ManageStation_LogicalOverview_Production,
                ]" />
              </actions>
            </cue>

            <!-- When the instructor is finished talking about wares, then he should talk about production -->
            <cue name="Tutorial_ManageStation_LogicalOverview_Production">
              <conditions>
                <event_cue_signalled/>
              </conditions>

              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27035, $comment = 'Select the silicon wafers production.' ],
                              ],
                  $callbackcue = Tutorial_ManageStation_LogicalOverview_Production_UseCase_Done,
                  $abortcallbackcue = Tutorial_ManageStation_LogicalOverview_Production_UseCase_Done,
                ]" />
              </actions>

              <cues>
                <!-- When the instructor finishes talking, put a hint on screen so the user is reminded what to do -->
                <cue name="Tutorial_ManageStation_LogicalOverview_Production_UseCase_Done">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>

                  <actions>
                    <show_help_overlay id="'station_overview_production_siliconwafers'" highlightonly="true"/>
                    <signal_cue_instantly cue="SetHintID" param="100198" comment="{1012, 100198}"/>
                    <signal_cue cue="Tutorial_ManageStation_LogicalOverview_SiliconWaferProduction"/>
                  </actions>
                </cue>
              </cues>
            </cue>

            <!-- NOTE: This is currently not waiting for the Production panel to be opened - there is no event we can listen to for this, so it just keeps talking -->
            <!-- When the player clicks on the production panel, tell them what they can do here -->
            <cue name="Tutorial_ManageStation_LogicalOverview_SiliconWaferProduction">
              <conditions>
                <event_ui_triggered screen="'StationOverviewMenu'" control="'production_siliconwafers'"/>
              </conditions>

              <actions>
                <remove_help_overlay id="'station_overview_production_siliconwafers'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27036, $comment = 'It shows you a lot of detailed info, and you can pause the production from here.' ],
                            ],
                  $callbackcue = Tutorial_ManageStation_InvalidTradeWare,
                  $abortcallbackcue = Tutorial_ManageStation_InvalidTradeWare,
                ]" />

              </actions>
            </cue>

            <!-- Let the player add a trade ware to this station -->
            <cue name="Tutorial_ManageStation_InvalidTradeWare">
              <conditions>
                <event_cue_signalled/>
              </conditions>

              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27037, $comment = 'You can also set some wares to be traded without having a production module that needs or produces them with this menu.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27038, $comment = 'Try to add helium as a trade ware.' ],
                            ],
                  $callbackcue = Tutorial_ManageStation_InvalidTradeWare_UseCase_Done,
                  $abortcallbackcue = Tutorial_ManageStation_InvalidTradeWare_UseCase_Done,
                ]" />
              </actions>

              <cues>
                <!-- When the instructor finishes talking, put a hint on screen so the user is reminded what to do -->
                <cue name="Tutorial_ManageStation_InvalidTradeWare_UseCase_Done">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>

                  <actions>
                    <show_help_overlay id="'station_overview_tradewares'" highlightonly="true"/>
                    <show_help_overlay id="'station_overview_tradeware_option_helium'" highlightonly="true"/>
                    <signal_cue_instantly cue="SetHintID" param="[100200, 100201]" comment="{1012, 100200} or {1012, 100201}"/>
                  </actions>
                </cue>

                <cue name="Tutorial_ManageStation_InvalidTradeWare_TradeWaresOpen">
                  <conditions>
                    <event_ui_triggered screen="'StationOverviewMenu'" control="'tradewares'"/>
                  </conditions>

                  <cues>
                    <cue name="Tutorial_ManageStation_InvalidTradeWare_TradeWares_HeliumSelected">
                      <conditions>
                        <event_ui_triggered screen="'StationOverviewMenu'" control="'tradeware_helium'"/>
                      </conditions>
                      <cues>
                        <cue name="Tutorial_ManageStation_InvalidTradeWare_TradeWares_Confirmed">
                          <conditions>
                            <event_ui_triggered screen="'StationOverviewMenu'" control="'tradewares_confirm'"/>
                          </conditions>
                          <actions>
                            <signal_cue cue="Tutorial_ManageStation_InvalidTradeWare_Added"/>
                          </actions>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>

            <!-- NOTE: This is currently not waiting for the trade ware to be added - there is no event I can listen to for this, so it just keeps talking -->
            <!-- When the player adds Helium as a trade ware, tell them why it isn't valid -->
            <cue name="Tutorial_ManageStation_InvalidTradeWare_Added">
              <conditions>
                <event_cue_signalled/>
              </conditions>

              <actions>
                <remove_help_overlay id="'station_overview_tradewares'"/>
                <remove_help_overlay id="'station_overview_tradeware_option_helium'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27039, $comment = 'It shows a warning symbol.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27040, $comment = 'If you open the details you can see what its about.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27041, $comment = 'In this case the problem is that your station doesnt have the right kind of storage for this ware.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27042, $comment = 'You can remove it by deselecting it in the select trade wares menu.' ],
                            ],
                  $callbackcue = Tutorial_ManageStation_InvalidTradeWare_UseCaseDone,
                  $abortcallbackcue = Tutorial_ManageStation_InvalidTradeWare_UseCaseDone,
                ]" />
              </actions>
            </cue>

            <!-- when the instructor has finished talking, then move onto the next tutorial section -->
            <cue name="Tutorial_ManageStation_InvalidTradeWare_UseCaseDone">
              <conditions>
                <event_cue_signalled/>
              </conditions>

              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ManageStation_LogicalOverview"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <!-- Tell the player about how to manage their workforce -->
        <cue name="Tutorial_ManageStation_Workforce">
          <conditions>
            <event_cue_signalled/>
          </conditions>

          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27043, $comment = 'Youve probably been wondering about the workforce production, so lets open that now.' ],
                        ],
                  $callbackcue = Tutorial_ManageStation_Workforce_UseCase_Done,
                  $abortcallbackcue = Tutorial_ManageStation_Workforce_UseCase_Done,
            ]" />
          </actions>

          <cues>
            <!-- When the instructor finishes talking, put a hint on screen so the user is reminded what to do -->
            <cue name="Tutorial_ManageStation_Workforce_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>

              <actions>
                <signal_cue_instantly cue="SetHintID" param="100202" comment="{1012, 100202}"/>
                <show_help_overlay id="'station_overview_workforce'" highlightonly="true"/>
              </actions>
            </cue>

            <!-- NOTE: This currently doesn't wait for the workforce panel to be opened, as there is no event for this -->
            <!-- When the player has opened the workforce panel, tell them what they can see here -->
            <cue name="Tutorial_ManageStation_Workforce_Opened">
              <conditions>
                <event_ui_triggered screen="'StationOverviewMenu'" control="'workforce'"/>
              </conditions>

              <actions>
                <remove_help_overlay id="'station_overview_workforce'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27044, $comment = 'Each production module works better when it has people working in it.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27045, $comment = 'The optimal amount depends on the type of production.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27046, $comment = 'Workers require food and medicine, even when theyre not working.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27047, $comment = 'Keep them consistently supplied with these or theyre going to leave.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27048, $comment = 'At the bottom you can see how the workforce is expected to change over time.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27049, $comment = 'Growth mainly depends on the sector population, but plenty of living space and a well-maintained station help as well.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27050, $comment = 'You can also build certain welfare modules to attract workers more quickly.' ],
                            ],
                  $callbackcue = Tutorial_ManageStation_Workforce_UseCaseDone,
                  $abortcallbackcue = Tutorial_ManageStation_Workforce_UseCaseDone,
                ]" />
              </actions>
            </cue>

            <!-- When the instructor is finished talking, then move onto the next tutorial section -->
            <cue name="Tutorial_ManageStation_Workforce_UseCaseDone">
              <conditions>
                <event_cue_signalled/>
              </conditions>

              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ManageStation_Workforce"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <!-- Tell the player all about the drones the station can have -->
        <cue name="Tutorial_ManageStation_Drones">
          <conditions>
            <event_cue_signalled/>
          </conditions>

          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27051, $comment = 'Open the drones menu now.' ],
                        ],
              $callbackcue = Tutorial_ManageStation_Drones_UseCase_Done,
              $abortcallbackcue = Tutorial_ManageStation_Drones_UseCase_Done,
            ]" />
          </actions>

          <cues>
            <!-- When the instructor finishes talking, put a hint on screen so the user is reminded what to do -->
            <cue name="Tutorial_ManageStation_Drones_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>

              <actions>
                <show_help_overlay id="'station_overview_drones'" highlightonly="true"/>
                <signal_cue_instantly cue="SetHintID" param="100203" comment="{1012, 100203}"/>
              </actions>
            </cue>

            <!-- NOTE: This currently doesn't wait for the drones panel to be opened, as there is no event for this -->
            <!-- when the player has opened the drones panel, tell them what they can see here -->
            <cue name="Tutorial_ManageStation_Drones_Opened">
              <conditions>
                <event_ui_triggered screen="'StationOverviewMenu'" control="'drones'"/>
              </conditions>

              <actions>
                <remove_help_overlay id="'station_overview_drones'"/>
                <signal_cue_instantly cue="ClearHintID"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27052, $comment = 'Here you can set target amounts for certain types of drones.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27053, $comment = 'The manager will then create buy offers for drone components and manufacture them once these arrive.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27054, $comment = 'While most traders carry cargo drones of their own, giving the station a few as well can speed up trades with capital ships.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27055, $comment = 'And I dont need to tell you why defence and repair drones might be useful, right?' ],
                            ],
                  $callbackcue = Tutorial_ManageStation_End,
                  $abortcallbackcue = Tutorial_ManageStation_End,
                  ]" />
              </actions>
            </cue>

            <!-- Tie up the end of the tutorial -->
            <cue name="Tutorial_ManageStation_End">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <!--Tutorial_ManageStation_End-->
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27056, $comment = 'And those are the foundations of station management.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27057, $comment = 'You can keep looking around.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 27058, $comment = 'Simply close the map to complete this tutorial.' ],
                            ],
                  $callbackcue = Tutorial_ManageStation_End_UseCaseDone,
                  $abortcallbackcue = Tutorial_ManageStation_End_UseCaseDone,
                ]" />
              </actions>

              <cues>
                <!-- when the instructor is finished, trigger the tutorial end to clean up -->
                <cue name="Tutorial_ManageStation_End_UseCaseDone">
                  <conditions>
                    <event_cue_signalled/>
                  </conditions>

                  <actions>
                    <signal_cue cue="Tutorial_TriggerNext"/>
                    <cancel_cue cue="Tutorial_ManageStation_Drones"/>
                  </actions>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_ModifyShip">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28001, $comment = 'Now were getting into something for real enthusiasts!' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28002, $comment = 'Custom modifications.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28003, $comment = 'Interact with the Workbench.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28004, $comment = 'You can find these in the Ship Dealership at any wharf or shipyard.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28005, $comment = 'You cant mod small ships at shipyards, though, or capital ships at wharfs.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28006, $comment = 'Ive given you access to my personal database for this lesson.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28007, $comment = 'To use them yourself later, though, youll need to do some research of your own.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28008, $comment = 'Expand any one of the entries to see details about what it does.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28018, $comment = 'Modding your ship is far from an exact science.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28019, $comment = 'With these kinds of non-standard parts you never know exactly what youre going to get.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28020, $comment = 'But you can see the range of what to expect.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28009, $comment = 'Each of these modifications requires certain rare materials.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28021, $comment = 'This type of chassis modification requires something called a Nanoweave, as well as some Nividium Crystallite.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28010, $comment = 'It also costs a flat fee to install one, as listed in the top right.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28011, $comment = 'Install a modification of your choice now, using the highlighted button.' ],
                        ],
            ]" />
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    21, $comment = 'Good.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28012, $comment = 'You can now see its actual properties at the top.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28013, $comment = 'If you dismantle it, you will get the rarest part back - the Nanoweave in this case.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28014, $comment = 'The other materials, as well as your money, are spent, though.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28015, $comment = 'If youve got the other materials to spare, you can keep re-trying until you get the mod exactly how you like it.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28016, $comment = 'And thats how you modify ships!' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 28017, $comment = 'You may play around here as long as you like, well move on when you close the menus.' ],
                        ],
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_ModifyShip_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_ModifyShip"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Squad_Setup">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <do_all exact="2" counter="$i">
              <do_all exact="3">
                <create_ship name="$subordinate" macro="macro.ship_arg_s_fighter_02_a_macro" sector="$PlayerShip.sector" capturable="false">
                  <owner exact="faction.player" overridenpc="true" />
                  <pilot>
                    <select race="race.drone" tags="tag.aipilot"/>
                  </pilot>
                  <loadout ref="flightschool_s_fighter_02"/>
                  <safepos object="player.ship" z="1km"/>
                </create_ship>
                <set_object_commander object="$subordinate" commander="$PlayerShip" subordinategroupid="$i"/>
                <set_subordinate_group_assignment object="$subordinate" commander="$PlayerShip" subordinategroupid="$i" assignment="assignment.follow"/>
              </do_all>
            </do_all>
            <signal_cue cue="Tutorial_TriggerNext"/>
            <cancel_cue cue="Tutorial_Squad_Setup"/>
          </actions>
        </cue>

        <cue name="Tutorial_Squad_OpenShipMenu">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <delay exact="1ms"/>
          <actions>
            <do_if value="$ShipMenuOpen?">
              <signal_cue cue="Tutorial_Squad_ShipMenuOpened"/>
            </do_if>
            <do_else>
              <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31001, $comment = 'At some point you may find yourself with a bunch of fighter ships under your command.' ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31002, $comment = 'Lets learn how to use them effectively.' ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =  8020, $comment = 'Open the Ship Menu.' ],
                                ],
                                $callbackcue = Tutorial_Squad_OpenShipMenu_UseCase_Done,
                                $abortcallbackcue = Tutorial_Squad_OpenShipMenu_UseCase_Done,
                    ]" />
            </do_else>
          </actions>
          <cues>
            <cue name="Tutorial_Squad_OpenShipMenu_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="ShowHint_OpenShipMenu"/>
              </actions>

              <cues>

                <cue name="Tutorial_Squad_ShipMenuOpened">
                  <conditions>
                    <check_any>
                      <event_cue_signalled/>
                      <event_ui_triggered screen="'DockedMenu'" control="''"/>
                    </check_any>
                  </conditions>
                  <actions>
                    <signal_cue cue="ClearHintID"/>
                    <signal_cue cue="Tutorial_TriggerNext"/>
                    <cancel_cue cue="Tutorial_Squad_OpenShipMenu"/>
                  </actions>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Squad_RoleSelection">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31003, $comment = 'Under Subordinate Control you can see several groups of ships.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31004, $comment = 'At the moment they all have the Follow role, which means that they will follow you and only fight back if directly attacked.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 29004, $comment = 'Lets change that.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31005, $comment = 'Select the highlighted role dropdown.' ],
                        ],
                        $callbackcue = Tutorial_Squad_RoleSelection_UseCase_Done,
                        $abortcallbackcue = Tutorial_Squad_RoleSelection_UseCase_Done,
                    ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Squad_RoleSelection_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <show_help_overlay id="'docked_subordinate_role1'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_Squad_RoleSelection_Done">
              <conditions>
                <event_ui_triggered screen="'DockedMenu'" control="'subordinate_group_role_1'"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31006, $comment = 'Well use most of these roles today.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31007, $comment = 'Only Fleet Supply and Mimic will be covered in another lesson.' ],
                            ],
                  $callbackcue = Tutorial_Squad_RoleSelection_Done_UseCase_Done,
                  $abortcallbackcue = Tutorial_Squad_RoleSelection_Done_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Squad_RoleSelection_Done_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Squad_RoleSelection"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Squad_Interception">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31008, $comment = 'Lets begin with the Interception role.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31009, $comment = 'Assign it to group Alpha.' ],
                        ],
                        $callbackcue = Tutorial_Squad_Interception_UseCase_Done,
                        $abortcallbackcue = Tutorial_Squad_Interception_UseCase_Done,
                   ]" />
          </actions>
          <cues>

            <cue name="Tutorial_Squad_Interception_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <show_help_overlay id="'docked_subordinate_role_dropdown_interception1'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_Squad_Interception_Done">
              <conditions>
                <event_object_changed_assignment object="player.entity" assignment="assignment.interception"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'docked_subordinate_role1'"/>
                <remove_help_overlay id="'docked_subordinate_role_dropdown_interception1'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31010, $comment = 'This group will now attack any hostile ships it detects on its gravidar, up to medium size.' ],
                            ],
                  $callbackcue = Tutorial_Squad_Interception_Done_UseCase_Done,
                  $abortcallbackcue = Tutorial_Squad_Interception_Done_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Squad_Interception_Done_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>

                <create_ship name="$WingmenInterceptTarget" macro="macro.ship_arg_s_miner_solid_01_a_macro" sector="$PlayerShip.sector" capturable="false">
                  <owner exact="faction.ownerless" overridenpc="true" />
                  <pilot>
                    <select race="race.drone" tags="tag.aipilot"/>
                  </pilot>
                  <loadout ref="flightschool_shielded_training_target"/>
                  <safepos object="player.ship" z="1km"/>
                </create_ship>
                <set_object_hull object="$WingmenInterceptTarget" exact="25"/>
                <set_relation_boost object="$WingmenInterceptTarget" value="-1" faction="faction.player" silent="true"/>
                <set_object_relation_behaviour object="$WingmenInterceptTarget" disable="true"/>

              </actions>

              <delay exact="5s"/>

              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Squad_Interception"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Squad_Bombardment">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31011, $comment = 'To attack capital ships you need to use the Bombardment role.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31012, $comment = 'Assign it to group Beta.' ],
                        ],
                        $callbackcue = Tutorial_Squad_Bombardment_UseCase_Done,
                        $abortcallbackcue = Tutorial_Squad_Bombardment_UseCase_Done,
              ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Squad_Bombardment_UseCase_Done">
              <conditions>
                <event_cue_signalled />
              </conditions>

              <actions>

                <create_ship name="$WingmenBombardTarget" macro="macro.ship_arg_l_destroyer_02_a_macro" sector="$PlayerShip.sector" capturable="false">
                  <pilot group="argon.pilot"/>
                  <loadout ref="flightschool_turret_shooting_target"/>
                  <owner exact="$AlliedFaction" overridenpc="true"/>
                  <position z="2km" object="$PlayerShip"/>
                  <rotation yaw="90deg"/>
                </create_ship>
                <set_relation_boost object="$WingmenBombardTarget" value="-1" faction="faction.player" silent="true"/>
                <set_object_relation_behaviour object="$WingmenBombardTarget" disable="true"/>
                <set_object_hull object="$WingmenBombardTarget" exact="15"/>
                <show_help_overlay id="'docked_subordinate_role2'" highlightonly="true"/>
                <show_help_overlay id="'docked_subordinate_role_dropdown_bombardment2'" highlightonly="true"/>
              </actions>
            </cue>

            <cue name="Tutorial_Squad_Bombardment_Done">
              <conditions>
                <event_object_changed_assignment object="player.entity" assignment="assignment.bombardment"/>
              </conditions>
              <delay exact="5s"/>
              <actions>

                <remove_help_overlay id="'docked_subordinate_role2'"/>
                <remove_help_overlay id="'docked_subordinate_role_dropdown_bombardment2'"/>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31013, $comment = 'The group is now attacking the hostile capital ship.' ],
                            ],
                  $callbackcue = Tutorial_Squad_Bombardment_Done_UseCase_Done,
                  $abortcallbackcue = Tutorial_Squad_Bombardment_Done_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_Squad_Bombardment_Done_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>

              <delay exact="5s"/>

              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Squad_Bombardment"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Squad_Defence">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31014, $comment = 'If you want them to be a bit less aggressive you can use the defence role.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31009, $comment = 'Assign it to group Alpha.' ],
                        ],
                        $callbackcue = Tutorial_Squad_Defence_UseCase_Done,
                        $abortcallbackcue = Tutorial_Squad_Defence_UseCase_Done,
        ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Squad_Defence_UseCase_Done">
              <conditions>
	              <event_cue_signalled />
              </conditions>

              <actions>
	              <show_help_overlay id="'docked_subordinate_role1'" highlightonly="true"/>
                <show_help_overlay id="'docked_subordinate_role_dropdown_defence1'" highlightonly="true"/>
              </actions>
            </cue>
            <cue name="Tutorial_Squad_Defence_Done">
              <conditions>
                <event_object_changed_assignment object="player.entity" assignment="assignment.defence"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'docked_subordinate_role1'"/>
                <remove_help_overlay id="'docked_subordinate_role_dropdown_defence1'"/>

                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31016, $comment = 'These ships will now fight back if you or one of your subordinates is attacked.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak =    35, $comment = 'Ill demonstrate.' ],
                            ],
                  $callbackcue = Tutorial_Squad_Defence_Done_UseCase_Done,
                  $abortcallbackcue = Tutorial_Squad_Defence_Done_UseCase_Done,
                  ]" />

              </actions>

              <delay exact="1s"/>

              <actions>
                <do_for_each name="$ship" in="player.ship.subordinates.{assignment.defence}">
                  <edit_order_param order="$ship.order" param="'pursuedistance'" value="1.75km"/>
                </do_for_each>
              </actions>
            </cue>

            <cue name="Tutorial_Squad_Defence_Done_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>

                <signal_cue cue="ClearHintID"/>
                <do_if value="$ShipMenuOpen?">
                  <signal_cue cue="ShowHint_CloseMenus"/>
                </do_if>
                <do_else>
                  <signal_cue cue="Tutorial_Squad_Defence_MenuClosed"/>
                </do_else>
              </actions>
            </cue>

            <cue name="Tutorial_Squad_Defence_MenuClosed">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'DockedMenu'" control="'menu_close'"/>
                  <event_cue_signalled/>
                </check_any>
              </conditions>

              <actions>
                <signal_cue cue="ClearHintID"/>
                <create_ship name="$WingmenDefenceTarget" macro="macro.ship_arg_s_fighter_01_a_macro" sector="$PlayerShip.sector" capturable="false">
                  <owner exact="faction.ownerless" overridenpc="true" />
                  <pilot>
                    <select race="race.drone" tags="tag.aipilot"/>
                  </pilot>
                  <loadout ref="flightschool_s_fighter_01"/>
                  <safepos object="player.ship" z="1km"/>
                </create_ship>
                <set_object_hull object="$WingmenDefenceTarget" exact="15"/>
                <set_relation_boost object="$WingmenDefenceTarget" value="-1" faction="faction.player" silent="true"/>
                <set_object_relation_behaviour object="$WingmenDefenceTarget" disable="true"/>

                <create_order object="$WingmenDefenceTarget" id="'Attack'">
                  <param name="primarytarget" value="player.ship"/>
                  <param name="allowothertargets" value="true"/>
                  <param name="pursuetargets" value="true"/>
                  <param name="checkrelation" value="false"/>
                </create_order>

                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Squad_Defence"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Squad_Attack">
          <conditions>
            <event_cue_signalled/>
          </conditions>

          <!-- Just wait a bit before we continue, to allow the ships to attack each other a little bit -->
          <delay exact="10s"/>

          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31017, $comment = 'Finally, theres the Attack role.' ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31009, $comment = 'Assign it to group Alpha.' ],
                        ],
                        $callbackcue = Tutorial_Squad_Attack_UseCase_Done,
                        $abortcallbackcue = Tutorial_Squad_Attack_UseCase_Done,
                ]" />
          </actions>
          <cues>
            <cue name="Tutorial_Squad_Attack_UseCase_Done">
              <conditions>
	              <event_cue_signalled />
              </conditions>

              <actions>
                <do_if value="$ShipMenuOpen?">
                  <signal_cue cue="Tutorial_Squad_Attack_Menu_opened"/>
                </do_if>
                <do_else>
                  <signal_cue cue="ShowHint_OpenShipMenu"/>
                </do_else>
              </actions>
            </cue>

            <cue name="Tutorial_Squad_Attack_Menu_opened">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'DockedMenu'" control="''"/>
                </check_any>
              </conditions>

              <actions>
                <signal_cue cue="ClearHintID"/>
	              <show_help_overlay id="'docked_subordinate_role1'" highlightonly="true"/>
                <show_help_overlay id="'docked_subordinate_role_dropdown_attack1'" highlightonly="true"/>

              </actions>
            </cue>
            <cue name="Tutorial_Squad_Attack_RoleSet">
              <conditions>
                <event_object_changed_assignment object="player.entity" assignment="assignment.attack"/>
              </conditions>
              <actions>
                <remove_help_overlay id="'docked_subordinate_role1'"/>
                <remove_help_overlay id="'docked_subordinate_role_dropdown_attack1'"/>

                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31019, $comment = 'These ships will now attack any hostile target that you attack.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31020, $comment = 'Ive activated a weapon on your ship.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31021, $comment = 'Shoot at the target in front of you.' ],
                              ],
                              $callbackcue = Tutorial_Squad_Attack_CloseMenu_UseCase_Done,
                              $abortcallbackcue = Tutorial_Squad_Attack_CloseMenu_UseCase_Done,
                  ]" />

                <do_if value="$WingmenDefenceTarget.exists">
                  <destroy_object object="$WingmenDefenceTarget"/>
                </do_if>

                <create_ship name="$WingmenAttackTarget" macro="macro.ship_arg_s_fighter_01_a_macro" sector="$PlayerShip.sector" capturable="false">
                  <owner exact="faction.ownerless" overridenpc="true" />
                  <pilot>
                    <select race="race.drone" tags="tag.aipilot"/>
                  </pilot>
                  <loadout ref="flightschool_s_fighter_01"/>
                  <safepos object="player.ship" z="1km"/>
                </create_ship>
                <set_object_hull object="$WingmenAttackTarget" exact="10"/>
                <set_relation_boost object="$WingmenAttackTarget" value="-1" faction="faction.player" silent="true"/>
                <set_object_relation_behaviour object="$WingmenAttackTarget" disable="true"/>

                <create_order object="$WingmenAttackTarget" id="'Wait'"/>

                <create_loadout result="$TutorialPlayerLoadout">
                  <macros>
                    <weapon macro="weapon_gen_s_laser_01_mk1_macro" path="../con_weapon_006"/>
                  </macros>
                </create_loadout>

                <apply_loadout loadout="$TutorialPlayerLoadout" object="player.ship" flags="add weapons"/>

              </actions>
              <cues>
                <cue name="Tutorial_Squad_Attack_CloseMenu_UseCase_Done">
                  <conditions>
	                  <event_cue_signalled />
                  </conditions>

                  <actions>
                    <do_if value="$ShipMenuOpen?">
                      <signal_cue cue="ShowHint_CloseMenus"/>
                    </do_if>
                  </actions>
                </cue>

                <cue name="Tutorial_Squad_Attack_MenuClosed">
                  <conditions>
                    <check_any>
                      <event_ui_triggered screen="'DockedMenu'" control="'menu_close'"/>
                      <event_cue_signalled/>
                    </check_any>
                  </conditions>

                  <actions>
                    <signal_cue cue="ClearHintID"/>
                  </actions>
                </cue>

                <cue name="Tutorial_Squad_Attack_TargetAttacked">
                  <conditions>
                    <event_object_attacked object="$WingmenAttackTarget"/>
                  </conditions>
                  <actions>
                    <cancel_all_orders object="$WingmenAttackTarget"/>

                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31022, $comment = 'The group will now attack this target until its destroyed, or until you attack another hostile target.' ],
                                ]
                    ]" />
                  </actions>

                  <cues>
                    <cue name="Tutorial_Squad_Attack_Target_Destroyed">
                      <conditions>
                        <event_object_destroyed object="$WingmenAttackTarget"/>
                      </conditions>
                      <actions>
                        <signal_cue cue="Tutorial_TriggerNext"/>
                        <cancel_cue cue="Tutorial_Squad_Attack"/>
                      </actions>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Squad_Hotkeys">
          <conditions>
            <event_cue_signalled/>
          </conditions>

          <actions>
            <do_if value="not (player.input.controller or player.input.ismapped.controller.INPUT_ACTION_SQUAD_ATTACK_TARGET)">
              <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom',
                                                            [ 'Input Profile', {30178,1151},
                                                            [ 'attacktarget',   {30178,1201} ],
                                                            [ 'continue',       {30178,1202} ],
                                                              'attacktarget'
                                                          ]]"/>
            </do_if>
            <do_else>
              <signal_cue cue="Tutorial_Squad_Hotkeys_Prompt"/>
            </do_else>
          </actions>

          <cues>

            <cue name="Tutorial_Squad_Hotkeys_QuestionAnsweredOrClosed">
              <conditions>
                <check_any>
                  <event_ui_triggered screen="'UserQuestionMenu'" control="'selected'"/>
                  <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                </check_any>
              </conditions>

              <actions>
                <do_if value="event.param3 == 'attacktarget'">
                  <signal_cue_instantly cue="SetHintPosition" param="5"/>
                  <!--<signal_cue_instantly cue="SetHintID" param="26426" comment="{1012, 26426}"/>-->
                  <open_menu menu="OptionsMenu" param="'keyboard_space'"/>
                </do_if>
                <do_else>
                  <signal_cue cue="Tutorial_Squad_Hotkeys_Prompt"/>
                </do_else>
              </actions>
            </cue>

            <cue name="Tutorial_Squad_Hotkeys_Prompt">
              <conditions>
                <check_any>
	                <event_ui_triggered screen="'OptionsMenu'" control="'menu_close'"/>
                  <event_cue_signalled />
                </check_any>
              </conditions>

              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31023, $comment = 'Its also possible to directly give an overriding attack order.' ],
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31024, $comment = 'Do this on the marked target.' ],
                                ],
                    ]" />
              </actions>
            </cue>
            <cue name="Tutorial_Squad_Hotkeys_OrderGiven">
              <conditions>
                <event_object_signalled object="player.entity" param="'player_squad_attack_target'" />
                <check_value value="player.target.ishostileto.{player.entity}"/>
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31025, $comment = 'This has given all of your direct subordinates an attack order, no matter the current role.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31026, $comment = 'They will carry it out until the target is destroyed, unless you directly tell them to resume.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31027, $comment = 'Either way, they will resume their assigned role.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 31028, $comment = 'Call them back now.' ],
                            ]
                ]" />
              </actions>
              <cues>
                <cue name="Tutorial_Squad_Hotkeys_WingmenRecalled">
                  <conditions>
                    <event_object_signalled object="player.entity" param="'player_squad_resume_assignment'" />
                  </conditions>
                  <actions>
                    <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                      $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                      $script = [
                                  table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 30, $comment = 'And thats it for this lesson.' ],
                                ],
                      $callbackcue = Tutorial_Squad_Hotkeys_UseCase_Done,
                      $abortcallbackcue = Tutorial_Squad_Hotkeys_UseCase_Done,
                    ]" />
                  </actions>
                </cue>
              </cues>
            </cue>

            <cue name="Tutorial_Squad_Hotkeys_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <delay exact="2s"/>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_Squad_Hotkeys"/>
              </actions>
            </cue>
          </cues>
        </cue>

        <cue name="Tutorial_Quit">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          <actions>
            <signal_cue_instantly cue="ClearHintID"/>
          </actions>
          <delay exact="1ms"/>
          <actions>
            <show_overlay_text relwidth="1.0" reloffsetx="0.0" reloffsety="0.0" fadein="0.0" fadeout="0.0">
              <row fromtop="true" reloffsety="0.15">
                <col idx="1" textcolor="'text_normal'" text="{1001,3313}" bgcolor="'overlay_text_background'" fontsize="48" halign="center" valign="center"/>
              </row>
              <row fromtop="true">
                <col idx="1" textcolor="'text_normal'" text="player.modulename" bgcolor="'overlay_text_background'" fontsize="32" halign="center" valign="center"/>
              </row>
            </show_overlay_text>
            <remove_mission cue="GameStart_Tutorial" type="completed"/>
            <set_userdata name="player.module + '_completed'" value="true"/>
            <!--check for achievement unlocks-->
            <debug_text text="'Checking whether all basic tutorials have been completed'"/>
            <set_value name="$basic_tutorials_completed" exact="true"/>
            <do_for_each name="$tutorialname" in="player.tutorials.basic">
              <do_if value="not userdata.{$tutorialname + '_completed'}?">
                <debug_text text="'Not completed: ' + $tutorialname"/>
                <remove_value name="$basic_tutorials_completed"/>
              </do_if>
              <do_else>
                <debug_text text="'Completed: ' + $tutorialname"/>
              </do_else>
            </do_for_each>
            <do_if value="$basic_tutorials_completed?">
              <unlock_achievement name="FLIGHT_SCHOOL" scenario="true" />
            </do_if>
            <debug_text text="'Checking whether all intermediate tutorials have been completed'"/>
            <set_value name="$intermediate_tutorials_completed" exact="true"/>
            <do_for_each name="$tutorialname" in="player.tutorials.intermediate">
              <do_if value="not userdata.{$tutorialname + '_completed'}?">
                <debug_text text="'Not completed: ' + $tutorialname"/>
                <remove_value name="$intermediate_tutorials_completed"/>
              </do_if>
              <do_else>
                <debug_text text="'Completed: ' + $tutorialname"/>
              </do_else>
            </do_for_each>
            <do_if value="$intermediate_tutorials_completed?">
              <unlock_achievement name="TUTORIALS_INTERMEDIATE" scenario="true" />
            </do_if>
            <debug_text text="'Checking whether all advanced tutorials have been completed'"/>
            <set_value name="$advanced_tutorials_completed" exact="true"/>
            <do_for_each name="$tutorialname" in="player.tutorials.advanced">
              <do_if value="not userdata.{$tutorialname + '_completed'}?">
                <debug_text text="'Not completed: ' + $tutorialname"/>
                <remove_value name="$advanced_tutorials_completed"/>
              </do_if>
              <do_else>
                <debug_text text="'Completed: ' + $tutorialname"/>
              </do_else>
            </do_for_each>
            <do_if value="$advanced_tutorials_completed?">
              <unlock_achievement name="TUTORIALS_ADVANCED" scenario="true" />
            </do_if>
            <!--if it's a basic tutorial, ask whether to continue with the next recommended thing-->
            <set_value name="$timelinesgamestart" exact="'x4ep1_gamestart_hub'"/>
            <do_if value="@userdata.tutorial_started_from == 1 and player.latestsave.exists">
              <set_value name="$userquestiontext" exact="{1001,2614}"/>
              <set_value name="$NextModule" exact="player.latestsave.name"/>
            </do_if>
            <do_elseif value="player.allmodules.{player.module}.istutorial.basic">
              <!--check if there is an unfinished basic tutorial - recommend the first one-->
              <do_if value="not $basic_tutorials_completed?">
                <do_for_each name="$tutorialname" in="player.tutorials.basic">
                  <do_if value="not userdata.{$tutorialname + '_completed'}?">
                    <set_value name="$NextModule" exact="$tutorialname"/>
                    <substitute_text source="{30178,1140}" text="$userquestiontext">
                      <replace string="'$TUTORIALNAME$'" with="player.allmodules.{$NextModule}.name"/>
                    </substitute_text>
                    <break/>
                  </do_if>
                </do_for_each>
              </do_if>
              <!--all basic tutorials have been completed - if Timelines is active, recommend playing it-->
              <do_elseif value="player.allmodules.{$timelinesgamestart}.exists and player.allmodules.{$timelinesgamestart}.isextensionenabled">
                <set_value name="$userquestiontext" exact="{30178,1142}"/>
                <set_value name="$NextModule" exact="$timelinesgamestart"/>
              </do_elseif>
              <!--Timelines is not active - load latest save?-->
              <do_elseif value="player.latestsave.exists">
                <set_value name="$userquestiontext" exact="{30178,1143}"/>
                <set_value name="$NextModule" exact="player.latestsave.name"/>
              </do_elseif>
              <!--There is no savegame - recommend a gamestart (this can be null in case of mods, which will be handled below by just quitting to the start menu-->
              <do_elseif value="player.recommendedmodule?">
                <set_value name="$NextModule" exact="player.recommendedmodule"/>
                <substitute_text source="{30178,1144}" text="$userquestiontext">
                  <replace string="'$GAMESTARTNAME$'" with="player.allmodules.{$NextModule}.name"/>
                </substitute_text>
              </do_elseif>
            </do_elseif>
            <debug_text text="'User question: ' + @$userquestiontext"/>
            <debug_text text="'Next module: ' + @$NextModule"/>
            <debug_text text="'Next module params: ' + @$NextModuleParams"/>
            <do_if value="$userquestiontext? and not @userdata.force_load_latest_save_after_tutorial">
              <debug_text text="'Opening UserQuestionMenu'"/>
              <open_menu menu="UserQuestionMenu" param="[0, 0, 'custom', [ {1001,3313}, $userquestiontext, [ 'yes', {1001,14} ], [ 'no', {1001,11791} ] ]]"/>
            </do_if>
            <do_else>
              <signal_cue cue="QuitToStartmenu"/>
            </do_else>
          </actions>
          <cues>
            <cue name="QuitToStartmenu">
              <conditions>
                <check_any>
                  <event_cue_signalled/>
                  <event_ui_triggered screen="'UserQuestionMenu'" control="'selected'"/>
                  <event_ui_triggered screen="'UserQuestionMenu'" control="'menu_close'"/>
                </check_any>
              </conditions>
              <delay exact="if event.name == 'event_cue_signalled' then 3s else 1ms"/>
              <actions>
                <do_if value="($NextModule? and $NextModule == $timelinesgamestart and not userdata.timelines_player_character_macro?) and not @userdata.force_load_latest_save_after_tutorial">
                  <remove_overlay_text/>
                  <open_menu menu="OptionsMenu" param="'timelines'"/>
                  <cancel_cue cue="this"/>
                </do_if>
                <do_else>
                  <fade_screen fadeout="1s" holdtime="1s" fadein="1s"/>
                </do_else>
              </actions>
              <delay exact="1s"/>
              <actions>
                <do_if value="($NextModule? and player.latestsave.name == $NextModule and event.param2 == 'selected' and event.param3 == 'yes') or @userdata.force_load_latest_save_after_tutorial">
                  <remove_userdata name="'force_load_latest_save_after_tutorial'"/>
                  <quit_to_load_latest_save/>
                </do_if>
                <do_elseif value="$NextModule? and event.param2 == 'selected' and event.param3 == 'yes'">
                  <quit_to_game game="$NextModule" params="@$NextModuleParams"/>
                </do_elseif>
                <do_else>
                  <quit_to_startmenu/>
                </do_else>
              </actions>
            </cue>
          </cues>
        </cue>

        <!--
        Tutorial block template:
        <cue name="Tutorial_XXXXX">
          <conditions>
            <event_cue_signalled/>
          </conditions>
          if you're referencing a child cue in this cue's actions block:
          <delay exact="1ms"/>
          <actions>
            <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
              $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
              $script = [
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 00000, $comment = 'There are foos that need baring.',
                                  $speakcallbackcue = Tutorial_XXXXX_YYYYY ],
                          table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 00000, $comment = 'Please do a foo bar now.' ],
                        ],
              $callbackcue = Tutorial_XXXXX_ZZZZZ,
              $abortcallbackcue = Tutorial_XXXXX_ZZZZZ,
            ]" />
          </actions>
          <cues>
            <cue name="Tutorial_XXXXX_YYYYY">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                line finished: show a hint, highlight a button, set an objective, ...
              </actions>
            </cue>

            <cue name="Tutorial_XXXXX_ZZZZZ">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                usecase finished: show a hint, highlight a button, set an objective, ...
              </actions>
            </cue>

            <cue name="Tutorial_XXXXX_Done">
              <conditions>
                whatever the player is asked to do
              </conditions>
              <actions>
                <signal_cue_instantly cue="md.NPC_UseCases.UseCase" param="table[
                  $caller = this, $preset = $UseCasePreset, $actors = $MissionActors,
                  $script = [
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 00000, $comment = 'Good job doing the foo bar.' ],
                              table [ $actor = '$FlightInstructor', $recipient = 'player', $speak = 00000, $comment = 'It's useful for baring foos.' ],
                            ],
                  $callbackcue = Tutorial_XXXXX_UseCase_Done,
                  $abortcallbackcue = Tutorial_XXXXX_UseCase_Done,
                ]" />
              </actions>
            </cue>

            <cue name="Tutorial_XXXXX_UseCase_Done">
              <conditions>
                <event_cue_signalled/>
              </conditions>
              <actions>
                <signal_cue cue="Tutorial_TriggerNext"/>
                <cancel_cue cue="Tutorial_XXXXX"/>
              </actions>
            </cue>
          </cues>
        </cue>
        -->
      </cues>
    </cue>
  </cues>
</mdscript>
